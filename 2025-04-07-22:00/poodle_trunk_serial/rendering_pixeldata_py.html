<html><body bgcolor="#e0e0e0"><head><title>rendering/pixeldata.py</title></head><pre><font face="Lucida,Courier New"><font color="#a02030"># ----------------------------------------------------------------------------</font>
<font color="#a02030">#  CLASSES: nightly</font>
<font color="#a02030">#</font>
<font color="#a02030">#  Test Case:  openexr.py </font>
<font color="#a02030">#</font>
<font color="#a02030">#  Tests:      saving pixel data, transparent backgrounds in saved images.</font>
<font color="#a02030">#</font>
<font color="#a02030">#  Programmer: Brad Whitlock</font>
<font color="#a02030">#  Date:       Thu Feb 15 14:16:45 PST 2018</font>
<font color="#a02030">#</font>
<font color="#a02030">#  Modifications:</font>
<font color="#a02030"># </font>
<font color="#a02030"># ----------------------------------------------------------------------------</font>

<font color="#a02030"># Saves pixel data.</font>
<font color="#C00000">def</font> <font color="#000000">SavePixelData</font><font color="#4000C0">(</font><font color="#000000">filename</font><font color="#4000C0">,</font> <font color="#000000">alpha</font><font color="#4000C0">,</font> <font color="#000000">depth</font><font color="#4000C0">,</font> <font color="#000000">luminance</font><font color="#4000C0">,</font> <font color="#000000">value</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#000000">s</font> <font color="#4000C0">=</font> <font color="#000000">GetSaveWindowAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">s</font><font color="#4000C0">.</font><font color="#000000">outputToCurrentDirectory</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">s</font><font color="#4000C0">.</font><font color="#000000">family</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">s</font><font color="#4000C0">.</font><font color="#000000">fileName</font> <font color="#4000C0">=</font> <font color="#000000">filename</font>
    <font color="#000000">s</font><font color="#4000C0">.</font><font color="#000000">width</font>  <font color="#4000C0">=</font> <font color="#000000">TestEnv</font><font color="#4000C0">.</font><font color="#000000">params</font><font color="#4000C0">[</font><font color="#008000">&quot;width&quot;</font><font color="#4000C0">]</font>
    <font color="#000000">s</font><font color="#4000C0">.</font><font color="#000000">height</font> <font color="#4000C0">=</font> <font color="#000000">TestEnv</font><font color="#4000C0">.</font><font color="#000000">params</font><font color="#4000C0">[</font><font color="#008000">&quot;height&quot;</font><font color="#4000C0">]</font>
    <font color="#000000">s</font><font color="#4000C0">.</font><font color="#000000">screenCapture</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">s</font><font color="#4000C0">.</font><font color="#000000">format</font> <font color="#4000C0">=</font> <font color="#000000">s</font><font color="#4000C0">.</font><font color="#000000">PNG</font>
    <font color="#000000">s</font><font color="#4000C0">.</font><font color="#000000">pixelData</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#C00000">if</font> <font color="#000000">alpha</font><font color="#4000C0">:</font>
        <font color="#000000">s</font><font color="#4000C0">.</font><font color="#000000">pixelData</font> <font color="#4000C0">=</font> <font color="#000000">s</font><font color="#4000C0">.</font><font color="#000000">pixelData</font> <font color="#4000C0">|</font> <font color="#0080C0">2</font>
    <font color="#C00000">if</font> <font color="#000000">luminance</font><font color="#4000C0">:</font>
        <font color="#000000">s</font><font color="#4000C0">.</font><font color="#000000">pixelData</font> <font color="#4000C0">=</font> <font color="#000000">s</font><font color="#4000C0">.</font><font color="#000000">pixelData</font> <font color="#4000C0">|</font> <font color="#0080C0">4</font>
    <font color="#C00000">if</font> <font color="#000000">value</font><font color="#4000C0">:</font>
        <font color="#000000">s</font><font color="#4000C0">.</font><font color="#000000">pixelData</font> <font color="#4000C0">=</font> <font color="#000000">s</font><font color="#4000C0">.</font><font color="#000000">pixelData</font> <font color="#4000C0">|</font> <font color="#0080C0">8</font>
    <font color="#C00000">if</font> <font color="#000000">depth</font><font color="#4000C0">:</font>
        <font color="#000000">s</font><font color="#4000C0">.</font><font color="#000000">pixelData</font> <font color="#4000C0">=</font> <font color="#000000">s</font><font color="#4000C0">.</font><font color="#000000">pixelData</font> <font color="#4000C0">|</font> <font color="#0080C0">16</font>
    <font color="#000000">SetSaveWindowAttributes</font><font color="#4000C0">(</font><font color="#000000">s</font><font color="#4000C0">)</font>
    <font color="#000000">SaveWindow</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#C00000">def</font> <font color="#000000">test0</font><font color="#4000C0">(</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#000000">TestSection</font><font color="#4000C0">(</font><font color="#008000">&quot;Save transparent background image&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">db</font> <font color="#4000C0">=</font> <font color="#000000">silo_data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;noise.silo&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">db</font><font color="#4000C0">)</font>
    <font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Contour&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;hardyglobal&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">c</font> <font color="#4000C0">=</font> <font color="#000000">GetPlotOptions</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">c</font><font color="#4000C0">.</font><font color="#000000">SetMultiColor</font><font color="#4000C0">(</font><font color="#0080C0">2</font><font color="#4000C0">,</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">255</font><font color="#4000C0">,</font> <font color="#0080C0">100</font><font color="#4000C0">)</font><font color="#4000C0">)</font>
    <font color="#000000">c</font><font color="#4000C0">.</font><font color="#000000">SetMultiColor</font><font color="#4000C0">(</font><font color="#0080C0">3</font><font color="#4000C0">,</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">255</font><font color="#4000C0">,</font> <font color="#0080C0">255</font><font color="#4000C0">,</font> <font color="#0080C0">100</font><font color="#4000C0">)</font><font color="#4000C0">)</font>
    <font color="#000000">c</font><font color="#4000C0">.</font><font color="#000000">SetMultiColor</font><font color="#4000C0">(</font><font color="#0080C0">4</font><font color="#4000C0">,</font> <font color="#4000C0">(</font><font color="#0080C0">255</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">255</font><font color="#4000C0">,</font> <font color="#0080C0">100</font><font color="#4000C0">)</font><font color="#4000C0">)</font>
    <font color="#000000">SetPlotOptions</font><font color="#4000C0">(</font><font color="#000000">c</font><font color="#4000C0">)</font>
    <font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">v3</font> <font color="#4000C0">=</font> <font color="#000000">GetView3D</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">viewNormal</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.569008</font><font color="#4000C0">,</font> <font color="#0080C0">0.313204</font><font color="#4000C0">,</font> <font color="#0080C0">0.760351</font><font color="#4000C0">)</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">focus</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">)</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">viewUp</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0.185488</font><font color="#4000C0">,</font> <font color="#0080C0">0.949682</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">0.252384</font><font color="#4000C0">)</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">viewAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">30</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">parallelScale</font> <font color="#4000C0">=</font> <font color="#0080C0">17.3205</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">nearPlane</font> <font color="#4000C0">=</font> <font color="#4000C0">-</font><font color="#0080C0">34.641</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">farPlane</font> <font color="#4000C0">=</font> <font color="#0080C0">34.641</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">imagePan</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.0120947</font><font color="#4000C0">,</font> <font color="#0080C0">0.0574413</font><font color="#4000C0">)</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">imageZoom</font> <font color="#4000C0">=</font> <font color="#0080C0">1.13829</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">perspective</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">eyeAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">2</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">centerOfRotationSet</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">centerOfRotation</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">)</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">axis3DScaleFlag</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">axis3DScales</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">shear</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">windowValid</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">SetView3D</font><font color="#4000C0">(</font><font color="#000000">v3</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;pixeldata_0_00&quot;</font><font color="#4000C0">)</font>
    <font color="#a02030"># Save a partially transparent Contour plot on a transparent background.</font>
    <font color="#000000">SavePixelData</font><font color="#4000C0">(</font><font color="#008000">&quot;pd0&quot;</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">)</font>

    <font color="#a02030"># Save a partially transparent Contour plot on a transparent background -- with axes</font>
    <font color="#000000">a</font> <font color="#4000C0">=</font> <font color="#000000">GetAnnotationAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">axes3D</font><font color="#4000C0">.</font><font color="#000000">bboxFlag</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">SetAnnotationAttributes</font><font color="#4000C0">(</font><font color="#000000">a</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;pixeldata_0_01&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">SavePixelData</font><font color="#4000C0">(</font><font color="#008000">&quot;pd1&quot;</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">)</font>

    <font color="#a02030"># Test that we get the transparent background when we have a gradient bg.</font>
    <font color="#000000">a</font> <font color="#4000C0">=</font> <font color="#000000">GetAnnotationAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">backgroundMode</font> <font color="#4000C0">=</font> <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">Gradient</font>
    <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">gradientColor1</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">180</font><font color="#4000C0">,</font> <font color="#0080C0">100</font><font color="#4000C0">,</font> <font color="#0080C0">180</font><font color="#4000C0">,</font> <font color="#0080C0">255</font><font color="#4000C0">)</font>
    <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">gradientColor2</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">255</font><font color="#4000C0">)</font>
    <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">axes3D</font><font color="#4000C0">.</font><font color="#000000">bboxFlag</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">foregroundColor</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">255</font><font color="#4000C0">,</font><font color="#0080C0">255</font><font color="#4000C0">,</font><font color="#0080C0">255</font><font color="#4000C0">,</font><font color="#0080C0">255</font><font color="#4000C0">)</font>
    <font color="#000000">SetAnnotationAttributes</font><font color="#4000C0">(</font><font color="#000000">a</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;pixeldata_0_02&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">SavePixelData</font><font color="#4000C0">(</font><font color="#008000">&quot;pd2&quot;</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">)</font>

    <font color="#a02030"># Test that we get the transparent background when we have a gradient bg. with axes</font>
    <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">axes3D</font><font color="#4000C0">.</font><font color="#000000">bboxFlag</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">SetAnnotationAttributes</font><font color="#4000C0">(</font><font color="#000000">a</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;pixeldata_0_03&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">SavePixelData</font><font color="#4000C0">(</font><font color="#008000">&quot;pd3&quot;</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">)</font>

    <font color="#a02030"># Restore solid bg, no axes</font>
    <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">backgroundMode</font> <font color="#4000C0">=</font> <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">Solid</font>
    <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">axes3D</font><font color="#4000C0">.</font><font color="#000000">bboxFlag</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">foregroundColor</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font><font color="#0080C0">0</font><font color="#4000C0">,</font><font color="#0080C0">0</font><font color="#4000C0">,</font><font color="#0080C0">255</font><font color="#4000C0">)</font>
    <font color="#000000">SetAnnotationAttributes</font><font color="#4000C0">(</font><font color="#000000">a</font><font color="#4000C0">)</font>
    <font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">CloseDatabase</font><font color="#4000C0">(</font><font color="#000000">db</font><font color="#4000C0">)</font>

    <font color="#a02030"># Make some expressions that let us plot a transparent image with a checker background.</font>
    <font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;i&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;floor(coords(ImageMesh)[0] / 20)&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;j&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;floor(coords(ImageMesh)[1] / 20)&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;checker&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;mod(i+j, 2)&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;gray&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;100+checker*80&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;t&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;alpha / 255.&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;omt&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;1 - t&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">DefineVectorExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;blend&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;color4(t*red + omt*gray,t*green + omt*gray,t*blue + omt*gray, 255)&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">DefineVectorExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;comp&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;if(lt(alpha, 255), blend, color4(red, green, blue, 255))&quot;</font><font color="#4000C0">)</font>

    <font color="#a02030"># Open the files we made.</font>
    <font color="#000000">idx</font> <font color="#4000C0">=</font> <font color="#0080C0">4</font>
    <font color="#C00000">for</font> <font color="#000000">db</font> <font color="#C00000">in</font> <font color="#4000C0">(</font><font color="#008000">&quot;pd0.png&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;pd1.png&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;pd2.png&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;pd3.png&quot;</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
        <font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">db</font><font color="#4000C0">)</font>
        <font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;alpha&quot;</font><font color="#4000C0">)</font>
        <font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
        <font color="#000000">v</font> <font color="#4000C0">=</font> <font color="#000000">GetView2D</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
        <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">viewportCoords</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
        <font color="#000000">SetView2D</font><font color="#4000C0">(</font><font color="#000000">v</font><font color="#4000C0">)</font>
        <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;pixeldata_0_%02d&quot;</font> <font color="#4000C0">%</font> <font color="#000000">idx</font><font color="#4000C0">)</font>
        <font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
        <font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Truecolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;comp&quot;</font><font color="#4000C0">)</font>
        <font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
        <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;pixeldata_0_%02d&quot;</font> <font color="#4000C0">%</font> <font color="#4000C0">(</font><font color="#000000">idx</font><font color="#4000C0">+</font><font color="#0080C0">1</font><font color="#4000C0">)</font><font color="#4000C0">)</font>
        <font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
        <font color="#000000">CloseDatabase</font><font color="#4000C0">(</font><font color="#000000">db</font><font color="#4000C0">)</font>
        <font color="#000000">idx</font> <font color="#4000C0">=</font> <font color="#000000">idx</font> <font color="#4000C0">+</font> <font color="#0080C0">2</font>

<font color="#C00000">def</font> <font color="#000000">test1</font><font color="#4000C0">(</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#000000">TestSection</font><font color="#4000C0">(</font><font color="#008000">&quot;Save image plus depth&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">db</font> <font color="#4000C0">=</font> <font color="#000000">silo_data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;multi_rect3d.silo&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">db</font><font color="#4000C0">)</font>
    <font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Contour&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;u&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">v</font> <font color="#4000C0">=</font> <font color="#000000">GetView3D</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">viewNormal</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.483301</font><font color="#4000C0">,</font> <font color="#0080C0">0.412135</font><font color="#4000C0">,</font> <font color="#0080C0">0.772376</font><font color="#4000C0">)</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">focus</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0.5</font><font color="#4000C0">,</font> <font color="#0080C0">0.5</font><font color="#4000C0">,</font> <font color="#0080C0">0.5</font><font color="#4000C0">)</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">viewUp</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0.218992</font><font color="#4000C0">,</font> <font color="#0080C0">0.911123</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">0.349139</font><font color="#4000C0">)</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">viewAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">30</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">parallelScale</font> <font color="#4000C0">=</font> <font color="#0080C0">0.866025</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">nearPlane</font> <font color="#4000C0">=</font> <font color="#4000C0">-</font><font color="#0080C0">1.73205</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">farPlane</font> <font color="#4000C0">=</font> <font color="#0080C0">1.73205</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">imagePan</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">)</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">imageZoom</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">perspective</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">eyeAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">2</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">centerOfRotationSet</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">centerOfRotation</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0.5</font><font color="#4000C0">,</font> <font color="#0080C0">0.5</font><font color="#4000C0">,</font> <font color="#0080C0">0.5</font><font color="#4000C0">)</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">axis3DScaleFlag</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">axis3DScales</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">shear</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">windowValid</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">SetView3D</font><font color="#4000C0">(</font><font color="#000000">v</font><font color="#4000C0">)</font>

    <font color="#a02030"># Save against a solid background.</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;pixeldata_1_00&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">SavePixelData</font><font color="#4000C0">(</font><font color="#008000">&quot;pdz0&quot;</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">)</font>

    <font color="#a02030"># Save against a solid background adding axes</font>
    <font color="#000000">a</font> <font color="#4000C0">=</font> <font color="#000000">GetAnnotationAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">axes3D</font><font color="#4000C0">.</font><font color="#000000">bboxFlag</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">SetAnnotationAttributes</font><font color="#4000C0">(</font><font color="#000000">a</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;pixeldata_1_01&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">SavePixelData</font><font color="#4000C0">(</font><font color="#008000">&quot;pdz1&quot;</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">)</font>

    <font color="#a02030"># Save against a gradient background </font>
    <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">backgroundMode</font> <font color="#4000C0">=</font> <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">Gradient</font>
    <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">gradientColor1</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">180</font><font color="#4000C0">,</font> <font color="#0080C0">100</font><font color="#4000C0">,</font> <font color="#0080C0">180</font><font color="#4000C0">,</font> <font color="#0080C0">255</font><font color="#4000C0">)</font>
    <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">gradientColor2</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">255</font><font color="#4000C0">)</font>
    <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">axes3D</font><font color="#4000C0">.</font><font color="#000000">bboxFlag</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">foregroundColor</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">255</font><font color="#4000C0">,</font><font color="#0080C0">255</font><font color="#4000C0">,</font><font color="#0080C0">255</font><font color="#4000C0">,</font><font color="#0080C0">255</font><font color="#4000C0">)</font>
    <font color="#000000">SetAnnotationAttributes</font><font color="#4000C0">(</font><font color="#000000">a</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;pixeldata_1_02&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">SavePixelData</font><font color="#4000C0">(</font><font color="#008000">&quot;pdz2&quot;</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">)</font>

    <font color="#a02030"># Save against a gradient background adding axes</font>
    <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">backgroundMode</font> <font color="#4000C0">=</font> <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">Gradient</font>
    <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">gradientColor1</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">180</font><font color="#4000C0">,</font> <font color="#0080C0">100</font><font color="#4000C0">,</font> <font color="#0080C0">180</font><font color="#4000C0">,</font> <font color="#0080C0">255</font><font color="#4000C0">)</font>
    <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">gradientColor2</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">255</font><font color="#4000C0">)</font>
    <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">axes3D</font><font color="#4000C0">.</font><font color="#000000">bboxFlag</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">foregroundColor</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">255</font><font color="#4000C0">,</font><font color="#0080C0">255</font><font color="#4000C0">,</font><font color="#0080C0">255</font><font color="#4000C0">,</font><font color="#0080C0">255</font><font color="#4000C0">)</font>
    <font color="#000000">SetAnnotationAttributes</font><font color="#4000C0">(</font><font color="#000000">a</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;pixeldata_1_03&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">SavePixelData</font><font color="#4000C0">(</font><font color="#008000">&quot;pdz3&quot;</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">)</font>

    <font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">CloseDatabase</font><font color="#4000C0">(</font><font color="#000000">db</font><font color="#4000C0">)</font>

    <font color="#a02030"># Open the files we made.</font>
    <font color="#000000">idx</font> <font color="#4000C0">=</font> <font color="#0080C0">4</font>
    <font color="#C00000">for</font> <font color="#000000">db</font> <font color="#C00000">in</font> <font color="#4000C0">(</font><font color="#008000">&quot;pdz0.png&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;pdz1.png&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;pdz2.png&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;pdz3.png&quot;</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
        <font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">db</font><font color="#4000C0">)</font>
        <font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;depth&quot;</font><font color="#4000C0">)</font>
        <font color="#000000">pc</font> <font color="#4000C0">=</font> <font color="#000000">GetPlotOptions</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
        <font color="#000000">pc</font><font color="#4000C0">.</font><font color="#000000">max</font> <font color="#4000C0">=</font> <font color="#0080C0">220.</font>
        <font color="#000000">pc</font><font color="#4000C0">.</font><font color="#000000">maxFlag</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
        <font color="#000000">SetPlotOptions</font><font color="#4000C0">(</font><font color="#000000">pc</font><font color="#4000C0">)</font>
        <font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
        <font color="#000000">v</font> <font color="#4000C0">=</font> <font color="#000000">GetView2D</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
        <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">viewportCoords</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
        <font color="#000000">SetView2D</font><font color="#4000C0">(</font><font color="#000000">v</font><font color="#4000C0">)</font>
        <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;pixeldata_1_%02d&quot;</font> <font color="#4000C0">%</font> <font color="#000000">idx</font><font color="#4000C0">)</font>
        <font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
        <font color="#000000">CloseDatabase</font><font color="#4000C0">(</font><font color="#000000">db</font><font color="#4000C0">)</font>
        <font color="#000000">idx</font> <font color="#4000C0">=</font> <font color="#000000">idx</font> <font color="#4000C0">+</font> <font color="#0080C0">1</font>

<font color="#C00000">def</font> <font color="#000000">main</font><font color="#4000C0">(</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#000000">test0</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">test1</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">main</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Exit</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000"></font></font></pre></body></html>