<html><body bgcolor="#e0e0e0"><head><title>operators/reflect.py</title></head><pre><font face="Lucida,Courier New"><font color="#a02030"># ----------------------------------------------------------------------------</font>
<font color="#a02030">#  CLASSES: nightly</font>
<font color="#a02030">#</font>
<font color="#a02030">#  Test Case:  reflect.py</font>
<font color="#a02030">#</font>
<font color="#a02030">#  Tests:      mesh      - 3D curvilinear, single domain,</font>
<font color="#a02030">#                          3D rectilinear, single domain.</font>
<font color="#a02030">#                          3D unstructured, single domain.</font>
<font color="#a02030">#              plots     - pc, vector, subset</font>
<font color="#a02030">#</font>
<font color="#a02030">#  Defect ID:  '5079, '5872, '6321</font>
<font color="#a02030">#</font>
<font color="#a02030">#  Programmer: Hank Childs</font>
<font color="#a02030">#  Date:       June 24, 2004</font>
<font color="#a02030">#</font>
<font color="#a02030">#  Modifications:</font>
<font color="#a02030">#</font>
<font color="#a02030">#    Hank Childs, Fri Aug 13 09:52:28 PDT 2004</font>
<font color="#a02030">#    Test ghost nodes along the reflection plane.</font>
<font color="#a02030">#</font>
<font color="#a02030">#    Hank Childs, Thu Aug 19 16:37:35 PDT 2004</font>
<font color="#a02030">#    Do not test ops_refl12 since that is done in reflect2.py (and will be</font>
<font color="#a02030">#    until SR mode plays well with transparency).</font>
<font color="#a02030">#</font>
<font color="#a02030">#    Jeremy Meredith, Thu Oct 21 11:56:05 PDT 2004</font>
<font color="#a02030">#    Reintegrated ops_refl12 since SR/transparency works now.</font>
<font color="#a02030">#</font>
<font color="#a02030">#    Hank Childs, Thu Jan 20 11:31:43 PST 2005</font>
<font color="#a02030">#    Test projecting then reflecting ['5872].</font>
<font color="#a02030">#</font>
<font color="#a02030">#    Hank Childs, Tue Jul  5 09:29:40 PDT 2005</font>
<font color="#a02030">#    Test that reflected plots are not degenerate by using the volume plot</font>
<font color="#a02030">#    ['6321].</font>
<font color="#a02030">#</font>
<font color="#a02030">#    Jeremy Meredith, Tue Jul 15 10:43:58 EDT 2008</font>
<font color="#a02030">#    Changed number of vectors in vector plot to match the old behavior.</font>
<font color="#a02030">#    (We now account for how many domains there are.)</font>
<font color="#a02030">#</font>
<font color="#a02030">#    Mark C. Miller, Wed Jan 20 07:37:11 PST 2010</font>
<font color="#a02030">#    Added ability to swtich between Silo's HDF5 and PDB data.</font>
<font color="#a02030">#</font>
<font color="#a02030">#    Cyrus Harrison, Thu Mar 25 09:57:34 PDT 2010</font>
<font color="#a02030">#    Added call(s) to DrawPlots() b/c of changes to the default plot state</font>
<font color="#a02030">#    behavior when an operator is added.</font>
<font color="#a02030">#</font>
<font color="#a02030">#    Kathleen Biagas, Mon Dec 19 15:45:38 PST 2016</font>
<font color="#a02030">#    Use FilledBoundary plot for materials instead of Subset.</font>
<font color="#a02030">#</font>
<font color="#a02030">#    Alister Maguire, Wed Apr 25 15:56:47 PDT 2018</font>
<font color="#a02030">#    Added tests for reflecting across an arbitrary plane. </font>
<font color="#a02030">#</font>
<font color="#a02030"># ----------------------------------------------------------------------------</font>


<font color="#a02030"># 3D, rectilinear.  Multi-block  Tests ghost zones as well.</font>
<font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">silo_data_path</font><font color="#4000C0">(</font><font color="#008000">"rect2d.silo"</font><font color="#4000C0">)</font><font color="#4000C0">)</font>


<font color="#000000">atts</font> <font color="#4000C0">=</font> <font color="#000000">ReflectAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">"Pseudocolor"</font><font color="#4000C0">,</font> <font color="#008000">"d"</font><font color="#4000C0">)</font>
<font color="#000000">AddOperator</font><font color="#4000C0">(</font><font color="#008000">"Reflect"</font><font color="#4000C0">)</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">reflections</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">)</font>
<font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">atts</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"ops_refl01"</font><font color="#4000C0">)</font>

<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">"Mesh"</font><font color="#4000C0">,</font> <font color="#008000">"quadmesh2d"</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">"FilledBoundary"</font><font color="#4000C0">,</font> <font color="#008000">"mat1"</font><font color="#4000C0">)</font>
<font color="#000000">SetActivePlots</font><font color="#4000C0">(</font><font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font><font color="#0080C0">1</font><font color="#4000C0">)</font><font color="#4000C0">)</font>
<font color="#000000">AddOperator</font><font color="#4000C0">(</font><font color="#008000">"Reflect"</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">reflections</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">)</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">useXBoundary</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">specifiedX</font> <font color="#4000C0">=</font> <font color="#4000C0">-</font><font color="#0080C0">0.1</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">useYBoundary</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">specifiedY</font> <font color="#4000C0">=</font> <font color="#4000C0">-</font><font color="#0080C0">0.05</font>
<font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">atts</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"ops_refl02"</font><font color="#4000C0">)</font>

<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">silo_data_path</font><font color="#4000C0">(</font><font color="#008000">"curv2d.silo"</font><font color="#4000C0">)</font><font color="#4000C0">)</font>

<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">"Pseudocolor"</font><font color="#4000C0">,</font> <font color="#008000">"d"</font><font color="#4000C0">)</font>
<font color="#000000">AddOperator</font><font color="#4000C0">(</font><font color="#008000">"Reflect"</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"ops_refl03"</font><font color="#4000C0">)</font>

<font color="#000000">AddOperator</font><font color="#4000C0">(</font><font color="#008000">"Isosurface"</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"ops_refl04"</font><font color="#4000C0">)</font>

<font color="#a02030"># Move the isosurface operator before the reflect.  This tests whether</font>
<font color="#a02030"># or not we can reflect polydata.</font>
<font color="#000000">PromoteOperator</font><font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"ops_refl05"</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#a02030"># Test unstructured mesh -- plus test vectors.</font>
<font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">silo_data_path</font><font color="#4000C0">(</font><font color="#008000">"globe.silo"</font><font color="#4000C0">)</font><font color="#4000C0">)</font>

<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">"Vector"</font><font color="#4000C0">,</font> <font color="#008000">"vel"</font><font color="#4000C0">)</font>
<font color="#000000">v</font> <font color="#4000C0">=</font> <font color="#000000">VectorAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">vectorOrigin</font> <font color="#4000C0">=</font> <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">Head</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">nVectors</font> <font color="#4000C0">=</font> <font color="#0080C0">400</font><font color="#4000C0">*</font><font color="#0080C0">4</font>
<font color="#000000">SetPlotOptions</font><font color="#4000C0">(</font><font color="#000000">v</font><font color="#4000C0">)</font>

<font color="#000000">AddOperator</font><font color="#4000C0">(</font><font color="#008000">"Reflect"</font><font color="#4000C0">)</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">reflections</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">useXBoundary</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">useYBoundary</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
<font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">atts</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">v</font> <font color="#4000C0">=</font> <font color="#000000">GetView3D</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">viewNormal</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.324974</font><font color="#4000C0">,</font> <font color="#0080C0">0.839345</font><font color="#4000C0">,</font> <font color="#0080C0">0.435765</font><font color="#4000C0">)</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">focus</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">10</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">10</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">10</font><font color="#4000C0">)</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">viewUp</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.252067</font><font color="#4000C0">,</font> <font color="#0080C0">0.367233</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">0.895322</font><font color="#4000C0">)</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">viewAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">30</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">parallelScale</font> <font color="#4000C0">=</font> <font color="#0080C0">34.641</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">nearPlane</font> <font color="#4000C0">=</font> <font color="#4000C0">-</font><font color="#0080C0">69.282</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">farPlane</font> <font color="#4000C0">=</font> <font color="#0080C0">69.282</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">imagePan</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">)</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">imageZoom</font> <font color="#4000C0">=</font> <font color="#0080C0">1.56244</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">perspective</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">eyeAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">2</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">centerOfRotationSet</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">centerOfRotation</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">)</font>
<font color="#000000">SetView3D</font><font color="#4000C0">(</font><font color="#000000">v</font><font color="#4000C0">)</font>

<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"ops_refl06"</font><font color="#4000C0">)</font>


<font color="#a02030"># Now test a zonal vector variable (different code in the reflect operator).</font>
<font color="#000000">ChangeActivePlotsVar</font><font color="#4000C0">(</font><font color="#008000">"disp"</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"ops_refl07"</font><font color="#4000C0">)</font>

<font color="#000000">disp_atts</font> <font color="#4000C0">=</font> <font color="#000000">DisplaceAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">disp_atts</font><font color="#4000C0">.</font><font color="#000000">variable</font> <font color="#4000C0">=</font> <font color="#008000">"vel"</font>
<font color="#000000">SetDefaultOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">disp_atts</font><font color="#4000C0">)</font>
<font color="#000000">AddOperator</font><font color="#4000C0">(</font><font color="#008000">"Displace"</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"ops_refl08"</font><font color="#4000C0">)</font>

<font color="#000000">PromoteOperator</font><font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">)</font>
<font color="#000000">disp_atts</font><font color="#4000C0">.</font><font color="#000000">variable</font> <font color="#4000C0">=</font> <font color="#008000">"disp"</font>
<font color="#000000">disp_atts</font><font color="#4000C0">.</font><font color="#000000">factor</font> <font color="#4000C0">=</font> <font color="#0080C0">4</font>
<font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">disp_atts</font><font color="#4000C0">)</font>
<font color="#000000">ChangeActivePlotsVar</font><font color="#4000C0">(</font><font color="#008000">"vel"</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"ops_refl09"</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>


<font color="#a02030"># Test that we properly put ghost nodes along the reflection plane.</font>

<font color="#a02030"># There is a lot of code dedicated to creating the ghost nodes for a </font>
<font color="#a02030"># rectilinear grid.  Use the PXPYPZ and NXNYNZ octants to flex all of that </font>
<font color="#a02030"># code.</font>

<font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">silo_data_path</font><font color="#4000C0">(</font><font color="#008000">"noise.silo"</font><font color="#4000C0">)</font><font color="#4000C0">)</font>

<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">"Pseudocolor"</font><font color="#4000C0">,</font> <font color="#008000">"hardyglobal"</font><font color="#4000C0">)</font>
<font color="#000000">pc</font> <font color="#4000C0">=</font> <font color="#000000">PseudocolorAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">pc</font><font color="#4000C0">.</font><font color="#000000">SetOpacityType</font><font color="#4000C0">(</font><font color="#000000">pc</font><font color="#4000C0">.</font><font color="#000000">Constant</font><font color="#4000C0">)</font>
<font color="#000000">pc</font><font color="#4000C0">.</font><font color="#000000">opacity</font> <font color="#4000C0">=</font> <font color="#0080C0">0.3</font>
<font color="#000000">SetPlotOptions</font><font color="#4000C0">(</font><font color="#000000">pc</font><font color="#4000C0">)</font>

<font color="#000000">AddOperator</font><font color="#4000C0">(</font><font color="#008000">"Reflect"</font><font color="#4000C0">)</font>
<font color="#000000">r</font> <font color="#4000C0">=</font> <font color="#000000">ReflectAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">r</font><font color="#4000C0">.</font><font color="#000000">reflections</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">1</font><font color="#4000C0">,</font><font color="#0080C0">1</font><font color="#4000C0">,</font><font color="#0080C0">1</font><font color="#4000C0">,</font><font color="#0080C0">1</font><font color="#4000C0">,</font><font color="#0080C0">1</font><font color="#4000C0">,</font><font color="#0080C0">1</font><font color="#4000C0">,</font><font color="#0080C0">1</font><font color="#4000C0">,</font><font color="#0080C0">1</font><font color="#4000C0">)</font>
<font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">r</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">v</font> <font color="#4000C0">=</font> <font color="#000000">GetView3D</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">viewNormal</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.390471</font><font color="#4000C0">,</font> <font color="#0080C0">0.546441</font><font color="#4000C0">,</font> <font color="#0080C0">0.740901</font><font color="#4000C0">)</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">focus</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">10</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">10</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">10</font><font color="#4000C0">)</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">viewUp</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0.00925777</font><font color="#4000C0">,</font> <font color="#0080C0">0.807079</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">0.590371</font><font color="#4000C0">)</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">viewAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">30</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">parallelScale</font> <font color="#4000C0">=</font> <font color="#0080C0">34.641</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">nearPlane</font> <font color="#4000C0">=</font> <font color="#4000C0">-</font><font color="#0080C0">69.282</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">farPlane</font> <font color="#4000C0">=</font> <font color="#0080C0">69.282</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">imagePan</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">)</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">imageZoom</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">perspective</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">eyeAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">2</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">centerOfRotationSet</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">centerOfRotation</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">)</font>
<font color="#000000">SetView3D</font><font color="#4000C0">(</font><font color="#000000">v</font><font color="#4000C0">)</font>

<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"ops_refl10"</font><font color="#4000C0">)</font>

<font color="#000000">r</font><font color="#4000C0">.</font><font color="#000000">octant</font> <font color="#4000C0">=</font> <font color="#000000">r</font><font color="#4000C0">.</font><font color="#000000">NXNYNZ</font>
<font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">r</font><font color="#4000C0">)</font>

<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">viewNormal</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0.576101</font><font color="#4000C0">,</font> <font color="#0080C0">0.343493</font><font color="#4000C0">,</font> <font color="#0080C0">0.741701</font><font color="#4000C0">)</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">focus</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">10</font><font color="#4000C0">,</font> <font color="#0080C0">10</font><font color="#4000C0">,</font> <font color="#0080C0">10</font><font color="#4000C0">)</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">viewUp</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.15522</font><font color="#4000C0">,</font> <font color="#0080C0">0.936877</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">0.313318</font><font color="#4000C0">)</font>
<font color="#000000">SetView3D</font><font color="#4000C0">(</font><font color="#000000">v</font><font color="#4000C0">)</font>

<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"ops_refl11"</font><font color="#4000C0">)</font>


<font color="#a02030"># Now make sure that this works well with an everyday vtkPointSet as well.</font>
<font color="#a02030"># Also test that we can handle the presence of both ghost nodes (from the</font>
<font color="#a02030"># reflect) and ghost zones (from the multi_ucd3d file).</font>

<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">silo_data_path</font><font color="#4000C0">(</font><font color="#008000">"multi_ucd3d.silo"</font><font color="#4000C0">)</font><font color="#4000C0">)</font>

<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">"Pseudocolor"</font><font color="#4000C0">,</font> <font color="#008000">"d"</font><font color="#4000C0">)</font>
<font color="#000000">SetPlotOptions</font><font color="#4000C0">(</font><font color="#000000">pc</font><font color="#4000C0">)</font>
<font color="#000000">AddOperator</font><font color="#4000C0">(</font><font color="#008000">"Reflect"</font><font color="#4000C0">)</font>
<font color="#000000">r</font> <font color="#4000C0">=</font> <font color="#000000">ReflectAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">r</font><font color="#4000C0">.</font><font color="#000000">reflections</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">1</font><font color="#4000C0">,</font><font color="#0080C0">0</font><font color="#4000C0">,</font><font color="#0080C0">0</font><font color="#4000C0">,</font><font color="#0080C0">0</font><font color="#4000C0">,</font><font color="#0080C0">1</font><font color="#4000C0">,</font><font color="#0080C0">0</font><font color="#4000C0">,</font><font color="#0080C0">0</font><font color="#4000C0">,</font><font color="#0080C0">0</font><font color="#4000C0">)</font>
<font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">r</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">viewNormal</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0.328912</font><font color="#4000C0">,</font> <font color="#0080C0">0.896692</font><font color="#4000C0">,</font> <font color="#0080C0">0.296244</font><font color="#4000C0">)</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">focus</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">2.5</font><font color="#4000C0">,</font> <font color="#0080C0">20</font><font color="#4000C0">)</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">viewUp</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.710536</font><font color="#4000C0">,</font> <font color="#0080C0">0.441617</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">0.547826</font><font color="#4000C0">)</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">viewAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">30</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">parallelScale</font> <font color="#4000C0">=</font> <font color="#0080C0">20.7666</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">nearPlane</font> <font color="#4000C0">=</font> <font color="#4000C0">-</font><font color="#0080C0">41.5331</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">farPlane</font> <font color="#4000C0">=</font> <font color="#0080C0">41.5331</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">imagePan</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.237006</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">0.229008</font><font color="#4000C0">)</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">imageZoom</font> <font color="#4000C0">=</font> <font color="#0080C0">1.25605</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">perspective</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">eyeAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">2</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">centerOfRotationSet</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
<font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">centerOfRotation</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">)</font>
<font color="#000000">SetView3D</font><font color="#4000C0">(</font><font color="#000000">v</font><font color="#4000C0">)</font>

<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"ops_refl12"</font><font color="#4000C0">)</font>

<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">silo_data_path</font><font color="#4000C0">(</font><font color="#008000">"globe.silo"</font><font color="#4000C0">)</font><font color="#4000C0">)</font>

<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">"Boundary"</font><font color="#4000C0">,</font> <font color="#008000">"mat1"</font><font color="#4000C0">)</font>
<font color="#000000">AddOperator</font><font color="#4000C0">(</font><font color="#008000">"Project"</font><font color="#4000C0">)</font>
<font color="#000000">AddOperator</font><font color="#4000C0">(</font><font color="#008000">"Reflect"</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"ops_refl13"</font><font color="#4000C0">)</font>

<font color="#a02030"># The "mass volume extractor" of the volume renderer depends on the</font>
<font color="#a02030"># rectilinear grid not being inverted.  Test that here ('6321).</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">silo_data_path</font><font color="#4000C0">(</font><font color="#008000">"rect3d.silo"</font><font color="#4000C0">)</font><font color="#4000C0">)</font>

<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">"Volume"</font><font color="#4000C0">,</font> <font color="#008000">"d"</font><font color="#4000C0">)</font>
<font color="#000000">AddOperator</font><font color="#4000C0">(</font><font color="#008000">"Reflect"</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"ops_refl14"</font><font color="#4000C0">)</font>

<font color="#a02030">#</font>
<font color="#a02030"># Now test reflecting different datasets over arbitrary planes.</font>
<font color="#a02030">#</font>

<font color="#a02030"># Test 3D rectilinear over arbitrary plane.</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">silo_data_path</font><font color="#4000C0">(</font><font color="#008000">"multi_rect3d.silo"</font><font color="#4000C0">)</font><font color="#4000C0">)</font>

<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">"Pseudocolor"</font> <font color="#4000C0">,</font><font color="#008000">"d"</font><font color="#4000C0">)</font>
<font color="#000000">AddOperator</font><font color="#4000C0">(</font><font color="#008000">"Reflect"</font><font color="#4000C0">)</font>

<font color="#000000">atts</font> <font color="#4000C0">=</font> <font color="#000000">ReflectAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">reflectType</font> <font color="#4000C0">=</font> <font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">Plane</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">planePoint</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">planeNormal</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">4</font><font color="#4000C0">,</font> <font color="#0080C0">5</font><font color="#4000C0">,</font> <font color="#0080C0">6</font><font color="#4000C0">)</font>
<font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">atts</font><font color="#4000C0">)</font>

<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"arb_plane00"</font><font color="#4000C0">)</font>

<font color="#a02030"># Test 3D curvilinear over arbitrary plane. </font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">ResetView</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">silo_data_path</font><font color="#4000C0">(</font><font color="#008000">"curv3d.silo"</font><font color="#4000C0">)</font><font color="#4000C0">)</font>

<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">"Pseudocolor"</font> <font color="#4000C0">,</font><font color="#008000">"v"</font><font color="#4000C0">)</font>
<font color="#000000">AddOperator</font><font color="#4000C0">(</font><font color="#008000">"Reflect"</font><font color="#4000C0">)</font>

<font color="#000000">atts</font> <font color="#4000C0">=</font> <font color="#000000">ReflectAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">reflectType</font> <font color="#4000C0">=</font> <font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">Plane</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">planePoint</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">8</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">3</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">4</font><font color="#4000C0">)</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">planeNormal</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">4.5</font><font color="#4000C0">,</font> <font color="#0080C0">3</font><font color="#4000C0">,</font> <font color="#0080C0">2</font><font color="#4000C0">)</font>
<font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">atts</font><font color="#4000C0">)</font>

<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"arb_plane01"</font><font color="#4000C0">)</font>

<font color="#a02030"># Test 2D curvilinear</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">silo_data_path</font><font color="#4000C0">(</font><font color="#008000">"curv2d.silo"</font><font color="#4000C0">)</font><font color="#4000C0">)</font>

<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">"Pseudocolor"</font> <font color="#4000C0">,</font><font color="#008000">"v"</font><font color="#4000C0">)</font>
<font color="#000000">AddOperator</font><font color="#4000C0">(</font><font color="#008000">"Reflect"</font><font color="#4000C0">)</font>

<font color="#000000">atts</font> <font color="#4000C0">=</font> <font color="#000000">ReflectAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">reflectType</font> <font color="#4000C0">=</font> <font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">Plane</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">planePoint</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">8</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">3</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">)</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">planeNormal</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">4.5</font><font color="#4000C0">,</font> <font color="#0080C0">3</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">)</font>
<font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">atts</font><font color="#4000C0">)</font>

<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"arb_plane02"</font><font color="#4000C0">)</font>

<font color="#a02030"># Test 3D unstructured</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">silo_data_path</font><font color="#4000C0">(</font><font color="#008000">"globe.silo"</font><font color="#4000C0">)</font><font color="#4000C0">)</font>

<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">"Pseudocolor"</font> <font color="#4000C0">,</font><font color="#008000">"v"</font><font color="#4000C0">)</font>
<font color="#000000">AddOperator</font><font color="#4000C0">(</font><font color="#008000">"Reflect"</font><font color="#4000C0">)</font>

<font color="#000000">atts</font> <font color="#4000C0">=</font> <font color="#000000">ReflectAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">reflectType</font> <font color="#4000C0">=</font> <font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">Plane</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">planePoint</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">8</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">3</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">)</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">planeNormal</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">7</font><font color="#4000C0">,</font> <font color="#0080C0">9</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
<font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">atts</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"arb_plane03"</font><font color="#4000C0">)</font>

<font color="#000000">AddOperator</font><font color="#4000C0">(</font><font color="#008000">"Reflect"</font><font color="#4000C0">)</font>

<font color="#000000">atts</font> <font color="#4000C0">=</font> <font color="#000000">ReflectAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">reflectType</font> <font color="#4000C0">=</font> <font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">Plane</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">planePoint</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">20</font><font color="#4000C0">,</font> <font color="#0080C0">15</font><font color="#4000C0">,</font> <font color="#0080C0">19</font><font color="#4000C0">)</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">planeNormal</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">3</font><font color="#4000C0">,</font> <font color="#0080C0">2</font><font color="#4000C0">,</font> <font color="#0080C0">4</font><font color="#4000C0">)</font>
<font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">atts</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"arb_plane04"</font><font color="#4000C0">)</font>

<font color="#000000">Exit</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000"></font></font></pre></body></html>