<html><body bgcolor="#e0e0e0"><head><title>databases/mfem.py</title></head><pre><font face="Lucida,Courier New"><font color="#a02030"># ----------------------------------------------------------------------------</font>
<font color="#a02030">#  CLASSES: nightly</font>
<font color="#a02030">#  LIMIT: 1200</font>
<font color="#a02030">#  Test Case:  mfem.py </font>
<font color="#a02030">#</font>
<font color="#a02030">#  Tests:      mfem files </font>
<font color="#a02030">#</font>
<font color="#a02030">#  Programmer: Cyrus Harrison</font>
<font color="#a02030">#  Date:       Thu Jun 12 14:58:03 PDT 2014</font>
<font color="#a02030">#</font>
<font color="#a02030">#  Modifications:</font>
<font color="#a02030">#    Brad Whitlock, Wed Sep  2 20:56:13 PDT 2020</font>
<font color="#a02030">#    The MFEM reader now provides original cells so artificial mesh lines</font>
<font color="#a02030">#    get removed. There&#x27;s less of a point to seeing them here. Keep min/max</font>
<font color="#a02030">#    refinement levels only. </font>
<font color="#a02030"># </font>
<font color="#a02030">#    Justin Privitera, Mon Oct 17 17:33:30 PDT 2022</font>
<font color="#a02030">#    Added new tests for the new LOR settings. All prior tests use the legacy</font>
<font color="#a02030">#    LOR setting, while new tests use a mix of both.</font>
<font color="#a02030">#</font>
<font color="#a02030">#    Cyrus Harrison, Tue Oct 29 10:52:33 PDT 2024</font>
<font color="#a02030">#    Added wedge example mesh.</font>
<font color="#a02030">#</font>
<font color="#a02030">#    Cyrus Harrison, Mon Oct 20 11:17:19 PDT 2025</font>
<font color="#a02030">#    Added quadrature function examples</font>
<font color="#a02030"># </font>
<font color="#a02030">#    Justin Privitera, Wed Dec 17 14:01:55 PST 2025</font>
<font color="#a02030">#    Reworked and added tests for MFEM LOR.</font>
<font color="#a02030">#</font>
<font color="#a02030"># ----------------------------------------------------------------------------</font>
<font color="#000000">RequiredDatabasePlugin</font><font color="#4000C0">(</font><font color="#008000">&quot;MFEM&quot;</font><font color="#4000C0">)</font>

<font color="#000000">mfem_roots</font>  <font color="#4000C0">=</font> <font color="#000000">glob</font><font color="#4000C0">.</font><font color="#000000">glob</font><font color="#4000C0">(</font><font color="#000000">data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;mfem_test_data/*.mfem_root&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font>
<font color="#000000">mfem_roots</font><font color="#4000C0">.</font><font color="#000000">extend</font><font color="#4000C0">(</font><font color="#000000">glob</font><font color="#4000C0">.</font><font color="#000000">glob</font><font color="#4000C0">(</font><font color="#000000">data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;mfem_wedge_and_pyramid_examples/wedge_*.mfem_root&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font><font color="#4000C0">)</font>
<font color="#000000">input_meshes</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font> <font color="#000000">f</font> <font color="#C00000">for</font> <font color="#000000">f</font> <font color="#C00000">in</font> <font color="#000000">mfem_roots</font> <font color="#C00000">if</font> <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">count</font><font color="#4000C0">(</font><font color="#008000">&quot;ex0&quot;</font><font color="#4000C0">)</font> <font color="#4000C0">==</font> <font color="#0080C0">0</font><font color="#4000C0">]</font>
<font color="#000000">ex01_results</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font> <font color="#000000">f</font> <font color="#C00000">for</font> <font color="#000000">f</font> <font color="#C00000">in</font> <font color="#000000">mfem_roots</font> <font color="#C00000">if</font> <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">count</font><font color="#4000C0">(</font><font color="#008000">&quot;ex01&quot;</font><font color="#4000C0">)</font> <font color="#4000C0">==</font> <font color="#0080C0">1</font><font color="#4000C0">]</font>
<font color="#000000">ex02_results</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font> <font color="#000000">f</font> <font color="#C00000">for</font> <font color="#000000">f</font> <font color="#C00000">in</font> <font color="#000000">mfem_roots</font> <font color="#C00000">if</font> <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">count</font><font color="#4000C0">(</font><font color="#008000">&quot;ex02&quot;</font><font color="#4000C0">)</font> <font color="#4000C0">==</font> <font color="#0080C0">1</font><font color="#4000C0">]</font>
<font color="#000000">mfem_mesh_files</font> <font color="#4000C0">=</font> <font color="#000000">glob</font><font color="#4000C0">.</font><font color="#000000">glob</font><font color="#4000C0">(</font><font color="#000000">data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;mfem_test_data/*.mesh&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font>
<font color="#000000">mfem_quad_func_files</font> <font color="#4000C0">=</font> <font color="#000000">glob</font><font color="#4000C0">.</font><font color="#000000">glob</font><font color="#4000C0">(</font><font color="#000000">data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;mfem_quad_func_test_data/*.mfem_root&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font>
<font color="#000000">mfem_hdiv_hcurl_files</font> <font color="#4000C0">=</font> <font color="#000000">glob</font><font color="#4000C0">.</font><font color="#000000">glob</font><font color="#4000C0">(</font><font color="#000000">data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;mfem_hdiv_hcurl_examples/*.mfem_root&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font>

<font color="#a02030"># A selection of interesting meshes that effectively demonstrate </font>
<font color="#a02030"># discontinuous versus continuous LOR settings</font>
<font color="#000000">mfem_selected_meshes</font> <font color="#4000C0">=</font> <font color="#000000">glob</font><font color="#4000C0">.</font><font color="#000000">glob</font><font color="#4000C0">(</font><font color="#000000">data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;mfem_test_data/amr-hex.mfem_root&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font> <font color="#4000C0">+</font>\
                       <font color="#000000">glob</font><font color="#4000C0">.</font><font color="#000000">glob</font><font color="#4000C0">(</font><font color="#000000">data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;mfem_test_data/ball-nurbs.mfem_root&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font> <font color="#4000C0">+</font>\
                       <font color="#000000">glob</font><font color="#4000C0">.</font><font color="#000000">glob</font><font color="#4000C0">(</font><font color="#000000">data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;mfem_test_data/fichera.mfem_root&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font> <font color="#4000C0">+</font>\
                       <font color="#000000">glob</font><font color="#4000C0">.</font><font color="#000000">glob</font><font color="#4000C0">(</font><font color="#000000">data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;mfem_test_data/klein-bottle.mfem_root&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font> <font color="#4000C0">+</font>\
                       <font color="#000000">glob</font><font color="#4000C0">.</font><font color="#000000">glob</font><font color="#4000C0">(</font><font color="#000000">data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;mfem_test_data/klein-donut.mfem_root&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font> <font color="#4000C0">+</font>\
                       <font color="#000000">glob</font><font color="#4000C0">.</font><font color="#000000">glob</font><font color="#4000C0">(</font><font color="#000000">data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;mfem_test_data/periodic-cube.mfem_root&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font> <font color="#4000C0">+</font>\
                       <font color="#000000">glob</font><font color="#4000C0">.</font><font color="#000000">glob</font><font color="#4000C0">(</font><font color="#000000">data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;mfem_test_data/periodic-hexagon.mfem_root&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font> <font color="#4000C0">+</font>\
                       <font color="#000000">glob</font><font color="#4000C0">.</font><font color="#000000">glob</font><font color="#4000C0">(</font><font color="#000000">data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;mfem_test_data/pipe-nurbs.mfem_root&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font> <font color="#4000C0">+</font>\
                       <font color="#000000">glob</font><font color="#4000C0">.</font><font color="#000000">glob</font><font color="#4000C0">(</font><font color="#000000">data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;mfem_test_data/square-disc-surf.mfem_root&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font> <font color="#4000C0">+</font>\
                       <font color="#000000">glob</font><font color="#4000C0">.</font><font color="#000000">glob</font><font color="#4000C0">(</font><font color="#000000">data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;mfem_test_data/star.mfem_root&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font>

<font color="#C00000">def</font> <font color="#000000">set_test_view</font><font color="#4000C0">(</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#000000">v</font> <font color="#4000C0">=</font> <font color="#000000">View3DAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">viewNormal</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.510614</font><font color="#4000C0">,</font> <font color="#0080C0">0.302695</font><font color="#4000C0">,</font> <font color="#0080C0">0.804767</font><font color="#4000C0">)</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">focus</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">)</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">viewUp</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.0150532</font><font color="#4000C0">,</font> <font color="#0080C0">0.932691</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">0.360361</font><font color="#4000C0">)</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">viewAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">30</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">parallelScale</font> <font color="#4000C0">=</font> <font color="#0080C0">17.3205</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">nearPlane</font> <font color="#4000C0">=</font> <font color="#4000C0">-</font><font color="#0080C0">34.641</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">farPlane</font> <font color="#4000C0">=</font> <font color="#0080C0">34.641</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">imagePan</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">)</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">imageZoom</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">perspective</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">eyeAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">2</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">centerOfRotationSet</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">centerOfRotation</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">)</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">axis3DScaleFlag</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">axis3DScales</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">shear</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">windowValid</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">SetView3D</font><font color="#4000C0">(</font><font color="#000000">v</font><font color="#4000C0">)</font>
<font color="#000000">TestSection</font><font color="#4000C0">(</font><font color="#008000">&quot;Input Mesh Files&quot;</font><font color="#4000C0">)</font>
<font color="#C00000">for</font> <font color="#000000">f</font> <font color="#C00000">in</font> <font color="#000000">input_meshes</font><font color="#4000C0">:</font>
    <font color="#000000">base</font> <font color="#4000C0">=</font> <font color="#000000">os</font><font color="#4000C0">.</font><font color="#000000">path</font><font color="#4000C0">.</font><font color="#000000">splitext</font><font color="#4000C0">(</font><font color="#000000">os</font><font color="#4000C0">.</font><font color="#000000">path</font><font color="#4000C0">.</font><font color="#000000">basename</font><font color="#4000C0">(</font><font color="#000000">f</font><font color="#4000C0">)</font><font color="#4000C0">)</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font>
    <font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">f</font><font color="#4000C0">)</font>
    <font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font><font color="#008000">&quot;main_element_coloring&quot;</font><font color="#4000C0">)</font>
    <font color="#a02030">#pc_atts = PseudocolorAttributes()</font>
    <font color="#a02030">#pc_atts.colorTableName = &quot;PuBuGn&quot;</font>
    <font color="#a02030">#SetPlotOptions(pc_atts)</font>
    <font color="#000000">AddOperator</font><font color="#4000C0">(</font><font color="#008000">&quot;MultiresControl&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Mesh&quot;</font><font color="#4000C0">,</font><font color="#008000">&quot;main&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">AddOperator</font><font color="#4000C0">(</font><font color="#008000">&quot;MultiresControl&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">SetActivePlots</font><font color="#4000C0">(</font><font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font><font color="#0080C0">1</font><font color="#4000C0">)</font><font color="#4000C0">)</font>
    <font color="#000000">levels</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">,</font><font color="#0080C0">20</font><font color="#4000C0">]</font>
    <font color="#C00000">if</font> <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">count</font><font color="#4000C0">(</font><font color="#008000">&quot;amr&quot;</font><font color="#4000C0">)</font> <font color="#4000C0">&gt;</font> <font color="#0080C0">0</font><font color="#4000C0">:</font>
        <font color="#000000">levels</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">,</font><font color="#0080C0">5</font><font color="#4000C0">]</font>
    <font color="#C00000">for</font> <font color="#000000">mres</font> <font color="#C00000">in</font> <font color="#000000">levels</font><font color="#4000C0">:</font>
        <font color="#000000">mc_atts</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
        <font color="#000000">mc_atts</font><font color="#4000C0">.</font><font color="#000000">resolution</font> <font color="#4000C0">=</font> <font color="#000000">mres</font>
        <font color="#000000">mc_atts</font><font color="#4000C0">.</font><font color="#000000">meshRefMethod</font> <font color="#4000C0">=</font> <font color="#000000">mc_atts</font><font color="#4000C0">.</font><font color="#000000">Discontinuous_LOR</font>
        <font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">mc_atts</font><font color="#4000C0">)</font>
        <font color="#000000">ResetView</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
        <font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
        <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;input_mesh_%s_mres_%04d&quot;</font> <font color="#4000C0">%</font> <font color="#4000C0">(</font><font color="#000000">base</font><font color="#4000C0">,</font><font color="#000000">mres</font><font color="#4000C0">)</font><font color="#4000C0">)</font>
    <font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">CloseDatabase</font><font color="#4000C0">(</font><font color="#000000">f</font><font color="#4000C0">)</font>

<font color="#000000">TestSection</font><font color="#4000C0">(</font><font color="#008000">&quot;MFEM Expressions&quot;</font><font color="#4000C0">)</font>
<font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;mfem_test_data/ex02-beam-tet.mfem_root&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font><font color="#008000">&quot;mag-gf&quot;</font><font color="#4000C0">)</font>
<font color="#000000">ResetView</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;mfem_expressions_1&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font><font color="#008000">&quot;comp0&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;mfem_expressions_2&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Vector&quot;</font><font color="#4000C0">,</font><font color="#008000">&quot;curl-gf&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;mfem_expressions_3&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">CloseDatabase</font><font color="#4000C0">(</font><font color="#000000">data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;mfem_test_data/ex02-beam-tet.mfem_root&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font>

<font color="#000000">TestSection</font><font color="#4000C0">(</font><font color="#008000">&quot;Input Mesh Boundary Topology&quot;</font><font color="#4000C0">)</font>
<font color="#C00000">for</font> <font color="#000000">f</font> <font color="#C00000">in</font> <font color="#000000">input_meshes</font><font color="#4000C0">:</font>
    <font color="#000000">base</font> <font color="#4000C0">=</font> <font color="#000000">os</font><font color="#4000C0">.</font><font color="#000000">path</font><font color="#4000C0">.</font><font color="#000000">splitext</font><font color="#4000C0">(</font><font color="#000000">os</font><font color="#4000C0">.</font><font color="#000000">path</font><font color="#4000C0">.</font><font color="#000000">basename</font><font color="#4000C0">(</font><font color="#000000">f</font><font color="#4000C0">)</font><font color="#4000C0">)</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font>
    <font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">f</font><font color="#4000C0">)</font>
    <font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font><font color="#008000">&quot;main_boundary_attribute&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Mesh&quot;</font><font color="#4000C0">,</font><font color="#008000">&quot;main_boundary&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">mesh_atts</font> <font color="#4000C0">=</font> <font color="#000000">MeshAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">mesh_atts</font><font color="#4000C0">.</font><font color="#000000">lineWidth</font> <font color="#4000C0">=</font> <font color="#0080C0">2</font>
    <font color="#000000">SetPlotOptions</font><font color="#4000C0">(</font><font color="#000000">mesh_atts</font><font color="#4000C0">)</font>
    <font color="#000000">ResetView</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;input_mesh_%s_boundary_topo&quot;</font> <font color="#4000C0">%</font> <font color="#4000C0">(</font><font color="#000000">base</font><font color="#4000C0">)</font><font color="#4000C0">)</font>
    <font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">CloseDatabase</font><font color="#4000C0">(</font><font color="#000000">f</font><font color="#4000C0">)</font>

<font color="#000000">TestSection</font><font color="#4000C0">(</font><font color="#008000">&quot;Direct Mesh Open&quot;</font><font color="#4000C0">)</font>
<font color="#C00000">for</font> <font color="#000000">f</font> <font color="#C00000">in</font> <font color="#000000">mfem_mesh_files</font><font color="#4000C0">:</font>
    <font color="#000000">base</font> <font color="#4000C0">=</font> <font color="#000000">os</font><font color="#4000C0">.</font><font color="#000000">path</font><font color="#4000C0">.</font><font color="#000000">splitext</font><font color="#4000C0">(</font><font color="#000000">os</font><font color="#4000C0">.</font><font color="#000000">path</font><font color="#4000C0">.</font><font color="#000000">basename</font><font color="#4000C0">(</font><font color="#000000">f</font><font color="#4000C0">)</font><font color="#4000C0">)</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font>
    <font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">f</font><font color="#4000C0">)</font>
    <font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font><font color="#008000">&quot;main_element_coloring&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">ResetView</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;direct_open_mesh_file_%s&quot;</font> <font color="#4000C0">%</font> <font color="#4000C0">(</font><font color="#000000">base</font><font color="#4000C0">)</font><font color="#4000C0">)</font>
    <font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">CloseDatabase</font><font color="#4000C0">(</font><font color="#000000">f</font><font color="#4000C0">)</font>

<font color="#C00000">def</font> <font color="#000000">test_mfem_quad_func</font><font color="#4000C0">(</font><font color="#000000">tag_name</font><font color="#4000C0">,</font> <font color="#000000">dbfile</font><font color="#4000C0">,</font> <font color="#000000">var_name</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#000000">ResetView</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">base</font> <font color="#4000C0">=</font> <font color="#000000">os</font><font color="#4000C0">.</font><font color="#000000">path</font><font color="#4000C0">.</font><font color="#000000">splitext</font><font color="#4000C0">(</font><font color="#000000">os</font><font color="#4000C0">.</font><font color="#000000">path</font><font color="#4000C0">.</font><font color="#000000">basename</font><font color="#4000C0">(</font><font color="#000000">dbfile</font><font color="#4000C0">)</font><font color="#4000C0">)</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font>
    <font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">dbfile</font><font color="#4000C0">)</font>
    <font color="#a02030"># get the mesh metadata and find the mesh with &quot;quad_func&quot;</font>
    <font color="#000000">md</font> <font color="#4000C0">=</font> <font color="#000000">GetMetaData</font><font color="#4000C0">(</font><font color="#000000">dbfile</font><font color="#4000C0">)</font>
    <font color="#000000">plot_type</font> <font color="#4000C0">=</font> <font color="#008000">&quot;&quot;</font>
    <font color="#000000">qf_mesh_name</font> <font color="#4000C0">=</font> <font color="#008000">&quot;&quot;</font>
    <font color="#C00000">for</font> <font color="#000000">i</font> <font color="#C00000">in</font> <font color="#000000">range</font><font color="#4000C0">(</font><font color="#000000">md</font><font color="#4000C0">.</font><font color="#000000">GetNumScalars</font><font color="#4000C0">(</font><font color="#4000C0">)</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
        <font color="#000000">smd</font> <font color="#4000C0">=</font> <font color="#000000">md</font><font color="#4000C0">.</font><font color="#000000">GetScalars</font><font color="#4000C0">(</font><font color="#000000">i</font><font color="#4000C0">)</font>
        <font color="#C00000">if</font> <font color="#000000">smd</font><font color="#4000C0">.</font><font color="#000000">name</font> <font color="#4000C0">==</font> <font color="#000000">var_name</font><font color="#4000C0">:</font>
            <font color="#000000">plot_type</font> <font color="#4000C0">=</font> <font color="#008000">&quot;Pseudocolor&quot;</font>
            <font color="#000000">qf_mesh_name</font> <font color="#4000C0">=</font> <font color="#000000">smd</font><font color="#4000C0">.</font><font color="#000000">meshName</font>
    <font color="#C00000">for</font> <font color="#000000">i</font> <font color="#C00000">in</font> <font color="#000000">range</font><font color="#4000C0">(</font><font color="#000000">md</font><font color="#4000C0">.</font><font color="#000000">GetNumVectors</font><font color="#4000C0">(</font><font color="#4000C0">)</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
        <font color="#000000">vmd</font> <font color="#4000C0">=</font> <font color="#000000">md</font><font color="#4000C0">.</font><font color="#000000">GetVectors</font><font color="#4000C0">(</font><font color="#000000">i</font><font color="#4000C0">)</font>
        <font color="#C00000">if</font> <font color="#000000">vmd</font><font color="#4000C0">.</font><font color="#000000">name</font> <font color="#4000C0">==</font> <font color="#000000">var_name</font><font color="#4000C0">:</font>
            <font color="#000000">plot_type</font> <font color="#4000C0">=</font> <font color="#008000">&quot;Vector&quot;</font>
            <font color="#000000">qf_mesh_name</font> <font color="#4000C0">=</font> <font color="#000000">vmd</font><font color="#4000C0">.</font><font color="#000000">meshName</font>
    <font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#000000">plot_type</font><font color="#4000C0">,</font> <font color="#000000">var_name</font><font color="#4000C0">)</font>
    <font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Mesh&quot;</font><font color="#4000C0">,</font><font color="#000000">qf_mesh_name</font><font color="#4000C0">)</font>
    <font color="#000000">mesh_atts</font> <font color="#4000C0">=</font> <font color="#000000">MeshAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">mesh_atts</font><font color="#4000C0">.</font><font color="#000000">lineWidth</font> <font color="#4000C0">=</font> <font color="#0080C0">2</font>
    <font color="#000000">mesh_atts</font><font color="#4000C0">.</font><font color="#000000">meshColor</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">255</font><font color="#4000C0">)</font>
    <font color="#000000">mesh_atts</font><font color="#4000C0">.</font><font color="#000000">meshColorSource</font> <font color="#4000C0">=</font> <font color="#000000">mesh_atts</font><font color="#4000C0">.</font><font color="#000000">MeshCustom</font>
    <font color="#000000">SetPlotOptions</font><font color="#4000C0">(</font><font color="#000000">mesh_atts</font><font color="#4000C0">)</font>
    <font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Mesh&quot;</font><font color="#4000C0">,</font><font color="#008000">&quot;main&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">mesh_atts</font> <font color="#4000C0">=</font> <font color="#000000">MeshAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">mesh_atts</font><font color="#4000C0">.</font><font color="#000000">lineWidth</font> <font color="#4000C0">=</font> <font color="#0080C0">4</font>
    <font color="#000000">mesh_atts</font><font color="#4000C0">.</font><font color="#000000">meshColor</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">255</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">255</font><font color="#4000C0">,</font> <font color="#0080C0">255</font><font color="#4000C0">)</font>
    <font color="#000000">mesh_atts</font><font color="#4000C0">.</font><font color="#000000">meshColorSource</font> <font color="#4000C0">=</font> <font color="#000000">mesh_atts</font><font color="#4000C0">.</font><font color="#000000">MeshCustom</font>
    <font color="#000000">SetPlotOptions</font><font color="#4000C0">(</font><font color="#000000">mesh_atts</font><font color="#4000C0">)</font>
    <font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">AddOperator</font><font color="#4000C0">(</font><font color="#008000">&quot;MultiresControl&quot;</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">SetActivePlots</font><font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">)</font>
    <font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">MultiresControlAtts</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">refBasisType</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Gauss_Lobatto_Default</font>
    <font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">MultiresControlAtts</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#000000">tag_name</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_&quot;</font> <font color="#4000C0">+</font> <font color="#000000">base</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_qf_plot_gausslobatto_basis&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">MultiresControlAtts</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">refBasisType</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Closed_Uniform</font>
    <font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">MultiresControlAtts</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#000000">tag_name</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_&quot;</font> <font color="#4000C0">+</font> <font color="#000000">base</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_qf_plot_closeduniform_basis&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">ResetView</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">CloseDatabase</font><font color="#4000C0">(</font><font color="#000000">dbfile</font><font color="#4000C0">)</font>

<font color="#000000">TestSection</font><font color="#4000C0">(</font><font color="#008000">&quot;Quadrature Functions&quot;</font><font color="#4000C0">)</font>
<font color="#C00000">for</font> <font color="#000000">dbfile</font> <font color="#C00000">in</font> <font color="#000000">mfem_quad_func_files</font><font color="#4000C0">:</font>
    <font color="#000000">test_mfem_quad_func</font><font color="#4000C0">(</font><font color="#008000">&quot;quadrature_data&quot;</font><font color="#4000C0">,</font> <font color="#000000">dbfile</font><font color="#4000C0">,</font> <font color="#008000">&quot;quad_field&quot;</font><font color="#4000C0">)</font>

<font color="#C00000">def</font> <font color="#000000">test_mfem_lor_controls_on_mesh</font><font color="#4000C0">(</font><font color="#000000">tag_name</font><font color="#4000C0">,</font> <font color="#000000">dbfile</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#000000">ResetView</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">base</font> <font color="#4000C0">=</font> <font color="#000000">os</font><font color="#4000C0">.</font><font color="#000000">path</font><font color="#4000C0">.</font><font color="#000000">splitext</font><font color="#4000C0">(</font><font color="#000000">os</font><font color="#4000C0">.</font><font color="#000000">path</font><font color="#4000C0">.</font><font color="#000000">basename</font><font color="#4000C0">(</font><font color="#000000">dbfile</font><font color="#4000C0">)</font><font color="#4000C0">)</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font>

    <font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">dbfile</font><font color="#4000C0">)</font>

    <font color="#a02030"># we want to test a picture of a wireframe</font>
    <font color="#a02030"># new LOR should only have the outer edge</font>
    <font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Subset&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;main&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">SubsetAtts</font> <font color="#4000C0">=</font> <font color="#000000">SubsetAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">SubsetAtts</font><font color="#4000C0">.</font><font color="#000000">wireframe</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">SetPlotOptions</font><font color="#4000C0">(</font><font color="#000000">SubsetAtts</font><font color="#4000C0">)</font>
    <font color="#000000">AddOperator</font><font color="#4000C0">(</font><font color="#008000">&quot;MultiresControl&quot;</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">SetActivePlots</font><font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">)</font>
    <font color="#000000">set_test_view</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">MultiresControlAtts</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">resolution</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">meshRefMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Default_LOR</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">refBasisType</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Gauss_Lobatto_Default</font>
    <font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">MultiresControlAtts</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#000000">tag_name</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_&quot;</font> <font color="#4000C0">+</font> <font color="#000000">base</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_default_lor_gausslobatto_basis&quot;</font><font color="#4000C0">)</font>

    <font color="#000000">MultiresControlAtts</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">resolution</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">meshRefMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Default_LOR</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">refBasisType</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Closed_Uniform</font>
    <font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">MultiresControlAtts</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#000000">tag_name</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_&quot;</font> <font color="#4000C0">+</font> <font color="#000000">base</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_default_lor_closeduniform_basis&quot;</font><font color="#4000C0">)</font>

    <font color="#000000">MultiresControlAtts</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">resolution</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">meshRefMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Continuous_LOR</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">refBasisType</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Gauss_Lobatto_Default</font>
    <font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">MultiresControlAtts</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#000000">tag_name</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_&quot;</font> <font color="#4000C0">+</font> <font color="#000000">base</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_continuous_lor_gausslobatto_basis&quot;</font><font color="#4000C0">)</font>

    <font color="#000000">MultiresControlAtts</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">resolution</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">meshRefMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Continuous_LOR</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">refBasisType</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Closed_Uniform</font>
    <font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">MultiresControlAtts</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#000000">tag_name</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_&quot;</font> <font color="#4000C0">+</font> <font color="#000000">base</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_continuous_lor_closeduniform_basis&quot;</font><font color="#4000C0">)</font>

    <font color="#000000">MultiresControlAtts</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">resolution</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">meshRefMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Discontinuous_LOR</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">refBasisType</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Gauss_Lobatto_Default</font>
    <font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">MultiresControlAtts</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#000000">tag_name</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_&quot;</font> <font color="#4000C0">+</font> <font color="#000000">base</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_discontinuous_lor_gausslobatto_basis&quot;</font><font color="#4000C0">)</font>

    <font color="#000000">MultiresControlAtts</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">resolution</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">meshRefMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Discontinuous_LOR</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">refBasisType</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Closed_Uniform</font>
    <font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">MultiresControlAtts</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#000000">tag_name</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_&quot;</font> <font color="#4000C0">+</font> <font color="#000000">base</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_discontinuous_lor_closeduniform_basis&quot;</font><font color="#4000C0">)</font>

    <font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">ResetView</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">CloseDatabase</font><font color="#4000C0">(</font><font color="#000000">dbfile</font><font color="#4000C0">)</font>

<font color="#C00000">def</font> <font color="#000000">test_mfem_lor_controls_on_grid_function</font><font color="#4000C0">(</font><font color="#000000">tag_name</font><font color="#4000C0">,</font> <font color="#000000">f</font><font color="#4000C0">,</font> <font color="#000000">vector</font><font color="#4000C0">=</font><font color="#C00000">False</font><font color="#4000C0">,</font> <font color="#000000">varname</font><font color="#4000C0">=</font><font color="#008000">&quot;gf&quot;</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#000000">base</font> <font color="#4000C0">=</font> <font color="#000000">os</font><font color="#4000C0">.</font><font color="#000000">path</font><font color="#4000C0">.</font><font color="#000000">splitext</font><font color="#4000C0">(</font><font color="#000000">os</font><font color="#4000C0">.</font><font color="#000000">path</font><font color="#4000C0">.</font><font color="#000000">basename</font><font color="#4000C0">(</font><font color="#000000">f</font><font color="#4000C0">)</font><font color="#4000C0">)</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font>
    <font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">f</font><font color="#4000C0">)</font>
    <font color="#C00000">if</font> <font color="#000000">vector</font> <font color="#C00000">is</font> <font color="#C00000">True</font><font color="#4000C0">:</font>
        <font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Vector&quot;</font><font color="#4000C0">,</font><font color="#000000">varname</font><font color="#4000C0">)</font>
        <font color="#000000">VectorAtts</font> <font color="#4000C0">=</font> <font color="#000000">VectorAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
        <font color="#000000">VectorAtts</font><font color="#4000C0">.</font><font color="#000000">origOnly</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
        <font color="#000000">VectorAtts</font><font color="#4000C0">.</font><font color="#000000">useStride</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
        <font color="#000000">VectorAtts</font><font color="#4000C0">.</font><font color="#000000">stride</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
        <font color="#000000">SetPlotOptions</font><font color="#4000C0">(</font><font color="#000000">VectorAtts</font><font color="#4000C0">)</font>
        <font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font><font color="#000000">varname</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_magnitude&quot;</font><font color="#4000C0">)</font>
    <font color="#C00000">else</font><font color="#4000C0">:</font>
        <font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font><font color="#000000">varname</font><font color="#4000C0">)</font>
    <font color="#000000">AddOperator</font><font color="#4000C0">(</font><font color="#008000">&quot;MultiresControl&quot;</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">SetActivePlots</font><font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">)</font>
    <font color="#000000">ResetView</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">MultiresControlAtts</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">resolution</font> <font color="#4000C0">=</font> <font color="#0080C0">3</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">meshRefMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Default_LOR</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">fieldProjMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Default_Projection</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">refBasisType</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Gauss_Lobatto_Default</font>
    <font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">MultiresControlAtts</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#000000">tag_name</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_&quot;</font> <font color="#4000C0">+</font> <font color="#000000">base</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_default_lor_default_proj_gausslobatto_basis&quot;</font><font color="#4000C0">)</font>

    <font color="#000000">MultiresControlAtts</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">resolution</font> <font color="#4000C0">=</font> <font color="#0080C0">3</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">meshRefMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Default_LOR</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">fieldProjMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Default_Projection</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">refBasisType</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Closed_Uniform</font>
    <font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">MultiresControlAtts</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#000000">tag_name</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_&quot;</font> <font color="#4000C0">+</font> <font color="#000000">base</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_default_lor_default_proj_closeduniform_basis&quot;</font><font color="#4000C0">)</font>

    <font color="#000000">MultiresControlAtts</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">resolution</font> <font color="#4000C0">=</font> <font color="#0080C0">3</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">meshRefMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Continuous_LOR</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">fieldProjMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Default_Projection</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">refBasisType</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Gauss_Lobatto_Default</font>
    <font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">MultiresControlAtts</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#000000">tag_name</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_&quot;</font> <font color="#4000C0">+</font> <font color="#000000">base</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_continuous_lor_default_proj_gausslobatto_basis&quot;</font><font color="#4000C0">)</font>

    <font color="#000000">MultiresControlAtts</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">resolution</font> <font color="#4000C0">=</font> <font color="#0080C0">3</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">meshRefMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Continuous_LOR</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">fieldProjMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Default_Projection</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">refBasisType</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Closed_Uniform</font>
    <font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">MultiresControlAtts</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#000000">tag_name</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_&quot;</font> <font color="#4000C0">+</font> <font color="#000000">base</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_continuous_lor_default_proj_closeduniform_basis&quot;</font><font color="#4000C0">)</font>

    <font color="#000000">MultiresControlAtts</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">resolution</font> <font color="#4000C0">=</font> <font color="#0080C0">3</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">meshRefMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Continuous_LOR</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">fieldProjMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Zonal_Projection</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">refBasisType</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Gauss_Lobatto_Default</font>
    <font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">MultiresControlAtts</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#000000">tag_name</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_&quot;</font> <font color="#4000C0">+</font> <font color="#000000">base</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_continuous_lor_zonal_proj_gausslobatto_basis&quot;</font><font color="#4000C0">)</font>

    <font color="#000000">MultiresControlAtts</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">resolution</font> <font color="#4000C0">=</font> <font color="#0080C0">3</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">meshRefMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Continuous_LOR</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">fieldProjMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Zonal_Projection</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">refBasisType</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Closed_Uniform</font>
    <font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">MultiresControlAtts</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#000000">tag_name</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_&quot;</font> <font color="#4000C0">+</font> <font color="#000000">base</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_continuous_lor_zonal_proj_closeduniform_basis&quot;</font><font color="#4000C0">)</font>

    <font color="#000000">MultiresControlAtts</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">resolution</font> <font color="#4000C0">=</font> <font color="#0080C0">3</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">meshRefMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Continuous_LOR</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">fieldProjMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Nodal_Projection</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">refBasisType</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Gauss_Lobatto_Default</font>
    <font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">MultiresControlAtts</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#000000">tag_name</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_&quot;</font> <font color="#4000C0">+</font> <font color="#000000">base</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_continuous_lor_nodal_proj_gausslobatto_basis&quot;</font><font color="#4000C0">)</font>

    <font color="#000000">MultiresControlAtts</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">resolution</font> <font color="#4000C0">=</font> <font color="#0080C0">3</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">meshRefMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Continuous_LOR</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">fieldProjMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Nodal_Projection</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">refBasisType</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Closed_Uniform</font>
    <font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">MultiresControlAtts</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#000000">tag_name</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_&quot;</font> <font color="#4000C0">+</font> <font color="#000000">base</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_continuous_lor_nodal_proj_closeduniform_basis&quot;</font><font color="#4000C0">)</font>

    <font color="#000000">MultiresControlAtts</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">resolution</font> <font color="#4000C0">=</font> <font color="#0080C0">3</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">meshRefMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Discontinuous_LOR</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">fieldProjMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Default_Projection</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">refBasisType</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Gauss_Lobatto_Default</font>
    <font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">MultiresControlAtts</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#000000">tag_name</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_&quot;</font> <font color="#4000C0">+</font> <font color="#000000">base</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_discontinuous_lor_default_proj_gausslobatto_basis&quot;</font><font color="#4000C0">)</font>

    <font color="#000000">MultiresControlAtts</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">resolution</font> <font color="#4000C0">=</font> <font color="#0080C0">3</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">meshRefMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Discontinuous_LOR</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">fieldProjMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Default_Projection</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">refBasisType</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Closed_Uniform</font>
    <font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">MultiresControlAtts</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#000000">tag_name</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_&quot;</font> <font color="#4000C0">+</font> <font color="#000000">base</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_discontinuous_lor_default_proj_closeduniform_basis&quot;</font><font color="#4000C0">)</font>

    <font color="#000000">MultiresControlAtts</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">resolution</font> <font color="#4000C0">=</font> <font color="#0080C0">3</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">meshRefMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Discontinuous_LOR</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">fieldProjMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Nodal_Projection</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">refBasisType</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Gauss_Lobatto_Default</font>
    <font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">MultiresControlAtts</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#000000">tag_name</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_&quot;</font> <font color="#4000C0">+</font> <font color="#000000">base</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_discontinuous_lor_nodal_proj_gausslobatto_basis&quot;</font><font color="#4000C0">)</font>

    <font color="#000000">MultiresControlAtts</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">resolution</font> <font color="#4000C0">=</font> <font color="#0080C0">3</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">meshRefMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Discontinuous_LOR</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">fieldProjMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Nodal_Projection</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">refBasisType</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Closed_Uniform</font>
    <font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">MultiresControlAtts</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#000000">tag_name</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_&quot;</font> <font color="#4000C0">+</font> <font color="#000000">base</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_discontinuous_lor_nodal_proj_closeduniform_basis&quot;</font><font color="#4000C0">)</font>

    <font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">CloseDatabase</font><font color="#4000C0">(</font><font color="#000000">f</font><font color="#4000C0">)</font>

<font color="#C00000">def</font> <font color="#000000">test_mfem_lor_controls_on_special_grid_function</font><font color="#4000C0">(</font><font color="#000000">tag_name</font><font color="#4000C0">,</font> <font color="#000000">dbfile</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#000000">base</font> <font color="#4000C0">=</font> <font color="#000000">os</font><font color="#4000C0">.</font><font color="#000000">path</font><font color="#4000C0">.</font><font color="#000000">splitext</font><font color="#4000C0">(</font><font color="#000000">os</font><font color="#4000C0">.</font><font color="#000000">path</font><font color="#4000C0">.</font><font color="#000000">basename</font><font color="#4000C0">(</font><font color="#000000">dbfile</font><font color="#4000C0">)</font><font color="#4000C0">)</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font>
    <font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">dbfile</font><font color="#4000C0">)</font>
    <font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Vector&quot;</font><font color="#4000C0">,</font><font color="#008000">&quot;gf&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">VectorAtts</font> <font color="#4000C0">=</font> <font color="#000000">VectorAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">VectorAtts</font><font color="#4000C0">.</font><font color="#000000">origOnly</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">VectorAtts</font><font color="#4000C0">.</font><font color="#000000">useStride</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">VectorAtts</font><font color="#4000C0">.</font><font color="#000000">stride</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">SetPlotOptions</font><font color="#4000C0">(</font><font color="#000000">VectorAtts</font><font color="#4000C0">)</font>
    <font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Mesh&quot;</font><font color="#4000C0">,</font><font color="#008000">&quot;main&quot;</font><font color="#4000C0">)</font>
    <font color="#000000">MeshAtts</font> <font color="#4000C0">=</font> <font color="#000000">MeshAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">MeshAtts</font><font color="#4000C0">.</font><font color="#000000">showGenerated</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">SetPlotOptions</font><font color="#4000C0">(</font><font color="#000000">MeshAtts</font><font color="#4000C0">)</font>
    <font color="#000000">SetActivePlots</font><font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">)</font>
    <font color="#000000">ResetView</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">AddOperator</font><font color="#4000C0">(</font><font color="#008000">&quot;MultiresControl&quot;</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>
    <font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">View2DAtts</font> <font color="#4000C0">=</font> <font color="#000000">View2DAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">View2DAtts</font><font color="#4000C0">.</font><font color="#000000">windowCoords</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">6</font><font color="#4000C0">,</font> <font color="#0080C0">8</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">1.0</font><font color="#4000C0">,</font> <font color="#0080C0">0.5</font><font color="#4000C0">)</font>
    <font color="#000000">View2DAtts</font><font color="#4000C0">.</font><font color="#000000">viewportCoords</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0.2</font><font color="#4000C0">,</font> <font color="#0080C0">0.95</font><font color="#4000C0">,</font> <font color="#0080C0">0.15</font><font color="#4000C0">,</font> <font color="#0080C0">0.95</font><font color="#4000C0">)</font>
    <font color="#000000">SetView2D</font><font color="#4000C0">(</font><font color="#000000">View2DAtts</font><font color="#4000C0">)</font>
    <font color="#000000">MultiresControlAtts</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">resolution</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">meshRefMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Continuous_LOR</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">fieldProjMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Zonal_Projection</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">refBasisType</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Gauss_Lobatto_Default</font>
    <font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">MultiresControlAtts</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>

    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#000000">tag_name</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_&quot;</font> <font color="#4000C0">+</font> <font color="#000000">base</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_zonal_continuous&quot;</font><font color="#4000C0">)</font>

    <font color="#000000">MultiresControlAtts</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">resolution</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">meshRefMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Continuous_LOR</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">fieldProjMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Nodal_Projection</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">refBasisType</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Gauss_Lobatto_Default</font>
    <font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">MultiresControlAtts</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>

    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#000000">tag_name</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_&quot;</font> <font color="#4000C0">+</font> <font color="#000000">base</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_nodal_continuous&quot;</font><font color="#4000C0">)</font>

    <font color="#000000">MultiresControlAtts</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">resolution</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">meshRefMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Discontinuous_LOR</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">fieldProjMethod</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Nodal_Projection</font>
    <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">refBasisType</font> <font color="#4000C0">=</font> <font color="#000000">MultiresControlAtts</font><font color="#4000C0">.</font><font color="#000000">Gauss_Lobatto_Default</font>
    <font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">MultiresControlAtts</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">)</font>

    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#000000">tag_name</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_&quot;</font> <font color="#4000C0">+</font> <font color="#000000">base</font> <font color="#4000C0">+</font> <font color="#008000">&quot;_nodal_discontinuous&quot;</font><font color="#4000C0">)</font>

    <font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">CloseDatabase</font><font color="#4000C0">(</font><font color="#000000">dbfile</font><font color="#4000C0">)</font>


<font color="#000000">TestSection</font><font color="#4000C0">(</font><font color="#008000">&quot;LOR Mesh Controls&quot;</font><font color="#4000C0">)</font>
<font color="#a02030"># these are hand-picked meshes that clearly demonstrate the refinement differences</font>
<font color="#C00000">for</font> <font color="#000000">dbfile</font> <font color="#C00000">in</font> <font color="#000000">mfem_selected_meshes</font><font color="#4000C0">:</font>
    <font color="#000000">test_mfem_lor_controls_on_mesh</font><font color="#4000C0">(</font><font color="#008000">&quot;LOR_mesh&quot;</font><font color="#4000C0">,</font> <font color="#000000">dbfile</font><font color="#4000C0">)</font>

<font color="#a02030"># ex01 results all have scalar grid functions</font>
<font color="#000000">TestSection</font><font color="#4000C0">(</font><font color="#008000">&quot;LOR Scalar Field Controls&quot;</font><font color="#4000C0">)</font>
<font color="#C00000">for</font> <font color="#000000">dbfile</font> <font color="#C00000">in</font> <font color="#000000">ex01_results</font><font color="#4000C0">:</font>
    <font color="#000000">test_mfem_lor_controls_on_grid_function</font><font color="#4000C0">(</font><font color="#008000">&quot;LOR_gf&quot;</font><font color="#4000C0">,</font> <font color="#000000">dbfile</font><font color="#4000C0">)</font>

<font color="#000000">TestSection</font><font color="#4000C0">(</font><font color="#008000">&quot;LOR Vector Field Controls Close Up&quot;</font><font color="#4000C0">)</font>
<font color="#C00000">for</font> <font color="#000000">dbfile</font> <font color="#C00000">in</font> <font color="#000000">glob</font><font color="#4000C0">.</font><font color="#000000">glob</font><font color="#4000C0">(</font><font color="#000000">data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;mfem_test_data/ex02-beam-quad.mfem_root&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#000000">test_mfem_lor_controls_on_special_grid_function</font><font color="#4000C0">(</font><font color="#008000">&quot;LOR_vector_gf_closeup&quot;</font><font color="#4000C0">,</font> <font color="#000000">dbfile</font><font color="#4000C0">)</font>

<font color="#000000">TestSection</font><font color="#4000C0">(</font><font color="#008000">&quot;LOR Vector Field Controls&quot;</font><font color="#4000C0">)</font>
<font color="#a02030"># ex02 results all have scalar FE vector grid functions</font>
<font color="#C00000">for</font> <font color="#000000">dbfile</font> <font color="#C00000">in</font> <font color="#000000">ex02_results</font><font color="#4000C0">:</font>
    <font color="#000000">test_mfem_lor_controls_on_grid_function</font><font color="#4000C0">(</font><font color="#008000">&quot;LOR_vector_gf&quot;</font><font color="#4000C0">,</font> <font color="#000000">dbfile</font><font color="#4000C0">,</font> <font color="#000000">vector</font><font color="#4000C0">=</font><font color="#C00000">True</font><font color="#4000C0">)</font>
<font color="#a02030"># hdiv hcurl examples all have vector FE vector grid functions</font>
<font color="#C00000">for</font> <font color="#000000">dbfile</font> <font color="#C00000">in</font> <font color="#000000">mfem_hdiv_hcurl_files</font><font color="#4000C0">:</font>
    <font color="#000000">test_mfem_lor_controls_on_grid_function</font><font color="#4000C0">(</font><font color="#008000">&quot;LOR_vector_gf&quot;</font><font color="#4000C0">,</font> <font color="#000000">dbfile</font><font color="#4000C0">,</font> <font color="#000000">vector</font><font color="#4000C0">=</font><font color="#C00000">True</font><font color="#4000C0">,</font> <font color="#000000">varname</font><font color="#4000C0">=</font><font color="#008000">&quot;solution&quot;</font><font color="#4000C0">)</font>

<font color="#000000">Exit</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000"></font></font></pre></body></html>