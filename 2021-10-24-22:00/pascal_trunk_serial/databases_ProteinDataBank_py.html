<html><body bgcolor="#e0e0e0"><head><title>databases/ProteinDataBank.py</title></head><pre><font face="Lucida,Courier New"><font color="#a02030"># ----------------------------------------------------------------------------</font>
<font color="#a02030">#  CLASSES: nightly</font>
<font color="#a02030">#</font>
<font color="#a02030">#  Test Case:  ProteinDataBank.py</font>
<font color="#a02030">#</font>
<font color="#a02030">#  Tests:      mesh      - 3D points</font>
<font color="#a02030">#              plots     - Molecule</font>
<font color="#a02030">#</font>
<font color="#a02030">#  Programmer: Brad Whitlock</font>
<font color="#a02030">#  Date:       Tue Mar 28 15:46:53 PST 2006</font>
<font color="#a02030">#</font>
<font color="#a02030">#  Modifications:</font>
<font color="#a02030">#    Jeremy Meredith, Tue Aug 29 13:23:30 EDT 2006</font>
<font color="#a02030">#    ProteinDataBank files now have models as directories, not time steps.</font>
<font color="#a02030">#</font>
<font color="#a02030">#    Brad Whitlock, Thu Mar 12 11:04:32 PDT 2009</font>
<font color="#a02030">#    I restructured the test into functions.</font>
<font color="#a02030">#</font>
<font color="#a02030"># ----------------------------------------------------------------------------</font>

<font color="#C00000">def</font> <font color="#000000">LabelTest</font><font color="#4000C0">(</font><font color="#000000">testname</font><font color="#4000C0">,</font> <font color="#000000">var</font><font color="#4000C0">,</font> <font color="#000000">zoomview</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">"Label"</font><font color="#4000C0">,</font> <font color="#000000">var</font><font color="#4000C0">)</font>
    <font color="#000000">LabelAtts</font> <font color="#4000C0">=</font> <font color="#000000">LabelAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">LabelAtts</font><font color="#4000C0">.</font><font color="#000000">legendFlag</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">LabelAtts</font><font color="#4000C0">.</font><font color="#000000">showNodes</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">LabelAtts</font><font color="#4000C0">.</font><font color="#000000">showCells</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">LabelAtts</font><font color="#4000C0">.</font><font color="#000000">restrictNumberOfLabels</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">LabelAtts</font><font color="#4000C0">.</font><font color="#000000">drawLabelsFacing</font> <font color="#4000C0">=</font> <font color="#000000">LabelAtts</font><font color="#4000C0">.</font><font color="#000000">Front</font>  <font color="#a02030"># Front, Back, FrontAndBack</font>
    <font color="#000000">LabelAtts</font><font color="#4000C0">.</font><font color="#000000">labelDisplayFormat</font> <font color="#4000C0">=</font> <font color="#000000">LabelAtts</font><font color="#4000C0">.</font><font color="#000000">Natural</font>  <font color="#a02030"># Natural, LogicalIndex, Index</font>
    <font color="#000000">LabelAtts</font><font color="#4000C0">.</font><font color="#000000">numberOfLabels</font> <font color="#4000C0">=</font> <font color="#0080C0">200</font>
    <font color="#000000">LabelAtts</font><font color="#4000C0">.</font><font color="#000000">specifyTextColor1</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">LabelAtts</font><font color="#4000C0">.</font><font color="#000000">textColor1</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">255</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">255</font><font color="#4000C0">)</font>
    <font color="#000000">LabelAtts</font><font color="#4000C0">.</font><font color="#000000">textHeight1</font> <font color="#4000C0">=</font> <font color="#0080C0">0.03</font>
    <font color="#000000">LabelAtts</font><font color="#4000C0">.</font><font color="#000000">specifyTextColor2</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">LabelAtts</font><font color="#4000C0">.</font><font color="#000000">textColor2</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">255</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">)</font>
    <font color="#000000">LabelAtts</font><font color="#4000C0">.</font><font color="#000000">textHeight2</font> <font color="#4000C0">=</font> <font color="#0080C0">0.02</font>
    <font color="#000000">LabelAtts</font><font color="#4000C0">.</font><font color="#000000">horizontalJustification</font> <font color="#4000C0">=</font> <font color="#000000">LabelAtts</font><font color="#4000C0">.</font><font color="#000000">HCenter</font>  <font color="#a02030"># HCenter, Left, Right</font>
    <font color="#000000">LabelAtts</font><font color="#4000C0">.</font><font color="#000000">verticalJustification</font> <font color="#4000C0">=</font> <font color="#000000">LabelAtts</font><font color="#4000C0">.</font><font color="#000000">VCenter</font>  <font color="#a02030"># VCenter, Top, Bottom</font>
    <font color="#000000">LabelAtts</font><font color="#4000C0">.</font><font color="#000000">depthTestMode</font> <font color="#4000C0">=</font> <font color="#000000">LabelAtts</font><font color="#4000C0">.</font><font color="#000000">LABEL_DT_AUTO</font>  <font color="#a02030"># LABEL_DT_AUTO, LABEL_DT_ALWAYS, LABEL_DT_NEVER</font>
    <font color="#000000">SetPlotOptions</font><font color="#4000C0">(</font><font color="#000000">LabelAtts</font><font color="#4000C0">)</font>
    <font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">oldview</font> <font color="#4000C0">=</font> <font color="#000000">GetView3D</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">SetView3D</font><font color="#4000C0">(</font><font color="#000000">zoomview</font><font color="#4000C0">)</font>
    <font color="#a02030"># Save these images somewhat larger than a regular test case image</font>
    <font color="#a02030"># since the images contain a lot of text.</font>
<font color="#a02030">#    swa = SaveWindowAttributes()</font>
<font color="#a02030">#    swa.width = 500</font>
<font color="#a02030">#    swa.height = 500</font>
<font color="#a02030">#    swa.screenCapture = 0</font>
<font color="#a02030">#    Test(testname, swa)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#000000">testname</font><font color="#4000C0">)</font>
    <font color="#000000">DeleteActivePlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">SetView3D</font><font color="#4000C0">(</font><font color="#000000">oldview</font><font color="#4000C0">)</font>


<font color="#C00000">def</font> <font color="#000000">AddMoleculePlot</font><font color="#4000C0">(</font><font color="#000000">db</font><font color="#4000C0">,</font> <font color="#000000">var</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">db</font><font color="#4000C0">)</font>
    <font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">"Molecule"</font><font color="#4000C0">,</font> <font color="#000000">var</font><font color="#4000C0">)</font>

    <font color="#000000">MoleculeAtts</font> <font color="#4000C0">=</font> <font color="#000000">MoleculeAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">MoleculeAtts</font><font color="#4000C0">.</font><font color="#000000">drawAtomsAs</font> <font color="#4000C0">=</font> <font color="#000000">MoleculeAtts</font><font color="#4000C0">.</font><font color="#000000">SphereAtoms</font>  <font color="#a02030"># NoAtoms, SphereAtoms, ImposterAtoms</font>
    <font color="#000000">MoleculeAtts</font><font color="#4000C0">.</font><font color="#000000">scaleRadiusBy</font> <font color="#4000C0">=</font> <font color="#000000">MoleculeAtts</font><font color="#4000C0">.</font><font color="#000000">Fixed</font>  <font color="#a02030"># Fixed, Covalent, Atomic, Variable</font>
    <font color="#000000">MoleculeAtts</font><font color="#4000C0">.</font><font color="#000000">drawBondsAs</font> <font color="#4000C0">=</font> <font color="#000000">MoleculeAtts</font><font color="#4000C0">.</font><font color="#000000">CylinderBonds</font>  <font color="#a02030"># NoBonds, LineBonds, CylinderBonds</font>
    <font color="#000000">MoleculeAtts</font><font color="#4000C0">.</font><font color="#000000">colorBonds</font> <font color="#4000C0">=</font> <font color="#000000">MoleculeAtts</font><font color="#4000C0">.</font><font color="#000000">ColorByAtom</font>  <font color="#a02030"># ColorByAtom, SingleColor</font>
    <font color="#000000">MoleculeAtts</font><font color="#4000C0">.</font><font color="#000000">bondSingleColor</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">128</font><font color="#4000C0">,</font> <font color="#0080C0">128</font><font color="#4000C0">,</font> <font color="#0080C0">128</font><font color="#4000C0">,</font> <font color="#0080C0">255</font><font color="#4000C0">)</font>
    <font color="#000000">MoleculeAtts</font><font color="#4000C0">.</font><font color="#000000">radiusVariable</font> <font color="#4000C0">=</font> <font color="#008000">"default"</font>
    <font color="#000000">MoleculeAtts</font><font color="#4000C0">.</font><font color="#000000">radiusScaleFactor</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">MoleculeAtts</font><font color="#4000C0">.</font><font color="#000000">radiusFixed</font> <font color="#4000C0">=</font> <font color="#0080C0">0.4</font>
    <font color="#000000">MoleculeAtts</font><font color="#4000C0">.</font><font color="#000000">atomSphereQuality</font> <font color="#4000C0">=</font> <font color="#000000">MoleculeAtts</font><font color="#4000C0">.</font><font color="#000000">Medium</font>  <font color="#a02030"># Low, Medium, High, Super</font>
    <font color="#000000">MoleculeAtts</font><font color="#4000C0">.</font><font color="#000000">bondCylinderQuality</font> <font color="#4000C0">=</font> <font color="#000000">MoleculeAtts</font><font color="#4000C0">.</font><font color="#000000">Medium</font>  <font color="#a02030"># Low, Medium, High, Super</font>
    <font color="#000000">MoleculeAtts</font><font color="#4000C0">.</font><font color="#000000">bondRadius</font> <font color="#4000C0">=</font> <font color="#0080C0">0.12</font>
    <font color="#000000">MoleculeAtts</font><font color="#4000C0">.</font><font color="#000000">bondLineWidth</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">MoleculeAtts</font><font color="#4000C0">.</font><font color="#000000">bondLineStyle</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">MoleculeAtts</font><font color="#4000C0">.</font><font color="#000000">elementColorTable</font> <font color="#4000C0">=</font> <font color="#008000">"cpk_jmol"</font>
    <font color="#000000">MoleculeAtts</font><font color="#4000C0">.</font><font color="#000000">residueTypeColorTable</font> <font color="#4000C0">=</font> <font color="#008000">"amino_shapely"</font>
    <font color="#000000">MoleculeAtts</font><font color="#4000C0">.</font><font color="#000000">residueSequenceColorTable</font> <font color="#4000C0">=</font> <font color="#008000">"Default"</font>
    <font color="#000000">MoleculeAtts</font><font color="#4000C0">.</font><font color="#000000">continuousColorTable</font> <font color="#4000C0">=</font> <font color="#008000">"Default"</font>
    <font color="#000000">MoleculeAtts</font><font color="#4000C0">.</font><font color="#000000">legendFlag</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">MoleculeAtts</font><font color="#4000C0">.</font><font color="#000000">minFlag</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">MoleculeAtts</font><font color="#4000C0">.</font><font color="#000000">scalarMin</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">MoleculeAtts</font><font color="#4000C0">.</font><font color="#000000">maxFlag</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">MoleculeAtts</font><font color="#4000C0">.</font><font color="#000000">scalarMax</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">SetPlotOptions</font><font color="#4000C0">(</font><font color="#000000">MoleculeAtts</font><font color="#4000C0">)</font>
    <font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>


<font color="#C00000">def</font> <font color="#000000">test0</font><font color="#4000C0">(</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#000000">TestSection</font><font color="#4000C0">(</font><font color="#008000">"Testing Rattlesnake venom"</font><font color="#4000C0">)</font>
    <font color="#000000">AddMoleculePlot</font><font color="#4000C0">(</font><font color="#000000">data_path</font><font color="#4000C0">(</font><font color="#008000">"ProteinDataBank_test_data/crotamine.pdb"</font><font color="#4000C0">)</font><font color="#4000C0">,</font> <font color="#008000">"element"</font><font color="#4000C0">)</font>

    <font color="#000000">v0</font> <font color="#4000C0">=</font> <font color="#000000">View3DAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">v0</font><font color="#4000C0">.</font><font color="#000000">viewNormal</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.967329</font><font color="#4000C0">,</font> <font color="#0080C0">0.252251</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">0.0253765</font><font color="#4000C0">)</font>
    <font color="#000000">v0</font><font color="#4000C0">.</font><font color="#000000">focus</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">31.726</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">54.1675</font><font color="#4000C0">,</font> <font color="#0080C0">13.645</font><font color="#4000C0">)</font>
    <font color="#000000">v0</font><font color="#4000C0">.</font><font color="#000000">viewUp</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0.252129</font><font color="#4000C0">,</font> <font color="#0080C0">0.967661</font><font color="#4000C0">,</font> <font color="#0080C0">0.0079404</font><font color="#4000C0">)</font>
    <font color="#000000">v0</font><font color="#4000C0">.</font><font color="#000000">viewAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">30</font>
    <font color="#000000">v0</font><font color="#4000C0">.</font><font color="#000000">parallelScale</font> <font color="#4000C0">=</font> <font color="#0080C0">24.9831</font>
    <font color="#000000">v0</font><font color="#4000C0">.</font><font color="#000000">nearPlane</font> <font color="#4000C0">=</font> <font color="#4000C0">-</font><font color="#0080C0">49.9661</font>
    <font color="#000000">v0</font><font color="#4000C0">.</font><font color="#000000">farPlane</font> <font color="#4000C0">=</font> <font color="#0080C0">49.9661</font>
    <font color="#000000">v0</font><font color="#4000C0">.</font><font color="#000000">imagePan</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">)</font>
    <font color="#000000">v0</font><font color="#4000C0">.</font><font color="#000000">imageZoom</font> <font color="#4000C0">=</font> <font color="#0080C0">1.44471</font>
    <font color="#000000">v0</font><font color="#4000C0">.</font><font color="#000000">perspective</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">v0</font><font color="#4000C0">.</font><font color="#000000">eyeAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">2</font>
    <font color="#000000">v0</font><font color="#4000C0">.</font><font color="#000000">centerOfRotationSet</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">v0</font><font color="#4000C0">.</font><font color="#000000">centerOfRotation</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">31.726</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">54.1675</font><font color="#4000C0">,</font> <font color="#0080C0">13.645</font><font color="#4000C0">)</font>
    <font color="#000000">SetView3D</font><font color="#4000C0">(</font><font color="#000000">v0</font><font color="#4000C0">)</font>

    <font color="#000000">v0zoom</font> <font color="#4000C0">=</font> <font color="#000000">View3DAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">v0zoom</font><font color="#4000C0">.</font><font color="#000000">viewNormal</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.967329</font><font color="#4000C0">,</font> <font color="#0080C0">0.252251</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">0.0253765</font><font color="#4000C0">)</font>
    <font color="#000000">v0zoom</font><font color="#4000C0">.</font><font color="#000000">focus</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">31.726</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">54.1675</font><font color="#4000C0">,</font> <font color="#0080C0">13.645</font><font color="#4000C0">)</font>
    <font color="#000000">v0zoom</font><font color="#4000C0">.</font><font color="#000000">viewUp</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0.252129</font><font color="#4000C0">,</font> <font color="#0080C0">0.967661</font><font color="#4000C0">,</font> <font color="#0080C0">0.0079404</font><font color="#4000C0">)</font>
    <font color="#000000">v0zoom</font><font color="#4000C0">.</font><font color="#000000">viewAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">30</font>
    <font color="#000000">v0zoom</font><font color="#4000C0">.</font><font color="#000000">parallelScale</font> <font color="#4000C0">=</font> <font color="#0080C0">24.9831</font>
    <font color="#000000">v0zoom</font><font color="#4000C0">.</font><font color="#000000">nearPlane</font> <font color="#4000C0">=</font> <font color="#4000C0">-</font><font color="#0080C0">49.9661</font>
    <font color="#000000">v0zoom</font><font color="#4000C0">.</font><font color="#000000">farPlane</font> <font color="#4000C0">=</font> <font color="#0080C0">49.9661</font>
    <font color="#000000">v0zoom</font><font color="#4000C0">.</font><font color="#000000">imagePan</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">)</font>
    <font color="#000000">v0zoom</font><font color="#4000C0">.</font><font color="#000000">imageZoom</font> <font color="#4000C0">=</font> <font color="#0080C0">7.15293</font>
    <font color="#000000">v0zoom</font><font color="#4000C0">.</font><font color="#000000">perspective</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">v0zoom</font><font color="#4000C0">.</font><font color="#000000">eyeAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">2</font>
    <font color="#000000">v0zoom</font><font color="#4000C0">.</font><font color="#000000">centerOfRotationSet</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">v0zoom</font><font color="#4000C0">.</font><font color="#000000">centerOfRotation</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">31.726</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">54.1675</font><font color="#4000C0">,</font> <font color="#0080C0">13.645</font><font color="#4000C0">)</font>

    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"proteindb_0_00"</font><font color="#4000C0">)</font>
    <font color="#000000">LabelTest</font><font color="#4000C0">(</font><font color="#008000">"proteindb_0_01"</font><font color="#4000C0">,</font> <font color="#008000">"elementname"</font><font color="#4000C0">,</font> <font color="#000000">v0zoom</font><font color="#4000C0">)</font>

    <font color="#000000">ChangeActivePlotsVar</font><font color="#4000C0">(</font><font color="#008000">"resseq"</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"proteindb_0_02"</font><font color="#4000C0">)</font>
    <font color="#000000">LabelTest</font><font color="#4000C0">(</font><font color="#008000">"proteindb_0_03"</font><font color="#4000C0">,</font> <font color="#008000">"resseq"</font><font color="#4000C0">,</font> <font color="#000000">v0zoom</font><font color="#4000C0">)</font>

    <font color="#000000">ChangeActivePlotsVar</font><font color="#4000C0">(</font><font color="#008000">"backbone"</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"proteindb_0_04"</font><font color="#4000C0">)</font>

    <font color="#000000">ChangeActivePlotsVar</font><font color="#4000C0">(</font><font color="#008000">"restype"</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"proteindb_0_05"</font><font color="#4000C0">)</font>
    <font color="#000000">LabelTest</font><font color="#4000C0">(</font><font color="#008000">"proteindb_0_06"</font><font color="#4000C0">,</font> <font color="#008000">"resname"</font><font color="#4000C0">,</font> <font color="#000000">v0zoom</font><font color="#4000C0">)</font>

    <font color="#000000">LabelTest</font><font color="#4000C0">(</font><font color="#008000">"proteindb_0_07"</font><font color="#4000C0">,</font> <font color="#008000">"longresname"</font><font color="#4000C0">,</font> <font color="#000000">v0zoom</font><font color="#4000C0">)</font>
    <font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>


<font color="#C00000">def</font> <font color="#000000">test1</font><font color="#4000C0">(</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#000000">TestSection</font><font color="#4000C0">(</font><font color="#008000">"Testing small DNA"</font><font color="#4000C0">)</font>
    <font color="#000000">AddMoleculePlot</font><font color="#4000C0">(</font><font color="#000000">data_path</font><font color="#4000C0">(</font><font color="#008000">"ProteinDataBank_test_data/1NTS.pdb"</font><font color="#4000C0">)</font><font color="#4000C0">,</font> <font color="#008000">"element"</font><font color="#4000C0">)</font>

    <font color="#000000">v1</font> <font color="#4000C0">=</font> <font color="#000000">View3DAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">v1</font><font color="#4000C0">.</font><font color="#000000">viewNormal</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.320353</font><font color="#4000C0">,</font> <font color="#0080C0">0.944248</font><font color="#4000C0">,</font> <font color="#0080C0">0.075961</font><font color="#4000C0">)</font>
    <font color="#000000">v1</font><font color="#4000C0">.</font><font color="#000000">focus</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.0580001</font><font color="#4000C0">,</font> <font color="#0080C0">0.0915003</font><font color="#4000C0">,</font> <font color="#0080C0">0.3815</font><font color="#4000C0">)</font>
    <font color="#000000">v1</font><font color="#4000C0">.</font><font color="#000000">viewUp</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0.342959</font><font color="#4000C0">,</font> <font color="#0080C0">0.190354</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">0.919861</font><font color="#4000C0">)</font>
    <font color="#000000">v1</font><font color="#4000C0">.</font><font color="#000000">viewAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">30</font>
    <font color="#000000">v1</font><font color="#4000C0">.</font><font color="#000000">parallelScale</font> <font color="#4000C0">=</font> <font color="#0080C0">22.575</font>
    <font color="#000000">v1</font><font color="#4000C0">.</font><font color="#000000">nearPlane</font> <font color="#4000C0">=</font> <font color="#4000C0">-</font><font color="#0080C0">45.1501</font>
    <font color="#000000">v1</font><font color="#4000C0">.</font><font color="#000000">farPlane</font> <font color="#4000C0">=</font> <font color="#0080C0">45.1501</font>
    <font color="#000000">v1</font><font color="#4000C0">.</font><font color="#000000">imagePan</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.0021177</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">0.0481532</font><font color="#4000C0">)</font>
    <font color="#000000">v1</font><font color="#4000C0">.</font><font color="#000000">imageZoom</font> <font color="#4000C0">=</font> <font color="#0080C0">1.27797</font>
    <font color="#000000">v1</font><font color="#4000C0">.</font><font color="#000000">perspective</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">v1</font><font color="#4000C0">.</font><font color="#000000">eyeAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">2</font>
    <font color="#000000">v1</font><font color="#4000C0">.</font><font color="#000000">centerOfRotationSet</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">v1</font><font color="#4000C0">.</font><font color="#000000">centerOfRotation</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.0580001</font><font color="#4000C0">,</font> <font color="#0080C0">0.0915003</font><font color="#4000C0">,</font> <font color="#0080C0">0.3815</font><font color="#4000C0">)</font>
    <font color="#000000">SetView3D</font><font color="#4000C0">(</font><font color="#000000">v1</font><font color="#4000C0">)</font>

    <font color="#000000">v1zoom</font> <font color="#4000C0">=</font> <font color="#000000">View3DAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">v1zoom</font><font color="#4000C0">.</font><font color="#000000">viewNormal</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.320353</font><font color="#4000C0">,</font> <font color="#0080C0">0.944248</font><font color="#4000C0">,</font> <font color="#0080C0">0.075961</font><font color="#4000C0">)</font>
    <font color="#000000">v1zoom</font><font color="#4000C0">.</font><font color="#000000">focus</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.0580001</font><font color="#4000C0">,</font> <font color="#0080C0">0.0915003</font><font color="#4000C0">,</font> <font color="#0080C0">0.3815</font><font color="#4000C0">)</font>
    <font color="#000000">v1zoom</font><font color="#4000C0">.</font><font color="#000000">viewUp</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0.342959</font><font color="#4000C0">,</font> <font color="#0080C0">0.190354</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">0.919861</font><font color="#4000C0">)</font>
    <font color="#000000">v1zoom</font><font color="#4000C0">.</font><font color="#000000">viewAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">30</font>
    <font color="#000000">v1zoom</font><font color="#4000C0">.</font><font color="#000000">parallelScale</font> <font color="#4000C0">=</font> <font color="#0080C0">22.575</font>
    <font color="#000000">v1zoom</font><font color="#4000C0">.</font><font color="#000000">nearPlane</font> <font color="#4000C0">=</font> <font color="#4000C0">-</font><font color="#0080C0">45.1501</font>
    <font color="#000000">v1zoom</font><font color="#4000C0">.</font><font color="#000000">farPlane</font> <font color="#4000C0">=</font> <font color="#0080C0">45.1501</font>
    <font color="#000000">v1zoom</font><font color="#4000C0">.</font><font color="#000000">imagePan</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.00906313</font><font color="#4000C0">,</font> <font color="#0080C0">0.0442979</font><font color="#4000C0">)</font>
    <font color="#000000">v1zoom</font><font color="#4000C0">.</font><font color="#000000">imageZoom</font> <font color="#4000C0">=</font> <font color="#0080C0">6.4294</font>
    <font color="#000000">v1zoom</font><font color="#4000C0">.</font><font color="#000000">perspective</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">v1zoom</font><font color="#4000C0">.</font><font color="#000000">eyeAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">2</font>
    <font color="#000000">v1zoom</font><font color="#4000C0">.</font><font color="#000000">centerOfRotationSet</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">v1zoom</font><font color="#4000C0">.</font><font color="#000000">centerOfRotation</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.0580001</font><font color="#4000C0">,</font> <font color="#0080C0">0.0915003</font><font color="#4000C0">,</font> <font color="#0080C0">0.3815</font><font color="#4000C0">)</font>

    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"proteindb_1_00"</font><font color="#4000C0">)</font>
    <font color="#000000">LabelTest</font><font color="#4000C0">(</font><font color="#008000">"proteindb_1_01"</font><font color="#4000C0">,</font> <font color="#008000">"elementname"</font><font color="#4000C0">,</font> <font color="#000000">v1zoom</font><font color="#4000C0">)</font>

    <font color="#000000">ChangeActivePlotsVar</font><font color="#4000C0">(</font><font color="#008000">"resseq"</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"proteindb_1_02"</font><font color="#4000C0">)</font>
    <font color="#000000">LabelTest</font><font color="#4000C0">(</font><font color="#008000">"proteindb_1_03"</font><font color="#4000C0">,</font> <font color="#008000">"resseq"</font><font color="#4000C0">,</font> <font color="#000000">v1zoom</font><font color="#4000C0">)</font>

    <font color="#000000">ChangeActivePlotsVar</font><font color="#4000C0">(</font><font color="#008000">"backbone"</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"proteindb_1_04"</font><font color="#4000C0">)</font>

    <font color="#000000">ChangeActivePlotsVar</font><font color="#4000C0">(</font><font color="#008000">"restype"</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"proteindb_1_05"</font><font color="#4000C0">)</font>
    <font color="#000000">LabelTest</font><font color="#4000C0">(</font><font color="#008000">"proteindb_1_06"</font><font color="#4000C0">,</font> <font color="#008000">"resname"</font><font color="#4000C0">,</font> <font color="#000000">v1zoom</font><font color="#4000C0">)</font>

    <font color="#000000">LabelTest</font><font color="#4000C0">(</font><font color="#008000">"proteindb_1_07"</font><font color="#4000C0">,</font> <font color="#008000">"longresname"</font><font color="#4000C0">,</font> <font color="#000000">v1zoom</font><font color="#4000C0">)</font>
    <font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>


<font color="#C00000">def</font> <font color="#000000">test2</font><font color="#4000C0">(</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#000000">TestSection</font><font color="#4000C0">(</font><font color="#008000">"Testing insulin"</font><font color="#4000C0">)</font>
    <font color="#000000">AddMoleculePlot</font><font color="#4000C0">(</font><font color="#000000">data_path</font><font color="#4000C0">(</font><font color="#008000">"ProteinDataBank_test_data/1UZ9.pdb"</font><font color="#4000C0">)</font><font color="#4000C0">,</font> <font color="#008000">"element"</font><font color="#4000C0">)</font>

    <font color="#000000">v2</font> <font color="#4000C0">=</font> <font color="#000000">View3DAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">v2</font><font color="#4000C0">.</font><font color="#000000">viewNormal</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0.215329</font><font color="#4000C0">,</font> <font color="#0080C0">0.245957</font><font color="#4000C0">,</font> <font color="#0080C0">0.94506</font><font color="#4000C0">)</font>
    <font color="#000000">v2</font><font color="#4000C0">.</font><font color="#000000">focus</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">23.441</font><font color="#4000C0">,</font> <font color="#0080C0">26.835</font><font color="#4000C0">,</font> <font color="#0080C0">23.6865</font><font color="#4000C0">)</font>
    <font color="#000000">v2</font><font color="#4000C0">.</font><font color="#000000">viewUp</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.351063</font><font color="#4000C0">,</font> <font color="#0080C0">0.922561</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">0.160113</font><font color="#4000C0">)</font>
    <font color="#000000">v2</font><font color="#4000C0">.</font><font color="#000000">viewAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">30</font>
    <font color="#000000">v2</font><font color="#4000C0">.</font><font color="#000000">parallelScale</font> <font color="#4000C0">=</font> <font color="#0080C0">29.1931</font>
    <font color="#000000">v2</font><font color="#4000C0">.</font><font color="#000000">nearPlane</font> <font color="#4000C0">=</font> <font color="#4000C0">-</font><font color="#0080C0">58.3862</font>
    <font color="#000000">v2</font><font color="#4000C0">.</font><font color="#000000">farPlane</font> <font color="#4000C0">=</font> <font color="#0080C0">58.3862</font>
    <font color="#000000">v2</font><font color="#4000C0">.</font><font color="#000000">imagePan</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0.0260607</font><font color="#4000C0">,</font> <font color="#0080C0">0.00408113</font><font color="#4000C0">)</font>
    <font color="#000000">v2</font><font color="#4000C0">.</font><font color="#000000">imageZoom</font> <font color="#4000C0">=</font> <font color="#0080C0">1.8463</font>
    <font color="#000000">v2</font><font color="#4000C0">.</font><font color="#000000">perspective</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">v2</font><font color="#4000C0">.</font><font color="#000000">eyeAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">2</font>
    <font color="#000000">v2</font><font color="#4000C0">.</font><font color="#000000">centerOfRotationSet</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">v2</font><font color="#4000C0">.</font><font color="#000000">centerOfRotation</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">23.441</font><font color="#4000C0">,</font> <font color="#0080C0">26.835</font><font color="#4000C0">,</font> <font color="#0080C0">23.6865</font><font color="#4000C0">)</font>
    <font color="#000000">SetView3D</font><font color="#4000C0">(</font><font color="#000000">v2</font><font color="#4000C0">)</font>

    <font color="#000000">v2zoom</font> <font color="#4000C0">=</font> <font color="#000000">View3DAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">v2zoom</font><font color="#4000C0">.</font><font color="#000000">viewNormal</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0.685414</font><font color="#4000C0">,</font> <font color="#0080C0">0.259247</font><font color="#4000C0">,</font> <font color="#0080C0">0.68044</font><font color="#4000C0">)</font>
    <font color="#000000">v2zoom</font><font color="#4000C0">.</font><font color="#000000">focus</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">23.441</font><font color="#4000C0">,</font> <font color="#0080C0">26.835</font><font color="#4000C0">,</font> <font color="#0080C0">23.6865</font><font color="#4000C0">)</font>
    <font color="#000000">v2zoom</font><font color="#4000C0">.</font><font color="#000000">viewUp</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0.700183</font><font color="#4000C0">,</font> <font color="#0080C0">0.02186</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">0.713629</font><font color="#4000C0">)</font>
    <font color="#000000">v2zoom</font><font color="#4000C0">.</font><font color="#000000">viewAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">30</font>
    <font color="#000000">v2zoom</font><font color="#4000C0">.</font><font color="#000000">parallelScale</font> <font color="#4000C0">=</font> <font color="#0080C0">29.1931</font>
    <font color="#000000">v2zoom</font><font color="#4000C0">.</font><font color="#000000">nearPlane</font> <font color="#4000C0">=</font> <font color="#4000C0">-</font><font color="#0080C0">58.3862</font>
    <font color="#000000">v2zoom</font><font color="#4000C0">.</font><font color="#000000">farPlane</font> <font color="#4000C0">=</font> <font color="#0080C0">58.3862</font>
    <font color="#000000">v2zoom</font><font color="#4000C0">.</font><font color="#000000">imagePan</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.0257104</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">0.00810227</font><font color="#4000C0">)</font>
    <font color="#000000">v2zoom</font><font color="#4000C0">.</font><font color="#000000">imageZoom</font> <font color="#4000C0">=</font> <font color="#0080C0">10.3892</font>
    <font color="#000000">v2zoom</font><font color="#4000C0">.</font><font color="#000000">perspective</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">v2zoom</font><font color="#4000C0">.</font><font color="#000000">eyeAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">2</font>
    <font color="#000000">v2zoom</font><font color="#4000C0">.</font><font color="#000000">centerOfRotationSet</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">v2zoom</font><font color="#4000C0">.</font><font color="#000000">centerOfRotation</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">23.441</font><font color="#4000C0">,</font> <font color="#0080C0">26.835</font><font color="#4000C0">,</font> <font color="#0080C0">23.6865</font><font color="#4000C0">)</font>

    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"proteindb_2_00"</font><font color="#4000C0">)</font>
    <font color="#000000">LabelTest</font><font color="#4000C0">(</font><font color="#008000">"proteindb_2_01"</font><font color="#4000C0">,</font> <font color="#008000">"elementname"</font><font color="#4000C0">,</font> <font color="#000000">v2zoom</font><font color="#4000C0">)</font>

    <font color="#000000">ChangeActivePlotsVar</font><font color="#4000C0">(</font><font color="#008000">"resseq"</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"proteindb_2_02"</font><font color="#4000C0">)</font>
    <font color="#000000">LabelTest</font><font color="#4000C0">(</font><font color="#008000">"proteindb_2_03"</font><font color="#4000C0">,</font> <font color="#008000">"resseq"</font><font color="#4000C0">,</font> <font color="#000000">v2zoom</font><font color="#4000C0">)</font>

    <font color="#000000">ChangeActivePlotsVar</font><font color="#4000C0">(</font><font color="#008000">"backbone"</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"proteindb_2_04"</font><font color="#4000C0">)</font>

    <font color="#000000">ChangeActivePlotsVar</font><font color="#4000C0">(</font><font color="#008000">"restype"</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"proteindb_2_05"</font><font color="#4000C0">)</font>
    <font color="#000000">LabelTest</font><font color="#4000C0">(</font><font color="#008000">"proteindb_2_06"</font><font color="#4000C0">,</font> <font color="#008000">"resname"</font><font color="#4000C0">,</font> <font color="#000000">v2zoom</font><font color="#4000C0">)</font>

    <font color="#000000">LabelTest</font><font color="#4000C0">(</font><font color="#008000">"proteindb_2_07"</font><font color="#4000C0">,</font> <font color="#008000">"longresname"</font><font color="#4000C0">,</font> <font color="#000000">v2zoom</font><font color="#4000C0">)</font>
    <font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>


<font color="#C00000">def</font> <font color="#000000">test3</font><font color="#4000C0">(</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#000000">TestSection</font><font color="#4000C0">(</font><font color="#008000">"Testing Black Mamba venom"</font><font color="#4000C0">)</font>
    <font color="#000000">AddMoleculePlot</font><font color="#4000C0">(</font><font color="#000000">data_path</font><font color="#4000C0">(</font><font color="#008000">"ProteinDataBank_test_data/1TFS.pdb"</font><font color="#4000C0">)</font><font color="#4000C0">,</font> <font color="#008000">"element"</font><font color="#4000C0">)</font>

    <font color="#000000">v3</font> <font color="#4000C0">=</font> <font color="#000000">View3DAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">viewNormal</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.242177</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">0.689536</font><font color="#4000C0">,</font> <font color="#0080C0">0.682562</font><font color="#4000C0">)</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">focus</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">1.73</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">1.927</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">0.202</font><font color="#4000C0">)</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">viewUp</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0.243612</font><font color="#4000C0">,</font> <font color="#0080C0">0.637752</font><font color="#4000C0">,</font> <font color="#0080C0">0.730702</font><font color="#4000C0">)</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">viewAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">30</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">parallelScale</font> <font color="#4000C0">=</font> <font color="#0080C0">25.6826</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">nearPlane</font> <font color="#4000C0">=</font> <font color="#4000C0">-</font><font color="#0080C0">51.3652</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">farPlane</font> <font color="#4000C0">=</font> <font color="#0080C0">51.3652</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">imagePan</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0.0337528</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">0.0400135</font><font color="#4000C0">)</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">imageZoom</font> <font color="#4000C0">=</font> <font color="#0080C0">1.49054</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">perspective</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">eyeAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">2</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">centerOfRotationSet</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">v3</font><font color="#4000C0">.</font><font color="#000000">centerOfRotation</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">1.73</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">1.927</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">0.202</font><font color="#4000C0">)</font>
    <font color="#000000">SetView3D</font><font color="#4000C0">(</font><font color="#000000">v3</font><font color="#4000C0">)</font>

    <font color="#000000">v3zoom</font> <font color="#4000C0">=</font> <font color="#000000">View3DAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">v3zoom</font><font color="#4000C0">.</font><font color="#000000">viewNormal</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.558032</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">0.716666</font><font color="#4000C0">,</font> <font color="#0080C0">0.418318</font><font color="#4000C0">)</font>
    <font color="#000000">v3zoom</font><font color="#4000C0">.</font><font color="#000000">focus</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">1.73</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">1.927</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">0.202</font><font color="#4000C0">)</font>
    <font color="#000000">v3zoom</font><font color="#4000C0">.</font><font color="#000000">viewUp</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0.120358</font><font color="#4000C0">,</font> <font color="#0080C0">0.428875</font><font color="#4000C0">,</font> <font color="#0080C0">0.89531</font><font color="#4000C0">)</font>
    <font color="#000000">v3zoom</font><font color="#4000C0">.</font><font color="#000000">viewAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">30</font>
    <font color="#000000">v3zoom</font><font color="#4000C0">.</font><font color="#000000">parallelScale</font> <font color="#4000C0">=</font> <font color="#0080C0">25.6826</font>
    <font color="#000000">v3zoom</font><font color="#4000C0">.</font><font color="#000000">nearPlane</font> <font color="#4000C0">=</font> <font color="#4000C0">-</font><font color="#0080C0">51.3652</font>
    <font color="#000000">v3zoom</font><font color="#4000C0">.</font><font color="#000000">farPlane</font> <font color="#4000C0">=</font> <font color="#0080C0">51.3652</font>
    <font color="#000000">v3zoom</font><font color="#4000C0">.</font><font color="#000000">imagePan</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0.0337528</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">0.0400135</font><font color="#4000C0">)</font>
    <font color="#000000">v3zoom</font><font color="#4000C0">.</font><font color="#000000">imageZoom</font> <font color="#4000C0">=</font> <font color="#0080C0">8.39928</font>
    <font color="#000000">v3zoom</font><font color="#4000C0">.</font><font color="#000000">perspective</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">v3zoom</font><font color="#4000C0">.</font><font color="#000000">eyeAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">2</font>
    <font color="#000000">v3zoom</font><font color="#4000C0">.</font><font color="#000000">centerOfRotationSet</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">v3zoom</font><font color="#4000C0">.</font><font color="#000000">centerOfRotation</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">1.73</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">1.927</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">0.202</font><font color="#4000C0">)</font>

    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"proteindb_3_00"</font><font color="#4000C0">)</font>
    <font color="#000000">LabelTest</font><font color="#4000C0">(</font><font color="#008000">"proteindb_3_01"</font><font color="#4000C0">,</font> <font color="#008000">"elementname"</font><font color="#4000C0">,</font> <font color="#000000">v3zoom</font><font color="#4000C0">)</font>

    <font color="#000000">ChangeActivePlotsVar</font><font color="#4000C0">(</font><font color="#008000">"resseq"</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"proteindb_3_02"</font><font color="#4000C0">)</font>
    <font color="#000000">LabelTest</font><font color="#4000C0">(</font><font color="#008000">"proteindb_3_03"</font><font color="#4000C0">,</font> <font color="#008000">"resseq"</font><font color="#4000C0">,</font> <font color="#000000">v3zoom</font><font color="#4000C0">)</font>

    <font color="#000000">ChangeActivePlotsVar</font><font color="#4000C0">(</font><font color="#008000">"backbone"</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"proteindb_3_04"</font><font color="#4000C0">)</font>

    <font color="#000000">ChangeActivePlotsVar</font><font color="#4000C0">(</font><font color="#008000">"restype"</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"proteindb_3_05"</font><font color="#4000C0">)</font>
    <font color="#000000">LabelTest</font><font color="#4000C0">(</font><font color="#008000">"proteindb_3_06"</font><font color="#4000C0">,</font> <font color="#008000">"resname"</font><font color="#4000C0">,</font> <font color="#000000">v3zoom</font><font color="#4000C0">)</font>

    <font color="#000000">LabelTest</font><font color="#4000C0">(</font><font color="#008000">"proteindb_3_07"</font><font color="#4000C0">,</font> <font color="#008000">"longresname"</font><font color="#4000C0">,</font> <font color="#000000">v3zoom</font><font color="#4000C0">)</font>

    <font color="#a02030"># Make sure that there are multiple models in the file.</font>
    <font color="#000000">ChangeActivePlotsVar</font><font color="#4000C0">(</font><font color="#008000">"element"</font><font color="#4000C0">)</font>
    <font color="#000000">ChangeActivePlotsVar</font><font color="#4000C0">(</font><font color="#008000">"models/model_09/element"</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"proteindb_3_08"</font><font color="#4000C0">)</font>
    <font color="#000000">ChangeActivePlotsVar</font><font color="#4000C0">(</font><font color="#008000">"models/model_19/element"</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"proteindb_3_09"</font><font color="#4000C0">)</font>
    <font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#a02030"># NOTE: This test is not enabled because it fails. It needs baselines too.</font>
<font color="#C00000">def</font> <font color="#000000">test4</font><font color="#4000C0">(</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#000000">TestSection</font><font color="#4000C0">(</font><font color="#008000">"Testing file replacement with ProteinDataBank files"</font><font color="#4000C0">)</font>
    <font color="#000000">AddMoleculePlot</font><font color="#4000C0">(</font><font color="#000000">data_path</font><font color="#4000C0">(</font><font color="#008000">"ProteinDataBank_test_data/crotamine.pdb"</font><font color="#4000C0">)</font><font color="#4000C0">,</font> <font color="#008000">"element"</font><font color="#4000C0">)</font>

    <font color="#000000">v0</font> <font color="#4000C0">=</font> <font color="#000000">View3DAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">v0</font><font color="#4000C0">.</font><font color="#000000">viewNormal</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.967329</font><font color="#4000C0">,</font> <font color="#0080C0">0.252251</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">0.0253765</font><font color="#4000C0">)</font>
    <font color="#000000">v0</font><font color="#4000C0">.</font><font color="#000000">focus</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">31.726</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">54.1675</font><font color="#4000C0">,</font> <font color="#0080C0">13.645</font><font color="#4000C0">)</font>
    <font color="#000000">v0</font><font color="#4000C0">.</font><font color="#000000">viewUp</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0.252129</font><font color="#4000C0">,</font> <font color="#0080C0">0.967661</font><font color="#4000C0">,</font> <font color="#0080C0">0.0079404</font><font color="#4000C0">)</font>
    <font color="#000000">v0</font><font color="#4000C0">.</font><font color="#000000">viewAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">30</font>
    <font color="#000000">v0</font><font color="#4000C0">.</font><font color="#000000">parallelScale</font> <font color="#4000C0">=</font> <font color="#0080C0">24.9831</font>
    <font color="#000000">v0</font><font color="#4000C0">.</font><font color="#000000">nearPlane</font> <font color="#4000C0">=</font> <font color="#4000C0">-</font><font color="#0080C0">49.9661</font>
    <font color="#000000">v0</font><font color="#4000C0">.</font><font color="#000000">farPlane</font> <font color="#4000C0">=</font> <font color="#0080C0">49.9661</font>
    <font color="#000000">v0</font><font color="#4000C0">.</font><font color="#000000">imagePan</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">)</font>
    <font color="#000000">v0</font><font color="#4000C0">.</font><font color="#000000">imageZoom</font> <font color="#4000C0">=</font> <font color="#0080C0">1.44471</font>
    <font color="#000000">v0</font><font color="#4000C0">.</font><font color="#000000">perspective</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">v0</font><font color="#4000C0">.</font><font color="#000000">eyeAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">2</font>
    <font color="#000000">v0</font><font color="#4000C0">.</font><font color="#000000">centerOfRotationSet</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">v0</font><font color="#4000C0">.</font><font color="#000000">centerOfRotation</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">31.726</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">54.1675</font><font color="#4000C0">,</font> <font color="#0080C0">13.645</font><font color="#4000C0">)</font>
    <font color="#000000">SetView3D</font><font color="#4000C0">(</font><font color="#000000">v0</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"proteindb_4_00"</font><font color="#4000C0">)</font>
    <font color="#000000">ReplaceDatabase</font><font color="#4000C0">(</font><font color="#000000">data_path</font><font color="#4000C0">(</font><font color="#008000">"ProteinDataBank_test_data/1UZ9.pdb"</font><font color="#4000C0">)</font><font color="#4000C0">)</font>

    <font color="#000000">v1</font> <font color="#4000C0">=</font> <font color="#000000">View3DAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">v1</font><font color="#4000C0">.</font><font color="#000000">viewNormal</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.320353</font><font color="#4000C0">,</font> <font color="#0080C0">0.944248</font><font color="#4000C0">,</font> <font color="#0080C0">0.075961</font><font color="#4000C0">)</font>
    <font color="#000000">v1</font><font color="#4000C0">.</font><font color="#000000">focus</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.0580001</font><font color="#4000C0">,</font> <font color="#0080C0">0.0915003</font><font color="#4000C0">,</font> <font color="#0080C0">0.3815</font><font color="#4000C0">)</font>
    <font color="#000000">v1</font><font color="#4000C0">.</font><font color="#000000">viewUp</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0.342959</font><font color="#4000C0">,</font> <font color="#0080C0">0.190354</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">0.919861</font><font color="#4000C0">)</font>
    <font color="#000000">v1</font><font color="#4000C0">.</font><font color="#000000">viewAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">30</font>
    <font color="#000000">v1</font><font color="#4000C0">.</font><font color="#000000">parallelScale</font> <font color="#4000C0">=</font> <font color="#0080C0">22.575</font>
    <font color="#000000">v1</font><font color="#4000C0">.</font><font color="#000000">nearPlane</font> <font color="#4000C0">=</font> <font color="#4000C0">-</font><font color="#0080C0">45.1501</font>
    <font color="#000000">v1</font><font color="#4000C0">.</font><font color="#000000">farPlane</font> <font color="#4000C0">=</font> <font color="#0080C0">45.1501</font>
    <font color="#000000">v1</font><font color="#4000C0">.</font><font color="#000000">imagePan</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.0021177</font><font color="#4000C0">,</font> <font color="#4000C0">-</font><font color="#0080C0">0.0481532</font><font color="#4000C0">)</font>
    <font color="#000000">v1</font><font color="#4000C0">.</font><font color="#000000">imageZoom</font> <font color="#4000C0">=</font> <font color="#0080C0">1.27797</font>
    <font color="#000000">v1</font><font color="#4000C0">.</font><font color="#000000">perspective</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
    <font color="#000000">v1</font><font color="#4000C0">.</font><font color="#000000">eyeAngle</font> <font color="#4000C0">=</font> <font color="#0080C0">2</font>
    <font color="#000000">v1</font><font color="#4000C0">.</font><font color="#000000">centerOfRotationSet</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">v1</font><font color="#4000C0">.</font><font color="#000000">centerOfRotation</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#4000C0">-</font><font color="#0080C0">0.0580001</font><font color="#4000C0">,</font> <font color="#0080C0">0.0915003</font><font color="#4000C0">,</font> <font color="#0080C0">0.3815</font><font color="#4000C0">)</font>
    <font color="#000000">SetView3D</font><font color="#4000C0">(</font><font color="#000000">v1</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">"proteindb_4_01"</font><font color="#4000C0">)</font>


<font color="#C00000">def</font> <font color="#000000">main</font><font color="#4000C0">(</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#a02030"># Set the window background color</font>
    <font color="#000000">a</font> <font color="#4000C0">=</font> <font color="#000000">GetAnnotationAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">backgroundMode</font> <font color="#4000C0">=</font> <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">Solid</font>
    <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">foregroundColor</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">0</font><font color="#4000C0">,</font> <font color="#0080C0">255</font><font color="#4000C0">)</font>
    <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">backgroundColor</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">255</font><font color="#4000C0">,</font> <font color="#0080C0">255</font><font color="#4000C0">,</font> <font color="#0080C0">255</font><font color="#4000C0">,</font> <font color="#0080C0">255</font><font color="#4000C0">)</font>
    <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">databaseInfoFlag</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
    <font color="#000000">SetAnnotationAttributes</font><font color="#4000C0">(</font><font color="#000000">a</font><font color="#4000C0">)</font>

    <font color="#a02030"># Call the tests</font>
    <font color="#000000">test0</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">test1</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">test2</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">test3</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#a02030">#test4()</font>

<font color="#000000">main</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Exit</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000"></font></font></pre></body></html>