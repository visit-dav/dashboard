<html><body bgcolor="#e0e0e0"><head><title>hybrid/movie.py</title></head><pre><font face="Lucida,Courier New"><font color="#a02030"># ----------------------------------------------------------------------------</font>
<font color="#a02030">#  CLASSES: nightly</font>
<font color="#a02030">#</font>
<font color="#a02030">#  Test Case:  movie.py</font>
<font color="#a02030">#</font>
<font color="#a02030">#  Tests:      Tests various aspects of "visit -movie" movie-making.</font>
<font color="#a02030">#</font>
<font color="#a02030">#  Notes:      </font>
<font color="#a02030">#</font>
<font color="#a02030">#  Programmer: Brad Whitlock</font>
<font color="#a02030">#  Date:       Fri Sep 18 17:29:49 PDT 2015</font>
<font color="#a02030">#</font>
<font color="#a02030">#  Modifications:</font>
<font color="#a02030">#     Kathleen Biagas, Tue Sep 29 15:47:21 MST 2015</font>
<font color="#a02030">#     Use TestEnv.params["visit_bin"] for correct path to visit executable</font>
<font color="#a02030">#     on all platforms.  Use raw string for database path when writing to</font>
<font color="#a02030">#     fb_wave.py.</font>
<font color="#a02030">#</font>
<font color="#a02030">#     Kathleen Biagas, Mon Oct 23 17:41:43 MST 2017</font>
<font color="#a02030">#     Use Image lib for image conversion instead of 'convert'.</font>
<font color="#a02030">#</font>
<font color="#a02030">#     Kathleen Biagas, Tue Sep 14 09:51:45 PDT 2021</font>
<font color="#a02030">#     Added call to CloseComputeEngine to GenerateMovie method, since the</font>
<font color="#a02030">#     movie script launches its own. Prevents a hang when run in parallel.</font>
<font color="#a02030">#</font>
<font color="#a02030">#     Kathleen Biagas, Tue Sep 21 17:22:58 PDT 2021</font>
<font color="#a02030">#     Removed CloseComputeEngine, it prevented the non-movie-generation parts</font>
<font color="#a02030">#     of the test from running in parallel.  If the nightlies use srun,</font>
<font color="#a02030">#     add "--overlap" srun option.  This allows cinema test to succeed in</font>
<font color="#a02030">#     parallel with recent changes to slurm.</font>
<font color="#a02030">#</font>
<font color="#a02030"># ----------------------------------------------------------------------------</font>
<font color="#C00000">import</font> <font color="#000000">os</font>
<font color="#C00000">import</font> <font color="#000000">subprocess</font>
<font color="#C00000">import</font> <font color="#000000">visit_utils</font>
<font color="#C00000">from</font> <font color="#000000">PIL</font> <font color="#C00000">import</font> <font color="#000000">Image</font>

<font color="#C00000">def</font> <font color="#000000">GenerateMovie</font><font color="#4000C0">(</font><font color="#000000">movieArgs</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#000000">args</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#000000">TestEnv</font><font color="#4000C0">.</font><font color="#000000">params</font><font color="#4000C0">[</font><font color="#008000">"visit_bin"</font><font color="#4000C0">]</font><font color="#4000C0">,</font> <font color="#008000">"-noconfig"</font><font color="#4000C0">,</font> <font color="#008000">"-movie"</font><font color="#4000C0">]</font> <font color="#4000C0">+</font> <font color="#000000">movieArgs</font>
    <font color="#C00000">if</font> <font color="#000000">TestEnv</font><font color="#4000C0">.</font><font color="#000000">params</font><font color="#4000C0">[</font><font color="#008000">"parallel"</font><font color="#4000C0">]</font><font color="#4000C0">:</font>
        <font color="#000000">args</font> <font color="#4000C0">=</font> <font color="#000000">args</font> <font color="#4000C0">+</font> <font color="#4000C0">[</font><font color="#008000">"-np"</font><font color="#4000C0">,</font> <font color="#008000">"2"</font><font color="#4000C0">,</font> <font color="#008000">"-l"</font><font color="#4000C0">,</font> <font color="#000000">TestEnv</font><font color="#4000C0">.</font><font color="#000000">params</font><font color="#4000C0">[</font><font color="#008000">"parallel_launch"</font><font color="#4000C0">]</font><font color="#4000C0">]</font>
        <font color="#C00000">if</font> <font color="#000000">TestEnv</font><font color="#4000C0">.</font><font color="#000000">params</font><font color="#4000C0">[</font><font color="#008000">"parallel_launch"</font><font color="#4000C0">]</font> <font color="#4000C0">==</font> <font color="#008000">"srun"</font><font color="#4000C0">:</font>
            <font color="#000000">args</font> <font color="#4000C0">=</font> <font color="#000000">args</font> <font color="#4000C0">+</font> <font color="#4000C0">[</font><font color="#008000">"-la"</font><font color="#4000C0">,</font> <font color="#008000">"--overlap"</font><font color="#4000C0">]</font>
    <font color="#000000">p</font> <font color="#4000C0">=</font> <font color="#000000">subprocess</font><font color="#4000C0">.</font><font color="#000000">check_output</font><font color="#4000C0">(</font><font color="#000000">args</font><font color="#4000C0">)</font>
    <font color="#C00000">return</font> <font color="#000000">p</font>

<font color="#C00000">def</font> <font color="#000000">GetFiles</font><font color="#4000C0">(</font><font color="#000000">prefix</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#000000">files</font> <font color="#4000C0">=</font> <font color="#000000">os</font><font color="#4000C0">.</font><font color="#000000">listdir</font><font color="#4000C0">(</font><font color="#008000">"."</font><font color="#4000C0">)</font>
    <font color="#000000">names</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#4000C0">]</font>
    <font color="#C00000">for</font> <font color="#000000">f</font> <font color="#C00000">in</font> <font color="#000000">files</font><font color="#4000C0">:</font>
        <font color="#C00000">if</font> <font color="#000000">prefix</font> <font color="#C00000">in</font> <font color="#000000">f</font><font color="#4000C0">:</font>
            <font color="#000000">names</font> <font color="#4000C0">=</font> <font color="#000000">names</font> <font color="#4000C0">+</font> <font color="#4000C0">[</font><font color="#000000">f</font><font color="#4000C0">]</font>
    <font color="#000000">names</font> <font color="#4000C0">=</font> <font color="#000000">sorted</font><font color="#4000C0">(</font><font color="#000000">names</font><font color="#4000C0">)</font>
    <font color="#000000">sizes</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#4000C0">]</font>
    <font color="#C00000">for</font> <font color="#000000">f</font> <font color="#C00000">in</font> <font color="#000000">names</font><font color="#4000C0">:</font>
        <font color="#000000">s</font> <font color="#4000C0">=</font> <font color="#000000">os</font><font color="#4000C0">.</font><font color="#000000">stat</font><font color="#4000C0">(</font><font color="#000000">f</font><font color="#4000C0">)</font>
        <font color="#000000">sizes</font> <font color="#4000C0">=</font> <font color="#000000">sizes</font> <font color="#4000C0">+</font> <font color="#4000C0">[</font><font color="#000000">s</font><font color="#4000C0">.</font><font color="#000000">st_size</font><font color="#4000C0">]</font>
    <font color="#C00000">return</font> <font color="#000000">list</font><font color="#4000C0">(</font><font color="#000000">zip</font><font color="#4000C0">(</font><font color="#000000">names</font><font color="#4000C0">,</font> <font color="#000000">sizes</font><font color="#4000C0">)</font><font color="#4000C0">)</font>

<font color="#C00000">def</font> <font color="#000000">RemoveFiles</font><font color="#4000C0">(</font><font color="#000000">files</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#C00000">for</font> <font color="#000000">f</font> <font color="#C00000">in</font> <font color="#000000">files</font><font color="#4000C0">:</font>
        <font color="#000000">os</font><font color="#4000C0">.</font><font color="#000000">unlink</font><font color="#4000C0">(</font><font color="#000000">f</font><font color="#4000C0">)</font>

<font color="#C00000">def</font> <font color="#000000">TestMovieFrames</font><font color="#4000C0">(</font><font color="#000000">testFormatString</font><font color="#4000C0">,</font> <font color="#000000">startindex</font><font color="#4000C0">,</font> <font color="#000000">framefiles</font><font color="#4000C0">,</font> <font color="#000000">percents</font><font color="#4000C0">=</font><font color="#4000C0">[</font><font color="#4000C0">]</font><font color="#4000C0">,</font> <font color="#000000">label</font><font color="#4000C0">=</font><font color="#008000">""</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#000000">files</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#4000C0">]</font>
    <font color="#C00000">if</font> <font color="#000000">len</font><font color="#4000C0">(</font><font color="#000000">percents</font><font color="#4000C0">)</font> <font color="#4000C0">&gt;</font> <font color="#0080C0">0</font><font color="#4000C0">:</font>
        <font color="#C00000">for</font> <font color="#000000">p</font> <font color="#C00000">in</font> <font color="#000000">percents</font><font color="#4000C0">:</font>
            <font color="#000000">idx</font> <font color="#4000C0">=</font> <font color="#000000">int</font><font color="#4000C0">(</font><font color="#000000">p</font><font color="#4000C0">*</font><font color="#000000">float</font><font color="#4000C0">(</font><font color="#000000">len</font><font color="#4000C0">(</font><font color="#000000">framefiles</font><font color="#4000C0">)</font><font color="#4000C0">-</font><font color="#0080C0">1</font><font color="#4000C0">)</font><font color="#4000C0">)</font>
            <font color="#000000">files</font> <font color="#4000C0">=</font> <font color="#000000">files</font> <font color="#4000C0">+</font> <font color="#4000C0">[</font><font color="#000000">framefiles</font><font color="#4000C0">[</font><font color="#000000">idx</font><font color="#4000C0">]</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font><font color="#4000C0">]</font>
    <font color="#C00000">else</font><font color="#4000C0">:</font>
        <font color="#000000">files</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#000000">x</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font> <font color="#C00000">for</font> <font color="#000000">x</font> <font color="#C00000">in</font> <font color="#000000">framefiles</font><font color="#4000C0">]</font>
    <font color="#C00000">if</font> <font color="#000000">len</font><font color="#4000C0">(</font><font color="#000000">label</font><font color="#4000C0">)</font> <font color="#4000C0">&gt;</font> <font color="#0080C0">0</font><font color="#4000C0">:</font>
        <font color="#000000">annot</font> <font color="#4000C0">=</font> <font color="#000000">CreateAnnotationObject</font><font color="#4000C0">(</font><font color="#008000">"Text2D"</font><font color="#4000C0">)</font>
        <font color="#000000">annot</font><font color="#4000C0">.</font><font color="#000000">position</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0.02</font><font color="#4000C0">,</font><font color="#0080C0">0.92</font><font color="#4000C0">)</font>
        <font color="#000000">annot</font><font color="#4000C0">.</font><font color="#000000">height</font> <font color="#4000C0">=</font> <font color="#0080C0">0.06</font>
        <font color="#000000">annot</font><font color="#4000C0">.</font><font color="#000000">text</font> <font color="#4000C0">=</font> <font color="#000000">label</font>
    <font color="#000000">testid</font> <font color="#4000C0">=</font> <font color="#000000">startindex</font>
    <font color="#C00000">for</font> <font color="#000000">f</font> <font color="#C00000">in</font> <font color="#000000">files</font><font color="#4000C0">:</font>
        <font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">f</font><font color="#4000C0">)</font>
        <font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">"Truecolor"</font><font color="#4000C0">,</font> <font color="#008000">"color"</font><font color="#4000C0">)</font>
        <font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
        <font color="#000000">ResetView</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
        <font color="#000000">v</font> <font color="#4000C0">=</font> <font color="#000000">GetView2D</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
        <font color="#000000">v</font><font color="#4000C0">.</font><font color="#000000">viewportCoords</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font><font color="#0080C0">1</font><font color="#4000C0">,</font><font color="#0080C0">0</font><font color="#4000C0">,</font><font color="#0080C0">1</font><font color="#4000C0">)</font>
        <font color="#000000">SetView2D</font><font color="#4000C0">(</font><font color="#000000">v</font><font color="#4000C0">)</font>
        <font color="#000000">testname</font> <font color="#4000C0">=</font> <font color="#000000">testFormatString</font> <font color="#4000C0">%</font> <font color="#000000">testid</font>
        <font color="#000000">testid</font> <font color="#4000C0">=</font> <font color="#000000">testid</font> <font color="#4000C0">+</font> <font color="#0080C0">1</font>
        <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#000000">testname</font><font color="#4000C0">)</font>
        <font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
        <font color="#000000">CloseDatabase</font><font color="#4000C0">(</font><font color="#000000">f</font><font color="#4000C0">)</font>
    <font color="#C00000">if</font> <font color="#000000">len</font><font color="#4000C0">(</font><font color="#000000">label</font><font color="#4000C0">)</font> <font color="#4000C0">&gt;</font> <font color="#0080C0">0</font><font color="#4000C0">:</font>
        <font color="#000000">annotations</font> <font color="#4000C0">=</font> <font color="#000000">GetAnnotationObjectNames</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
        <font color="#C00000">for</font> <font color="#000000">a</font> <font color="#C00000">in</font> <font color="#000000">annotations</font><font color="#4000C0">:</font>
            <font color="#C00000">if</font> <font color="#000000">a</font><font color="#4000C0">.</font><font color="#000000">startswith</font><font color="#4000C0">(</font><font color="#008000">"Text2D"</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
                <font color="#000000">GetAnnotationObject</font><font color="#4000C0">(</font><font color="#000000">a</font><font color="#4000C0">)</font><font color="#4000C0">.</font><font color="#000000">Delete</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
                <font color="#C00000">break</font>
    <font color="#C00000">return</font> <font color="#000000">testid</font>

<font color="#C00000">def</font> <font color="#000000">FileSubstitution</font><font color="#4000C0">(</font><font color="#000000">infile</font><font color="#4000C0">,</font> <font color="#000000">outfile</font><font color="#4000C0">,</font> <font color="#000000">replacements</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#000000">lines</font> <font color="#4000C0">=</font> <font color="#000000">open</font><font color="#4000C0">(</font><font color="#000000">infile</font><font color="#4000C0">,</font> <font color="#008000">"rt"</font><font color="#4000C0">)</font><font color="#4000C0">.</font><font color="#000000">readlines</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">out</font> <font color="#4000C0">=</font> <font color="#000000">open</font><font color="#4000C0">(</font><font color="#000000">outfile</font><font color="#4000C0">,</font> <font color="#008000">"wt"</font><font color="#4000C0">)</font>
    <font color="#C00000">for</font> <font color="#000000">line</font> <font color="#C00000">in</font> <font color="#000000">lines</font><font color="#4000C0">:</font>
        <font color="#000000">s</font> <font color="#4000C0">=</font> <font color="#000000">line</font>
        <font color="#C00000">for</font> <font color="#000000">token</font> <font color="#C00000">in</font> <font color="#000000">replacements</font><font color="#4000C0">:</font>
            <font color="#C00000">if</font> <font color="#000000">token</font> <font color="#C00000">in</font> <font color="#000000">line</font><font color="#4000C0">:</font>
                <font color="#000000">s</font> <font color="#4000C0">=</font> <font color="#000000">s</font><font color="#4000C0">.</font><font color="#000000">replace</font><font color="#4000C0">(</font><font color="#000000">token</font><font color="#4000C0">,</font> <font color="#000000">replacements</font><font color="#4000C0">[</font><font color="#000000">token</font><font color="#4000C0">]</font><font color="#4000C0">)</font>
        <font color="#000000">out</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#000000">s</font><font color="#4000C0">)</font>
    <font color="#000000">out</font><font color="#4000C0">.</font><font color="#000000">close</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#C00000">def</font> <font color="#000000">test012</font><font color="#4000C0">(</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#a02030"># Set up a movie script.</font>
    <font color="#000000">f</font> <font color="#4000C0">=</font> <font color="#000000">open</font><font color="#4000C0">(</font><font color="#008000">"fb_wave.py"</font><font color="#4000C0">,</font> <font color="#008000">"wt"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"print (\"MOVIE SCRIPT EXECUTING\")\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"OpenDatabase(r\"%s\")\n"</font> <font color="#4000C0">%</font> <font color="#000000">silo_data_path</font><font color="#4000C0">(</font><font color="#008000">"wave*.silo database"</font><font color="#4000C0">)</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"AddPlot(\"FilledBoundary\", \"Material\")\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"DrawPlots()\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"v = GetView3D()\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"v.viewNormal = (-0.6041, 0.689904, 0.398868)\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"v.focus = (5, 0.753448, 2.5)\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"v.viewUp = (0.601718, 0.723053, -0.339309)\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"v.viewAngle = 30\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"v.parallelScale = 5.6398\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"v.nearPlane = -11.2796\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"v.farPlane = 11.2796\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"v.imagePan = (0.0453988, 0.0661949)\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"v.imageZoom = 1.09294\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"v.perspective = 1\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"v.eyeAngle = 2\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"v.centerOfRotationSet = 0\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"v.centerOfRotation = (5, 0.753448, 2.5)\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"v.axis3DScaleFlag = 0\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"v.axis3DScales = (1, 1, 1)\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"v.shear = (0, 0, 1)\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"v.windowValid = 1\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"SetView3D(v)\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"a = GetAnnotationAttributes()\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"a.axes2D.visible = 0\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"a.axes3D.visible = 0\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"a.axes3D.triadFlag = 0\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"a.axes3D.bboxFlag = 0\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"a.userInfoFlag = 0\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"a.databaseInfoFlag = 0\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"a.legendInfoFlag = 0\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"SetAnnotationAttributes(a)\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"f = FilledBoundaryAttributes(1)\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"f.SetMultiColor(0, (255,100,100,255))\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"f.SetMultiColor(1, (255,255,100,255))\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"f.SetMultiColor(2, (100,255,180,255))\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"SetPlotOptions(f)\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"ts = CreateAnnotationObject(\"TimeSlider\")\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"ts.height = 0.15\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"ts.width = 0.98\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"ts.startColor = (255,140,80,250)\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"ts.rounded = 0\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"for i in range(TimeSliderGetNStates()):\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"    SetTimeSliderState(i)\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"    SaveWindow()\n"</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">close</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

    <font color="#000000">WH</font> <font color="#4000C0">=</font> <font color="#008000">"%dx%d"</font> <font color="#4000C0">%</font> <font color="#4000C0">(</font><font color="#000000">TestEnv</font><font color="#4000C0">.</font><font color="#000000">params</font><font color="#4000C0">[</font><font color="#008000">"width"</font><font color="#4000C0">]</font><font color="#4000C0">,</font> <font color="#000000">TestEnv</font><font color="#4000C0">.</font><font color="#000000">params</font><font color="#4000C0">[</font><font color="#008000">"height"</font><font color="#4000C0">]</font><font color="#4000C0">)</font>

    <font color="#a02030">############################################################################</font>
    <font color="#a02030"># Regular movie. 1 format. Force mpeg2encode.</font>
    <font color="#a02030">############################################################################</font>
    <font color="#C00000">def</font> <font color="#000000">test0</font><font color="#4000C0">(</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
        <font color="#000000">TestSection</font><font color="#4000C0">(</font><font color="#008000">"Script, Save MPEG"</font><font color="#4000C0">)</font>
        <font color="#000000">output</font> <font color="#4000C0">=</font> <font color="#000000">GenerateMovie</font><font color="#4000C0">(</font><font color="#4000C0">[</font><font color="#008000">"-scriptfile"</font><font color="#4000C0">,</font> <font color="#008000">"fb_wave.py"</font><font color="#4000C0">,</font> <font color="#008000">"-output"</font><font color="#4000C0">,</font> <font color="#008000">"test_0"</font><font color="#4000C0">,</font> <font color="#008000">"-noffmpeg"</font><font color="#4000C0">,</font> <font color="#008000">"-format"</font><font color="#4000C0">,</font> <font color="#008000">"mpeg"</font><font color="#4000C0">,</font> <font color="#008000">"-geometry"</font><font color="#4000C0">,</font> <font color="#000000">WH</font><font color="#4000C0">]</font><font color="#4000C0">)</font>

        <font color="#a02030"># Look at the mpeg movie file size.</font>
        <font color="#000000">files</font> <font color="#4000C0">=</font> <font color="#000000">GetFiles</font><font color="#4000C0">(</font><font color="#008000">"test_0"</font><font color="#4000C0">)</font>
        <font color="#000000">print</font><font color="#4000C0">(</font><font color="#000000">files</font><font color="#4000C0">)</font>
        <font color="#000000">txt</font> <font color="#4000C0">=</font> <font color="#008000">""</font>
        <font color="#C00000">for</font> <font color="#000000">f</font> <font color="#C00000">in</font> <font color="#000000">files</font><font color="#4000C0">:</font>
            <font color="#C00000">if</font> <font color="#000000">f</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font> <font color="#4000C0">==</font> <font color="#008000">"test_0.mpg"</font><font color="#4000C0">:</font>
                <font color="#C00000">if</font> <font color="#000000">f</font><font color="#4000C0">[</font><font color="#0080C0">1</font><font color="#4000C0">]</font> <font color="#4000C0">&gt;</font> <font color="#0080C0">1100000</font><font color="#4000C0">:</font>
                    <font color="#000000">txt</font> <font color="#4000C0">=</font> <font color="#000000">txt</font> <font color="#4000C0">+</font> <font color="#008000">"MPEG movie file size is plausible."</font>
                <font color="#C00000">else</font><font color="#4000C0">:</font>
                    <font color="#000000">txt</font> <font color="#4000C0">=</font> <font color="#000000">txt</font> <font color="#4000C0">+</font> <font color="#008000">"MPEG movie file size is suspect."</font>
                <font color="#C00000">break</font>
        <font color="#000000">TestText</font><font color="#4000C0">(</font><font color="#008000">"movie_0_00"</font><font color="#4000C0">,</font> <font color="#000000">txt</font><font color="#4000C0">)</font>

        <font color="#a02030"># extract movie and let's plot some frames.</font>
        <font color="#000000">visit_utils</font><font color="#4000C0">.</font><font color="#000000">encoding</font><font color="#4000C0">.</font><font color="#000000">extract</font><font color="#4000C0">(</font><font color="#008000">"test_0.mpg"</font><font color="#4000C0">,</font> <font color="#008000">"frame%04d.png"</font><font color="#4000C0">)</font>
        <font color="#000000">framefiles</font> <font color="#4000C0">=</font> <font color="#000000">GetFiles</font><font color="#4000C0">(</font><font color="#008000">"frame"</font><font color="#4000C0">)</font>
        <font color="#000000">txt</font> <font color="#4000C0">=</font> <font color="#008000">"\n"</font><font color="#4000C0">.</font><font color="#000000">join</font><font color="#4000C0">(</font><font color="#4000C0">[</font><font color="#000000">x</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font> <font color="#C00000">for</font> <font color="#000000">x</font> <font color="#C00000">in</font> <font color="#000000">framefiles</font><font color="#4000C0">]</font><font color="#4000C0">)</font>
        <font color="#000000">TestText</font><font color="#4000C0">(</font><font color="#008000">"movie_0_01"</font><font color="#4000C0">,</font> <font color="#000000">txt</font><font color="#4000C0">)</font>

        <font color="#a02030"># Plot some of the extracted frames</font>
        <font color="#000000">nextid</font> <font color="#4000C0">=</font> <font color="#000000">TestMovieFrames</font><font color="#4000C0">(</font><font color="#008000">"movie_0_%02d"</font><font color="#4000C0">,</font> <font color="#0080C0">2</font><font color="#4000C0">,</font> <font color="#000000">framefiles</font><font color="#4000C0">,</font> <font color="#000000">percents</font><font color="#4000C0">=</font><font color="#4000C0">[</font><font color="#0080C0">0.</font><font color="#4000C0">,</font> <font color="#0080C0">0.25</font><font color="#4000C0">,</font> <font color="#0080C0">0.5</font><font color="#4000C0">,</font> <font color="#0080C0">0.75</font><font color="#4000C0">,</font> <font color="#0080C0">1.</font><font color="#4000C0">]</font><font color="#4000C0">,</font> <font color="#000000">label</font><font color="#4000C0">=</font><font color="#008000">"MPEG"</font><font color="#4000C0">)</font>
        <font color="#000000">RemoveFiles</font><font color="#4000C0">(</font><font color="#4000C0">[</font><font color="#000000">x</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font> <font color="#C00000">for</font> <font color="#000000">x</font> <font color="#C00000">in</font> <font color="#000000">framefiles</font><font color="#4000C0">]</font><font color="#4000C0">)</font>

    <font color="#a02030">############################################################################</font>
    <font color="#a02030"># Regular movie with 2 formats</font>
    <font color="#a02030">############################################################################</font>
    <font color="#C00000">def</font> <font color="#000000">test1</font><font color="#4000C0">(</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
        <font color="#000000">TestSection</font><font color="#4000C0">(</font><font color="#008000">"Script, Save 2 formats (PNG,MPEG)"</font><font color="#4000C0">)</font>
        <font color="#000000">output</font> <font color="#4000C0">=</font> <font color="#000000">GenerateMovie</font><font color="#4000C0">(</font><font color="#4000C0">[</font><font color="#008000">"-scriptfile"</font><font color="#4000C0">,</font> <font color="#008000">"fb_wave.py"</font><font color="#4000C0">,</font> <font color="#008000">"-output"</font><font color="#4000C0">,</font> <font color="#008000">"test_1"</font><font color="#4000C0">,</font> <font color="#008000">"-format"</font><font color="#4000C0">,</font> <font color="#008000">"png,mpeg"</font><font color="#4000C0">,</font> <font color="#008000">"-geometry"</font><font color="#4000C0">,</font> <font color="#000000">WH</font><font color="#4000C0">+</font><font color="#008000">",800x600"</font><font color="#4000C0">]</font><font color="#4000C0">)</font>

        <font color="#a02030"># Look at the mpeg movie file size.</font>
        <font color="#000000">files</font> <font color="#4000C0">=</font> <font color="#000000">GetFiles</font><font color="#4000C0">(</font><font color="#008000">"test_1"</font><font color="#4000C0">)</font>
        <font color="#000000">txt</font> <font color="#4000C0">=</font> <font color="#008000">"\n"</font><font color="#4000C0">.</font><font color="#000000">join</font><font color="#4000C0">(</font><font color="#4000C0">[</font><font color="#000000">x</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font> <font color="#C00000">for</font> <font color="#000000">x</font> <font color="#C00000">in</font> <font color="#000000">files</font><font color="#4000C0">]</font><font color="#4000C0">)</font> <font color="#4000C0">+</font> <font color="#008000">"\n\n"</font>
        <font color="#C00000">for</font> <font color="#000000">f</font> <font color="#C00000">in</font> <font color="#000000">files</font><font color="#4000C0">:</font>
            <font color="#C00000">if</font> <font color="#000000">f</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font> <font color="#4000C0">==</font> <font color="#008000">"test_1.mpg"</font><font color="#4000C0">:</font>
                <font color="#C00000">if</font> <font color="#000000">f</font><font color="#4000C0">[</font><font color="#0080C0">1</font><font color="#4000C0">]</font> <font color="#4000C0">&gt;</font> <font color="#0080C0">1400000</font><font color="#4000C0">:</font>
                    <font color="#000000">txt</font> <font color="#4000C0">=</font> <font color="#000000">txt</font> <font color="#4000C0">+</font> <font color="#008000">"MPEG movie file size is plausible."</font>
                <font color="#C00000">else</font><font color="#4000C0">:</font>
                    <font color="#000000">txt</font> <font color="#4000C0">=</font> <font color="#000000">txt</font> <font color="#4000C0">+</font> <font color="#008000">"MPEG movie file size is suspect."</font>
                <font color="#C00000">break</font>
        <font color="#000000">TestText</font><font color="#4000C0">(</font><font color="#008000">"movie_1_00"</font><font color="#4000C0">,</font> <font color="#000000">txt</font><font color="#4000C0">)</font>

        <font color="#a02030"># extract movie and let's plot some frames.</font>
        <font color="#000000">visit_utils</font><font color="#4000C0">.</font><font color="#000000">encoding</font><font color="#4000C0">.</font><font color="#000000">extract</font><font color="#4000C0">(</font><font color="#008000">"test_1.mpg"</font><font color="#4000C0">,</font> <font color="#008000">"frame%04d.png"</font><font color="#4000C0">)</font>
        <font color="#000000">framefiles</font> <font color="#4000C0">=</font> <font color="#000000">GetFiles</font><font color="#4000C0">(</font><font color="#008000">"frame"</font><font color="#4000C0">)</font>
        <font color="#000000">txt</font> <font color="#4000C0">=</font> <font color="#008000">"\n"</font><font color="#4000C0">.</font><font color="#000000">join</font><font color="#4000C0">(</font><font color="#4000C0">[</font><font color="#000000">x</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font> <font color="#C00000">for</font> <font color="#000000">x</font> <font color="#C00000">in</font> <font color="#000000">framefiles</font><font color="#4000C0">]</font><font color="#4000C0">)</font>
        <font color="#000000">TestText</font><font color="#4000C0">(</font><font color="#008000">"movie_1_01"</font><font color="#4000C0">,</font> <font color="#000000">txt</font><font color="#4000C0">)</font>

        <font color="#a02030"># Plot some of the png files we made.</font>
        <font color="#000000">pngs</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#4000C0">]</font>
        <font color="#C00000">for</font> <font color="#000000">f</font> <font color="#C00000">in</font> <font color="#000000">files</font><font color="#4000C0">:</font>
            <font color="#C00000">if</font> <font color="#000000">f</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font><font color="#4000C0">[</font><font color="#4000C0">-</font><font color="#0080C0">4</font><font color="#4000C0">:</font><font color="#4000C0">]</font> <font color="#4000C0">==</font> <font color="#008000">".png"</font><font color="#4000C0">:</font>
                <font color="#000000">pngs</font> <font color="#4000C0">=</font> <font color="#000000">pngs</font> <font color="#4000C0">+</font> <font color="#4000C0">[</font><font color="#000000">f</font><font color="#4000C0">]</font>
        <font color="#000000">nextid</font> <font color="#4000C0">=</font> <font color="#000000">TestMovieFrames</font><font color="#4000C0">(</font><font color="#008000">"movie_1_%02d"</font><font color="#4000C0">,</font> <font color="#0080C0">2</font><font color="#4000C0">,</font> <font color="#000000">pngs</font><font color="#4000C0">,</font> <font color="#000000">percents</font><font color="#4000C0">=</font><font color="#4000C0">[</font><font color="#0080C0">0.</font><font color="#4000C0">,</font> <font color="#0080C0">0.25</font><font color="#4000C0">,</font> <font color="#0080C0">0.5</font><font color="#4000C0">,</font> <font color="#0080C0">0.75</font><font color="#4000C0">,</font> <font color="#0080C0">1.</font><font color="#4000C0">]</font><font color="#4000C0">,</font> <font color="#000000">label</font><font color="#4000C0">=</font><font color="#008000">""</font><font color="#4000C0">)</font>
        <font color="#000000">RemoveFiles</font><font color="#4000C0">(</font><font color="#4000C0">[</font><font color="#000000">x</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font> <font color="#C00000">for</font> <font color="#000000">x</font> <font color="#C00000">in</font> <font color="#000000">pngs</font><font color="#4000C0">]</font><font color="#4000C0">)</font>

        <font color="#a02030"># Plot some of the extracted frames</font>
        <font color="#000000">nextid</font> <font color="#4000C0">=</font> <font color="#000000">TestMovieFrames</font><font color="#4000C0">(</font><font color="#008000">"movie_1_%02d"</font><font color="#4000C0">,</font> <font color="#000000">nextid</font><font color="#4000C0">,</font> <font color="#000000">framefiles</font><font color="#4000C0">,</font> <font color="#000000">percents</font><font color="#4000C0">=</font><font color="#4000C0">[</font><font color="#0080C0">0.</font><font color="#4000C0">,</font> <font color="#0080C0">0.25</font><font color="#4000C0">,</font> <font color="#0080C0">0.5</font><font color="#4000C0">,</font> <font color="#0080C0">0.75</font><font color="#4000C0">,</font> <font color="#0080C0">1.</font><font color="#4000C0">]</font><font color="#4000C0">,</font> <font color="#000000">label</font><font color="#4000C0">=</font><font color="#008000">"MPEG"</font><font color="#4000C0">)</font>
        <font color="#000000">RemoveFiles</font><font color="#4000C0">(</font><font color="#4000C0">[</font><font color="#000000">x</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font> <font color="#C00000">for</font> <font color="#000000">x</font> <font color="#C00000">in</font> <font color="#000000">framefiles</font><font color="#4000C0">]</font><font color="#4000C0">)</font>

    <font color="#a02030">############################################################################</font>
    <font color="#a02030"># Stereo movie with 2 sizes</font>
    <font color="#a02030">############################################################################</font>
    <font color="#C00000">def</font> <font color="#000000">test2</font><font color="#4000C0">(</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
        <font color="#000000">TestSection</font><font color="#4000C0">(</font><font color="#008000">"Script, Stereo with 2 sizes"</font><font color="#4000C0">)</font>
        <font color="#000000">output</font> <font color="#4000C0">=</font> <font color="#000000">GenerateMovie</font><font color="#4000C0">(</font><font color="#4000C0">[</font><font color="#008000">"-scriptfile"</font><font color="#4000C0">,</font> <font color="#008000">"fb_wave.py"</font><font color="#4000C0">,</font> <font color="#008000">"-output"</font><font color="#4000C0">,</font> <font color="#008000">"test_2"</font><font color="#4000C0">,</font> <font color="#008000">"-stereo"</font><font color="#4000C0">,</font> <font color="#008000">"leftright"</font><font color="#4000C0">,</font> <font color="#008000">"-format"</font><font color="#4000C0">,</font> <font color="#008000">"png,png"</font><font color="#4000C0">,</font> <font color="#008000">"-geometry"</font><font color="#4000C0">,</font> <font color="#000000">WH</font><font color="#4000C0">+</font><font color="#008000">",600x600"</font><font color="#4000C0">]</font><font color="#4000C0">)</font>

        <font color="#a02030"># Look at the list of files that were created.</font>
        <font color="#000000">leftWH</font> <font color="#4000C0">=</font> <font color="#000000">GetFiles</font><font color="#4000C0">(</font><font color="#008000">"left_test_2_"</font><font color="#4000C0">+</font><font color="#000000">WH</font><font color="#4000C0">)</font>
        <font color="#000000">rightWH</font> <font color="#4000C0">=</font> <font color="#000000">GetFiles</font><font color="#4000C0">(</font><font color="#008000">"right_test_2_"</font><font color="#4000C0">+</font><font color="#000000">WH</font><font color="#4000C0">)</font>
        <font color="#000000">left600</font> <font color="#4000C0">=</font> <font color="#000000">GetFiles</font><font color="#4000C0">(</font><font color="#008000">"left_test_2_600x600"</font><font color="#4000C0">)</font>
        <font color="#000000">right600</font> <font color="#4000C0">=</font> <font color="#000000">GetFiles</font><font color="#4000C0">(</font><font color="#008000">"right_test_2_600x600"</font><font color="#4000C0">)</font>
        <font color="#000000">TestText</font><font color="#4000C0">(</font><font color="#008000">"movie_2_00"</font><font color="#4000C0">,</font> <font color="#008000">"\n"</font><font color="#4000C0">.</font><font color="#000000">join</font><font color="#4000C0">(</font><font color="#4000C0">[</font><font color="#000000">x</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font> <font color="#C00000">for</font> <font color="#000000">x</font> <font color="#C00000">in</font> <font color="#000000">leftWH</font><font color="#4000C0">]</font><font color="#4000C0">)</font><font color="#4000C0">)</font>
        <font color="#000000">TestText</font><font color="#4000C0">(</font><font color="#008000">"movie_2_01"</font><font color="#4000C0">,</font> <font color="#008000">"\n"</font><font color="#4000C0">.</font><font color="#000000">join</font><font color="#4000C0">(</font><font color="#4000C0">[</font><font color="#000000">x</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font> <font color="#C00000">for</font> <font color="#000000">x</font> <font color="#C00000">in</font> <font color="#000000">rightWH</font><font color="#4000C0">]</font><font color="#4000C0">)</font><font color="#4000C0">)</font>
        <font color="#000000">TestText</font><font color="#4000C0">(</font><font color="#008000">"movie_2_02"</font><font color="#4000C0">,</font> <font color="#008000">"\n"</font><font color="#4000C0">.</font><font color="#000000">join</font><font color="#4000C0">(</font><font color="#4000C0">[</font><font color="#000000">x</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font> <font color="#C00000">for</font> <font color="#000000">x</font> <font color="#C00000">in</font> <font color="#000000">left600</font><font color="#4000C0">]</font><font color="#4000C0">)</font><font color="#4000C0">)</font>
        <font color="#000000">TestText</font><font color="#4000C0">(</font><font color="#008000">"movie_2_03"</font><font color="#4000C0">,</font> <font color="#008000">"\n"</font><font color="#4000C0">.</font><font color="#000000">join</font><font color="#4000C0">(</font><font color="#4000C0">[</font><font color="#000000">x</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font> <font color="#C00000">for</font> <font color="#000000">x</font> <font color="#C00000">in</font> <font color="#000000">right600</font><font color="#4000C0">]</font><font color="#4000C0">)</font><font color="#4000C0">)</font>

        <font color="#a02030"># Plot some of the files we made.</font>
        <font color="#000000">nextid</font> <font color="#4000C0">=</font> <font color="#000000">TestMovieFrames</font><font color="#4000C0">(</font><font color="#008000">"movie_2_%02d"</font><font color="#4000C0">,</font> <font color="#0080C0">4</font><font color="#4000C0">,</font> <font color="#000000">leftWH</font><font color="#4000C0">,</font> <font color="#000000">percents</font><font color="#4000C0">=</font><font color="#4000C0">[</font><font color="#0080C0">0.</font><font color="#4000C0">,</font> <font color="#0080C0">0.25</font><font color="#4000C0">,</font> <font color="#0080C0">0.5</font><font color="#4000C0">,</font> <font color="#0080C0">0.75</font><font color="#4000C0">,</font> <font color="#0080C0">1.</font><font color="#4000C0">]</font><font color="#4000C0">,</font> <font color="#000000">label</font><font color="#4000C0">=</font><font color="#008000">"Left Eye, "</font><font color="#4000C0">+</font> <font color="#000000">WH</font><font color="#4000C0">)</font>
        <font color="#000000">RemoveFiles</font><font color="#4000C0">(</font><font color="#4000C0">[</font><font color="#000000">x</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font> <font color="#C00000">for</font> <font color="#000000">x</font> <font color="#C00000">in</font> <font color="#000000">leftWH</font><font color="#4000C0">]</font><font color="#4000C0">)</font>
        <font color="#000000">nextid</font> <font color="#4000C0">=</font> <font color="#000000">TestMovieFrames</font><font color="#4000C0">(</font><font color="#008000">"movie_2_%02d"</font><font color="#4000C0">,</font> <font color="#000000">nextid</font><font color="#4000C0">,</font> <font color="#000000">rightWH</font><font color="#4000C0">,</font> <font color="#000000">percents</font><font color="#4000C0">=</font><font color="#4000C0">[</font><font color="#0080C0">0.</font><font color="#4000C0">,</font> <font color="#0080C0">0.25</font><font color="#4000C0">,</font> <font color="#0080C0">0.5</font><font color="#4000C0">,</font> <font color="#0080C0">0.75</font><font color="#4000C0">,</font> <font color="#0080C0">1.</font><font color="#4000C0">]</font><font color="#4000C0">,</font> <font color="#000000">label</font><font color="#4000C0">=</font><font color="#008000">"Right Eye, "</font><font color="#4000C0">+</font> <font color="#000000">WH</font><font color="#4000C0">)</font>
        <font color="#000000">RemoveFiles</font><font color="#4000C0">(</font><font color="#4000C0">[</font><font color="#000000">x</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font> <font color="#C00000">for</font> <font color="#000000">x</font> <font color="#C00000">in</font> <font color="#000000">rightWH</font><font color="#4000C0">]</font><font color="#4000C0">)</font>

        <font color="#000000">nextid</font> <font color="#4000C0">=</font> <font color="#000000">TestMovieFrames</font><font color="#4000C0">(</font><font color="#008000">"movie_2_%02d"</font><font color="#4000C0">,</font> <font color="#000000">nextid</font><font color="#4000C0">,</font> <font color="#000000">left600</font><font color="#4000C0">,</font> <font color="#000000">percents</font><font color="#4000C0">=</font><font color="#4000C0">[</font><font color="#0080C0">0.</font><font color="#4000C0">,</font> <font color="#0080C0">0.25</font><font color="#4000C0">,</font> <font color="#0080C0">0.5</font><font color="#4000C0">,</font> <font color="#0080C0">0.75</font><font color="#4000C0">,</font> <font color="#0080C0">1.</font><font color="#4000C0">]</font><font color="#4000C0">,</font> <font color="#000000">label</font><font color="#4000C0">=</font><font color="#008000">"Left Eye, 600x600"</font><font color="#4000C0">)</font>
        <font color="#000000">RemoveFiles</font><font color="#4000C0">(</font><font color="#4000C0">[</font><font color="#000000">x</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font> <font color="#C00000">for</font> <font color="#000000">x</font> <font color="#C00000">in</font> <font color="#000000">left600</font><font color="#4000C0">]</font><font color="#4000C0">)</font>
        <font color="#000000">nextid</font> <font color="#4000C0">=</font> <font color="#000000">TestMovieFrames</font><font color="#4000C0">(</font><font color="#008000">"movie_2_%02d"</font><font color="#4000C0">,</font> <font color="#000000">nextid</font><font color="#4000C0">,</font> <font color="#000000">right600</font><font color="#4000C0">,</font> <font color="#000000">percents</font><font color="#4000C0">=</font><font color="#4000C0">[</font><font color="#0080C0">0.</font><font color="#4000C0">,</font> <font color="#0080C0">0.25</font><font color="#4000C0">,</font> <font color="#0080C0">0.5</font><font color="#4000C0">,</font> <font color="#0080C0">0.75</font><font color="#4000C0">,</font> <font color="#0080C0">1.</font><font color="#4000C0">]</font><font color="#4000C0">,</font> <font color="#000000">label</font><font color="#4000C0">=</font><font color="#008000">"Right Eye, 600x600"</font><font color="#4000C0">)</font>
        <font color="#000000">RemoveFiles</font><font color="#4000C0">(</font><font color="#4000C0">[</font><font color="#000000">x</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font> <font color="#C00000">for</font> <font color="#000000">x</font> <font color="#C00000">in</font> <font color="#000000">right600</font><font color="#4000C0">]</font><font color="#4000C0">)</font>


    <font color="#000000">test0</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">test1</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">test2</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#C00000">def</font> <font color="#000000">test34</font><font color="#4000C0">(</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#000000">WH</font> <font color="#4000C0">=</font> <font color="#008000">"%dx%d"</font> <font color="#4000C0">%</font> <font color="#4000C0">(</font><font color="#000000">TestEnv</font><font color="#4000C0">.</font><font color="#000000">params</font><font color="#4000C0">[</font><font color="#008000">"width"</font><font color="#4000C0">]</font><font color="#4000C0">,</font> <font color="#000000">TestEnv</font><font color="#4000C0">.</font><font color="#000000">params</font><font color="#4000C0">[</font><font color="#008000">"height"</font><font color="#4000C0">]</font><font color="#4000C0">)</font>

    <font color="#C00000">def</font> <font color="#000000">PrepareSession</font><font color="#4000C0">(</font><font color="#000000">infile</font><font color="#4000C0">,</font> <font color="#000000">outfile</font><font color="#4000C0">,</font> <font color="#000000">replacements</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
        <font color="#000000">token</font> <font color="#4000C0">=</font> <font color="#008000">"WAVE_VISIT_DATABASE"</font>
        <font color="#000000">lines</font> <font color="#4000C0">=</font> <font color="#000000">open</font><font color="#4000C0">(</font><font color="#000000">infile</font><font color="#4000C0">,</font> <font color="#008000">"rt"</font><font color="#4000C0">)</font><font color="#4000C0">.</font><font color="#000000">readlines</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
        <font color="#000000">out</font> <font color="#4000C0">=</font> <font color="#000000">open</font><font color="#4000C0">(</font><font color="#000000">outfile</font><font color="#4000C0">,</font> <font color="#008000">"wt"</font><font color="#4000C0">)</font>
        <font color="#C00000">for</font> <font color="#000000">line</font> <font color="#C00000">in</font> <font color="#000000">lines</font><font color="#4000C0">:</font>
            <font color="#000000">s</font> <font color="#4000C0">=</font> <font color="#000000">line</font>
            <font color="#C00000">if</font> <font color="#000000">token</font> <font color="#C00000">in</font> <font color="#000000">line</font><font color="#4000C0">:</font>
                <font color="#000000">s</font> <font color="#4000C0">=</font> <font color="#000000">line</font><font color="#4000C0">.</font><font color="#000000">replace</font><font color="#4000C0">(</font><font color="#000000">token</font><font color="#4000C0">,</font> <font color="#008000">"localhost:"</font> <font color="#4000C0">+</font> <font color="#000000">silo_data_path</font><font color="#4000C0">(</font><font color="#008000">"wave.visit"</font><font color="#4000C0">)</font><font color="#4000C0">)</font>
            <font color="#000000">out</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#000000">s</font><font color="#4000C0">)</font>
        <font color="#000000">out</font><font color="#4000C0">.</font><font color="#000000">close</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

    <font color="#a02030">############################################################################</font>
    <font color="#a02030"># Movie using session files.</font>
    <font color="#a02030">############################################################################</font>
    <font color="#C00000">def</font> <font color="#000000">test3</font><font color="#4000C0">(</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
        <font color="#000000">TestSection</font><font color="#4000C0">(</font><font color="#008000">"Session"</font><font color="#4000C0">)</font>
        <font color="#000000">output</font> <font color="#4000C0">=</font> <font color="#000000">GenerateMovie</font><font color="#4000C0">(</font><font color="#4000C0">[</font><font color="#008000">"-sessionfile"</font><font color="#4000C0">,</font> <font color="#008000">"movie.session"</font><font color="#4000C0">,</font> <font color="#008000">"-output"</font><font color="#4000C0">,</font> <font color="#008000">"test3_"</font><font color="#4000C0">,</font> <font color="#008000">"-format"</font><font color="#4000C0">,</font> <font color="#008000">"png"</font><font color="#4000C0">,</font> <font color="#008000">"-geometry"</font><font color="#4000C0">,</font> <font color="#000000">WH</font><font color="#4000C0">]</font><font color="#4000C0">)</font>

        <font color="#a02030"># Get the frame files</font>
        <font color="#000000">files</font> <font color="#4000C0">=</font> <font color="#000000">GetFiles</font><font color="#4000C0">(</font><font color="#008000">"test3_"</font><font color="#4000C0">)</font><font color="#4000C0">[</font><font color="#0080C0">1</font><font color="#4000C0">:</font><font color="#4000C0">]</font>
        <font color="#000000">txt</font> <font color="#4000C0">=</font> <font color="#008000">"\n"</font><font color="#4000C0">.</font><font color="#000000">join</font><font color="#4000C0">(</font><font color="#4000C0">[</font><font color="#000000">x</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font> <font color="#C00000">for</font> <font color="#000000">x</font> <font color="#C00000">in</font> <font color="#000000">files</font><font color="#4000C0">]</font><font color="#4000C0">)</font>
        <font color="#000000">TestText</font><font color="#4000C0">(</font><font color="#008000">"movie_3_00"</font><font color="#4000C0">,</font> <font color="#000000">txt</font><font color="#4000C0">)</font>

        <font color="#a02030"># Plot some of the frames</font>
        <font color="#000000">nextid</font> <font color="#4000C0">=</font> <font color="#000000">TestMovieFrames</font><font color="#4000C0">(</font><font color="#008000">"movie_3_%02d"</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#000000">files</font><font color="#4000C0">,</font> <font color="#000000">percents</font><font color="#4000C0">=</font><font color="#4000C0">[</font><font color="#0080C0">0.</font><font color="#4000C0">,</font> <font color="#0080C0">0.25</font><font color="#4000C0">,</font> <font color="#0080C0">0.5</font><font color="#4000C0">,</font> <font color="#0080C0">0.75</font><font color="#4000C0">,</font> <font color="#0080C0">1.</font><font color="#4000C0">]</font><font color="#4000C0">,</font> <font color="#000000">label</font><font color="#4000C0">=</font><font color="#008000">""</font><font color="#4000C0">)</font>
        <font color="#000000">RemoveFiles</font><font color="#4000C0">(</font><font color="#4000C0">[</font><font color="#000000">x</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font> <font color="#C00000">for</font> <font color="#000000">x</font> <font color="#C00000">in</font> <font color="#000000">files</font><font color="#4000C0">]</font><font color="#4000C0">)</font>

    <font color="#a02030">############################################################################</font>
    <font color="#a02030"># Movie using session files where we also test -start,-end,-framestep</font>
    <font color="#a02030">############################################################################</font>
    <font color="#C00000">def</font> <font color="#000000">test4</font><font color="#4000C0">(</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
        <font color="#000000">TestSection</font><font color="#4000C0">(</font><font color="#008000">"Session, -start,-end,-framestep"</font><font color="#4000C0">)</font>
        <font color="#000000">output</font> <font color="#4000C0">=</font> <font color="#000000">GenerateMovie</font><font color="#4000C0">(</font><font color="#4000C0">[</font><font color="#008000">"-sessionfile"</font><font color="#4000C0">,</font> <font color="#008000">"movie.session"</font><font color="#4000C0">,</font> <font color="#008000">"-output"</font><font color="#4000C0">,</font> <font color="#008000">"test4_"</font><font color="#4000C0">,</font> <font color="#008000">"-format"</font><font color="#4000C0">,</font> <font color="#008000">"png"</font><font color="#4000C0">,</font> <font color="#008000">"-geometry"</font><font color="#4000C0">,</font> <font color="#000000">WH</font><font color="#4000C0">,</font> <font color="#008000">"-start"</font><font color="#4000C0">,</font> <font color="#008000">"10"</font><font color="#4000C0">,</font> <font color="#008000">"-end"</font><font color="#4000C0">,</font> <font color="#008000">"50"</font><font color="#4000C0">,</font> <font color="#008000">"-framestep"</font><font color="#4000C0">,</font> <font color="#008000">"5"</font><font color="#4000C0">]</font><font color="#4000C0">)</font>

        <font color="#a02030"># Get the frame files</font>
        <font color="#000000">files</font> <font color="#4000C0">=</font> <font color="#000000">GetFiles</font><font color="#4000C0">(</font><font color="#008000">"test4_"</font><font color="#4000C0">)</font><font color="#4000C0">[</font><font color="#0080C0">1</font><font color="#4000C0">:</font><font color="#4000C0">]</font>
        <font color="#000000">print</font><font color="#4000C0">(</font><font color="#000000">files</font><font color="#4000C0">)</font>
        <font color="#000000">txt</font> <font color="#4000C0">=</font> <font color="#008000">"\n"</font><font color="#4000C0">.</font><font color="#000000">join</font><font color="#4000C0">(</font><font color="#4000C0">[</font><font color="#000000">x</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font> <font color="#C00000">for</font> <font color="#000000">x</font> <font color="#C00000">in</font> <font color="#000000">files</font><font color="#4000C0">]</font><font color="#4000C0">)</font>
        <font color="#000000">TestText</font><font color="#4000C0">(</font><font color="#008000">"movie_4_00"</font><font color="#4000C0">,</font> <font color="#000000">txt</font><font color="#4000C0">)</font>

        <font color="#a02030"># Plot some of the frames</font>
        <font color="#000000">nextid</font> <font color="#4000C0">=</font> <font color="#000000">TestMovieFrames</font><font color="#4000C0">(</font><font color="#008000">"movie_4_%02d"</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#000000">files</font><font color="#4000C0">,</font> <font color="#000000">percents</font><font color="#4000C0">=</font><font color="#4000C0">[</font><font color="#0080C0">0.</font><font color="#4000C0">,</font> <font color="#0080C0">0.25</font><font color="#4000C0">,</font> <font color="#0080C0">0.5</font><font color="#4000C0">,</font> <font color="#0080C0">0.75</font><font color="#4000C0">,</font> <font color="#0080C0">1.</font><font color="#4000C0">]</font><font color="#4000C0">,</font> <font color="#000000">label</font><font color="#4000C0">=</font><font color="#008000">""</font><font color="#4000C0">)</font>
        <font color="#000000">RemoveFiles</font><font color="#4000C0">(</font><font color="#4000C0">[</font><font color="#000000">x</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font> <font color="#C00000">for</font> <font color="#000000">x</font> <font color="#C00000">in</font> <font color="#000000">files</font><font color="#4000C0">]</font><font color="#4000C0">)</font>

    <font color="#a02030"># Make the session file suitable for testing.</font>
    <font color="#000000">replacements</font> <font color="#4000C0">=</font> <font color="#4000C0">{</font><font color="#008000">"WAVE_VISIT_DATABASE"</font> <font color="#4000C0">:</font> <font color="#008000">"localhost:"</font> <font color="#4000C0">+</font> <font color="#000000">silo_data_path</font><font color="#4000C0">(</font><font color="#008000">"wave.visit"</font><font color="#4000C0">)</font><font color="#4000C0">}</font>
    <font color="#000000">infile</font> <font color="#4000C0">=</font> <font color="#000000">TestEnv</font><font color="#4000C0">.</font><font color="#000000">params</font><font color="#4000C0">[</font><font color="#008000">"script"</font><font color="#4000C0">]</font><font color="#4000C0">.</font><font color="#000000">replace</font><font color="#4000C0">(</font><font color="#008000">"movie.py"</font><font color="#4000C0">,</font> <font color="#008000">"movie.session"</font><font color="#4000C0">)</font>
    <font color="#000000">FileSubstitution</font><font color="#4000C0">(</font><font color="#000000">infile</font><font color="#4000C0">,</font> <font color="#008000">"movie.session"</font><font color="#4000C0">,</font> <font color="#000000">replacements</font><font color="#4000C0">)</font>

    <font color="#000000">test3</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">test4</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#C00000">def</font> <font color="#000000">test5</font><font color="#4000C0">(</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#000000">TestSection</font><font color="#4000C0">(</font><font color="#008000">"Template movie"</font><font color="#4000C0">)</font>

    <font color="#000000">f</font> <font color="#4000C0">=</font> <font color="#000000">open</font><font color="#4000C0">(</font><font color="#008000">"shortwave.visit"</font><font color="#4000C0">,</font> <font color="#008000">"wt"</font><font color="#4000C0">)</font>
    <font color="#C00000">for</font> <font color="#000000">i</font> <font color="#C00000">in</font> <font color="#000000">range</font><font color="#4000C0">(</font><font color="#0080C0">0</font><font color="#4000C0">,</font><font color="#0080C0">71</font><font color="#4000C0">,</font><font color="#0080C0">5</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
        <font color="#000000">line</font> <font color="#4000C0">=</font> <font color="#000000">silo_data_path</font><font color="#4000C0">(</font><font color="#008000">"wave%04d.silo"</font> <font color="#4000C0">%</font> <font color="#4000C0">(</font><font color="#000000">i</font><font color="#4000C0">*</font><font color="#0080C0">10</font><font color="#4000C0">)</font><font color="#4000C0">)</font>
        <font color="#000000">print</font><font color="#4000C0">(</font><font color="#000000">line</font><font color="#4000C0">)</font>
        <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">write</font><font color="#4000C0">(</font><font color="#008000">"%s\n"</font> <font color="#4000C0">%</font> <font color="#000000">line</font><font color="#4000C0">)</font>
    <font color="#000000">f</font><font color="#4000C0">.</font><font color="#000000">close</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

    <font color="#a02030"># Make the session file suitable for testing.</font>
    <font color="#000000">replacements</font> <font color="#4000C0">=</font> <font color="#4000C0">{</font><font color="#008000">"WAVE_VISIT_DATABASE"</font> <font color="#4000C0">:</font> <font color="#008000">"localhost:%s"</font> <font color="#4000C0">%</font> <font color="#000000">os</font><font color="#4000C0">.</font><font color="#000000">path</font><font color="#4000C0">.</font><font color="#000000">abspath</font><font color="#4000C0">(</font><font color="#008000">"shortwave.visit"</font><font color="#4000C0">)</font><font color="#4000C0">}</font>
    <font color="#000000">infile</font> <font color="#4000C0">=</font> <font color="#000000">TestEnv</font><font color="#4000C0">.</font><font color="#000000">params</font><font color="#4000C0">[</font><font color="#008000">"script"</font><font color="#4000C0">]</font><font color="#4000C0">.</font><font color="#000000">replace</font><font color="#4000C0">(</font><font color="#008000">"movie.py"</font><font color="#4000C0">,</font> <font color="#008000">"movie5.session"</font><font color="#4000C0">)</font>
    <font color="#000000">FileSubstitution</font><font color="#4000C0">(</font><font color="#000000">infile</font><font color="#4000C0">,</font> <font color="#008000">"movie5.session"</font><font color="#4000C0">,</font> <font color="#000000">replacements</font><font color="#4000C0">)</font>

    <font color="#a02030"># Make the template file suitable for testing.</font>
    <font color="#000000">replacements</font> <font color="#4000C0">=</font> <font color="#4000C0">{</font><font color="#008000">"PATH_TO_VISITMOVIETEMPLATE_PY"</font> <font color="#4000C0">:</font> <font color="#000000">os</font><font color="#4000C0">.</font><font color="#000000">path</font><font color="#4000C0">.</font><font color="#000000">join</font><font color="#4000C0">(</font><font color="#000000">os</font><font color="#4000C0">.</font><font color="#000000">getenv</font><font color="#4000C0">(</font><font color="#008000">"VISITHOME"</font><font color="#4000C0">)</font><font color="#4000C0">,</font> <font color="#008000">"resources"</font><font color="#4000C0">,</font> <font color="#008000">"movietemplates"</font><font color="#4000C0">,</font> <font color="#008000">"visitmovietemplate.py"</font><font color="#4000C0">)</font><font color="#4000C0">,</font>
                    <font color="#008000">"TEST_SESSION_FILE"</font> <font color="#4000C0">:</font> <font color="#000000">os</font><font color="#4000C0">.</font><font color="#000000">path</font><font color="#4000C0">.</font><font color="#000000">abspath</font><font color="#4000C0">(</font><font color="#008000">"movie5.session"</font><font color="#4000C0">)</font><font color="#4000C0">}</font>
    <font color="#000000">infile</font> <font color="#4000C0">=</font> <font color="#000000">TestEnv</font><font color="#4000C0">.</font><font color="#000000">params</font><font color="#4000C0">[</font><font color="#008000">"script"</font><font color="#4000C0">]</font><font color="#4000C0">.</font><font color="#000000">replace</font><font color="#4000C0">(</font><font color="#008000">"movie.py"</font><font color="#4000C0">,</font> <font color="#008000">"movie5.opt"</font><font color="#4000C0">)</font>
    <font color="#000000">FileSubstitution</font><font color="#4000C0">(</font><font color="#000000">infile</font><font color="#4000C0">,</font> <font color="#008000">"movie5.opt"</font><font color="#4000C0">,</font> <font color="#000000">replacements</font><font color="#4000C0">)</font>

    <font color="#a02030"># Note by KSB 03-11-2020</font>
    <font color="#a02030"># Changed geometry from 300x300 to 600x600. On Windows 300x300 forces the inset windows (2 and 3) to be too</font>
    <font color="#a02030"># small (76x63). They are resized to 116x63, and the resultant images are incorrect.</font>
    <font color="#000000">output</font> <font color="#4000C0">=</font> <font color="#000000">GenerateMovie</font><font color="#4000C0">(</font><font color="#4000C0">[</font><font color="#008000">"-templatefile"</font><font color="#4000C0">,</font> <font color="#008000">"movie5.opt"</font><font color="#4000C0">,</font> <font color="#008000">"-output"</font><font color="#4000C0">,</font> <font color="#008000">"test5_"</font><font color="#4000C0">,</font> <font color="#008000">"-format"</font><font color="#4000C0">,</font> <font color="#008000">"bmp"</font><font color="#4000C0">,</font> <font color="#008000">"-geometry"</font><font color="#4000C0">,</font> <font color="#008000">"600x600"</font><font color="#4000C0">]</font><font color="#4000C0">)</font>

    <font color="#000000">files</font> <font color="#4000C0">=</font> <font color="#000000">GetFiles</font><font color="#4000C0">(</font><font color="#008000">"test5_"</font><font color="#4000C0">)</font>
    <font color="#000000">img</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#4000C0">]</font>
    <font color="#C00000">for</font> <font color="#000000">f</font> <font color="#C00000">in</font> <font color="#000000">files</font><font color="#4000C0">:</font>
        <font color="#C00000">if</font> <font color="#000000">f</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font><font color="#4000C0">[</font><font color="#4000C0">-</font><font color="#0080C0">4</font><font color="#4000C0">:</font><font color="#4000C0">]</font> <font color="#4000C0">==</font> <font color="#008000">".bmp"</font><font color="#4000C0">:</font>
            <font color="#a02030">#</font>
            <font color="#a02030"># NOTE: I could not get ffmpeg to work with png output from visit-composite</font>
            <font color="#a02030"># now that it uses VTK. I also could not get VisIt to read PNG, TIFF, or </font>
            <font color="#a02030"># BMP files made with that VTK export. The files looked okay on my Mac viewer</font>
            <font color="#a02030"># but VisIt didn't like them. Maybe they had alpha.</font>
            <font color="#a02030">#</font>
            <font color="#000000">bmp</font> <font color="#4000C0">=</font> <font color="#000000">f</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font>
            <font color="#000000">png</font> <font color="#4000C0">=</font> <font color="#000000">f</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font><font color="#4000C0">[</font><font color="#4000C0">:</font><font color="#4000C0">-</font><font color="#0080C0">4</font><font color="#4000C0">]</font> <font color="#4000C0">+</font> <font color="#008000">".png"</font>
            <font color="#000000">print</font><font color="#4000C0">(</font><font color="#008000">"convert %s %s"</font> <font color="#4000C0">%</font> <font color="#4000C0">(</font><font color="#000000">bmp</font><font color="#4000C0">,</font> <font color="#000000">png</font><font color="#4000C0">)</font><font color="#4000C0">)</font>
            <font color="#000000">im1</font> <font color="#4000C0">=</font> <font color="#000000">Image</font><font color="#4000C0">.</font><font color="#000000">open</font><font color="#4000C0">(</font><font color="#000000">bmp</font><font color="#4000C0">)</font>
            <font color="#000000">im1</font><font color="#4000C0">.</font><font color="#000000">save</font><font color="#4000C0">(</font><font color="#000000">png</font><font color="#4000C0">,</font> <font color="#008000">"png"</font><font color="#4000C0">)</font>
            <font color="#000000">img</font> <font color="#4000C0">=</font> <font color="#000000">img</font> <font color="#4000C0">+</font> <font color="#4000C0">[</font><font color="#4000C0">(</font><font color="#000000">png</font><font color="#4000C0">,</font><font color="#0080C0">0</font><font color="#4000C0">)</font><font color="#4000C0">]</font>
    <font color="#000000">txt</font> <font color="#4000C0">=</font> <font color="#008000">"\n"</font><font color="#4000C0">.</font><font color="#000000">join</font><font color="#4000C0">(</font><font color="#4000C0">[</font><font color="#000000">x</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font> <font color="#C00000">for</font> <font color="#000000">x</font> <font color="#C00000">in</font> <font color="#000000">img</font><font color="#4000C0">]</font><font color="#4000C0">)</font>
    <font color="#000000">TestText</font><font color="#4000C0">(</font><font color="#008000">"movie_5_00"</font><font color="#4000C0">,</font> <font color="#000000">txt</font><font color="#4000C0">)</font>

    <font color="#000000">nextid</font> <font color="#4000C0">=</font> <font color="#000000">TestMovieFrames</font><font color="#4000C0">(</font><font color="#008000">"movie_5_%02d"</font><font color="#4000C0">,</font> <font color="#0080C0">1</font><font color="#4000C0">,</font> <font color="#000000">img</font><font color="#4000C0">)</font>
    <font color="#000000">RemoveFiles</font><font color="#4000C0">(</font><font color="#4000C0">[</font><font color="#000000">x</font><font color="#4000C0">[</font><font color="#0080C0">0</font><font color="#4000C0">]</font> <font color="#C00000">for</font> <font color="#000000">x</font> <font color="#C00000">in</font> <font color="#000000">img</font><font color="#4000C0">]</font><font color="#4000C0">)</font>

<font color="#C00000">def</font> <font color="#000000">main</font><font color="#4000C0">(</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#000000">test012</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">test34</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">test5</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">main</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Exit</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000"></font></font></pre></body></html>