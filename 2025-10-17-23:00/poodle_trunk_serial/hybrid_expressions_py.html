<html><body bgcolor="#e0e0e0"><head><title>hybrid/expressions.py</title></head><pre><font face="Lucida,Courier New"><font color="#a02030"># ----------------------------------------------------------------------------</font>
<font color="#a02030">#  CLASSES: nightly</font>
<font color="#a02030">#</font>
<font color="#a02030">#  Test Case:  expressions.py</font>
<font color="#a02030">#</font>
<font color="#a02030">#  Tests:      mesh      - 3D unstructured, single domain</font>
<font color="#a02030">#              plots     - pc</font>
<font color="#a02030">#</font>
<font color="#a02030">#  Defect ID:  &#x27;3939 + &#x27;4008 + &#x27;4022 + &#x27;4162 + &#x27;4417 + &#x27;4435 + &#x27;5790 + &#x27;5672</font>
<font color="#a02030">#            + &#x27;5763 + &#x27;5767 + &#x27;5874 + &#x27;7465 + &#x27;7473</font>
<font color="#a02030">#</font>
<font color="#a02030">#  Programmer: Hank Childs</font>
<font color="#a02030">#  Date:       November 18, 2002</font>
<font color="#a02030">#</font>
<font color="#a02030">#  Modifications:</font>
<font color="#a02030">#</font>
<font color="#a02030">#    Hank Childs, Fri Oct 24 09:25:04 PDT 2003</font>
<font color="#a02030">#    Added test for mesh expressions for databases where we communicate</font>
<font color="#a02030">#    ghost zones.</font>
<font color="#a02030">#</font>
<font color="#a02030">#    Hank Childs, Wed Dec 10 14:25:01 PST 2003</font>
<font color="#a02030">#    Add tests for implicit and explicit changes in centering.  Also added</font>
<font color="#a02030">#    a test for the identity expression, which previously crashed the engine.</font>
<font color="#a02030">#</font>
<font color="#a02030">#    Hank Childs, Wed Feb 11 14:49:40 PST 2004</font>
<font color="#a02030">#    Add tests for nmats and constants.</font>
<font color="#a02030">#    </font>
<font color="#a02030">#    Hank Childs, Thu Apr 22 16:19:36 PDT 2004</font>
<font color="#a02030">#    Update comments due to the change in semantics of recenter (it is now</font>
<font color="#a02030">#    always zonal).</font>
<font color="#a02030">#</font>
<font color="#a02030">#    Hank Childs, Wed Dec 22 13:14:29 PST 2004</font>
<font color="#a02030">#    Add tests for variables used both in an expression and in the</font>
<font color="#a02030">#    pipeline [&#x27;5790].</font>
<font color="#a02030">#</font>
<font color="#a02030">#    Hank Childs, Thu Jan  6 11:21:21 PST 2005</font>
<font color="#a02030">#    Add tests for multiple identity filters and additional tests for mixed</font>
<font color="#a02030">#    centering [&#x27;5672, &#x27;5763, &#x27;5767].</font>
<font color="#a02030">#</font>
<font color="#a02030">#    Hank Childs, Thu Jan 20 18:29:28 PST 2005</font>
<font color="#a02030">#    Add test for resrad [&#x27;5874].</font>
<font color="#a02030">#</font>
<font color="#a02030">#    Hank Childs, Fri Aug 25 17:34:13 PDT 2006</font>
<font color="#a02030">#    Add test for resrad when arguments are missing [&#x27;7473].</font>
<font color="#a02030">#</font>
<font color="#a02030">#    Hank Childs, Fri Sep 14 11:52:39 PDT 2007</font>
<font color="#a02030">#    Add test for identify filters and meshes [&#x27;7465].</font>
<font color="#a02030">#</font>
<font color="#a02030">#    Cyrus Harrison, Thu Jan 31 09:19:57 PST 2008</font>
<font color="#a02030">#    Added a test for the value_for_material filter. </font>
<font color="#a02030">#</font>
<font color="#a02030">#    Cyrus Harrison, Tue Feb 19 13:52:01 PST 2008</font>
<font color="#a02030">#    Removed value_for_material tests (they now reside in val4mat.py)</font>
<font color="#a02030">#</font>
<font color="#a02030">#    Kathleen Bonnell, Thu May  7 09:26:36 PDT 2009</font>
<font color="#a02030">#    ident_mesh is no longer an error case, so remove the error test and</font>
<font color="#a02030">#    save an image instead.</font>
<font color="#a02030">#</font>
<font color="#a02030">#    Mark C. Miller, Wed Jan 20 07:37:11 PST 2010</font>
<font color="#a02030">#    Added ability to swtich between Silo&#x27;s HDF5 and PDB data.</font>
<font color="#a02030">#</font>
<font color="#a02030">#    Alister Maguire, Mon Mar 29 12:17:40 PDT 2021</font>
<font color="#a02030">#    Moved min/max tests into function and extended to include</font>
<font color="#a02030">#    multi-domain data.</font>
<font color="#a02030">#</font>
<font color="#a02030">#    Eric Brugger, Fri Aug  1 14:49:24 PDT 2025</font>
<font color="#a02030">#    I added tests for defining expressions with a list of names and a list</font>
<font color="#a02030">#    of definitions.</font>
<font color="#a02030">#</font>
<font color="#a02030"># ----------------------------------------------------------------------------</font>

<font color="#C00000">def</font> <font color="#000000">TestMinMaxExpression</font><font color="#4000C0">(</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#a02030"># Test min/max expression</font>
    <font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">silo_data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;rect2d.silo&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font>

    <font color="#a02030">#</font>
    <font color="#a02030"># First, let&#x27;s test a serial dataset.</font>
    <font color="#a02030">#</font>
    <font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&#x27;min1&#x27;</font><font color="#4000C0">,</font> <font color="#008000">&#x27;min(10.0, 5.0, d+p)&#x27;</font><font color="#4000C0">)</font>
    <font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&#x27;Pseudocolor&#x27;</font><font color="#4000C0">,</font> <font color="#008000">&#x27;min1&#x27;</font><font color="#4000C0">)</font>
    <font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&#x27;min1&#x27;</font><font color="#4000C0">)</font>
    <font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

    <font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&#x27;min2&#x27;</font><font color="#4000C0">,</font> <font color="#008000">&#x27;min(d+p, 5.0, 10.0)&#x27;</font><font color="#4000C0">)</font>
    <font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&#x27;Pseudocolor&#x27;</font><font color="#4000C0">,</font> <font color="#008000">&#x27;min2&#x27;</font><font color="#4000C0">)</font>
    <font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&#x27;min2&#x27;</font><font color="#4000C0">)</font>
    <font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

    <font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&#x27;max1&#x27;</font><font color="#4000C0">,</font> <font color="#008000">&#x27;max(10.0, 5.0, d+p)&#x27;</font><font color="#4000C0">)</font>
    <font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&#x27;Pseudocolor&#x27;</font><font color="#4000C0">,</font> <font color="#008000">&#x27;max1&#x27;</font><font color="#4000C0">)</font>
    <font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&#x27;max1&#x27;</font><font color="#4000C0">)</font>
    <font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

    <font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&#x27;min3&#x27;</font><font color="#4000C0">,</font> <font color="#008000">&#x27;min(2.0, d+p, d*p+2*d)&#x27;</font><font color="#4000C0">)</font>
    <font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&#x27;Pseudocolor&#x27;</font><font color="#4000C0">,</font> <font color="#008000">&#x27;min3&#x27;</font><font color="#4000C0">)</font>
    <font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&#x27;min3&#x27;</font><font color="#4000C0">)</font>
    <font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

    <font color="#000000">CloseDatabase</font><font color="#4000C0">(</font><font color="#000000">silo_data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;rect2d.silo&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font>

    <font color="#a02030">#</font>
    <font color="#a02030"># Multi-domain datasets are handled a little differently, so</font>
    <font color="#a02030"># let&#x27;s test one here.</font>
    <font color="#a02030">#</font>
    <font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">silo_data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;multi_ucd3d.silo&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font>

    <font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&#x27;max2&#x27;</font><font color="#4000C0">,</font> <font color="#008000">&#x27;max(p*16, 4)&#x27;</font><font color="#4000C0">)</font>
    <font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&#x27;Pseudocolor&#x27;</font><font color="#4000C0">,</font> <font color="#008000">&#x27;max2&#x27;</font><font color="#4000C0">)</font>
    <font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&#x27;max2&#x27;</font><font color="#4000C0">)</font>
    <font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

    <font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&#x27;max3&#x27;</font><font color="#4000C0">,</font> <font color="#008000">&#x27;max(p*16, d, 4)&#x27;</font><font color="#4000C0">)</font>
    <font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&#x27;Pseudocolor&#x27;</font><font color="#4000C0">,</font> <font color="#008000">&#x27;max3&#x27;</font><font color="#4000C0">)</font>
    <font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
    <font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&#x27;max3&#x27;</font><font color="#4000C0">)</font>
    <font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

    <font color="#000000">CloseDatabase</font><font color="#4000C0">(</font><font color="#000000">silo_data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;multi_ucd3d.silo&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font>

<font color="#C00000">def</font> <font color="#000000">TestListsOfExpressions</font><font color="#4000C0">(</font><font color="#4000C0">)</font><font color="#4000C0">:</font>
    <font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">silo_data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;rect2d.silo&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font>

    <font color="#a02030"># Test passing a list of expression names and a list of expression</font>
    <font color="#a02030"># definitions to each of the define expression functions. I&#x27;m testing</font>
    <font color="#a02030"># all the versions to make sure the common coding is getting called</font>
    <font color="#a02030"># for all of them.</font>
    <font color="#000000">errmsg</font> <font color="#4000C0">=</font> <font color="#008000">&quot;&quot;</font>
    <font color="#C00000">try</font><font color="#4000C0">:</font>
        <font color="#000000">exprNames</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#008000">&quot;var0000&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;var0001&quot;</font><font color="#4000C0">]</font>
        <font color="#000000">exprDefs</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#008000">&quot;arrayVar*2.&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;arrayVar*3.&quot;</font><font color="#4000C0">]</font>
        <font color="#000000">DefineArrayExpression</font><font color="#4000C0">(</font><font color="#000000">exprNames</font><font color="#4000C0">,</font> <font color="#000000">exprDefs</font><font color="#4000C0">)</font>

        <font color="#000000">exprNames</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#008000">&quot;var0002&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;var0003&quot;</font><font color="#4000C0">]</font>
        <font color="#000000">exprDefs</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#008000">&quot;curveVar*2.&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;curveVar*3.&quot;</font><font color="#4000C0">]</font>
        <font color="#000000">DefineCurveExpression</font><font color="#4000C0">(</font><font color="#000000">exprNames</font><font color="#4000C0">,</font> <font color="#000000">exprDefs</font><font color="#4000C0">)</font>

        <font color="#000000">exprNames</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#008000">&quot;var0004&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;var0005&quot;</font><font color="#4000C0">]</font>
        <font color="#000000">exprDefs</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#008000">&quot;materialVar*2.&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;materialVar*3.&quot;</font><font color="#4000C0">]</font>
        <font color="#000000">DefineMaterialExpression</font><font color="#4000C0">(</font><font color="#000000">exprNames</font><font color="#4000C0">,</font> <font color="#000000">exprDefs</font><font color="#4000C0">)</font>

        <font color="#000000">exprNames</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#008000">&quot;var0006&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;var0007&quot;</font><font color="#4000C0">]</font>
        <font color="#000000">exprDefs</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#008000">&quot;meshVar*2.&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;meshVar*3.&quot;</font><font color="#4000C0">]</font>
        <font color="#000000">DefineMeshExpression</font><font color="#4000C0">(</font><font color="#000000">exprNames</font><font color="#4000C0">,</font> <font color="#000000">exprDefs</font><font color="#4000C0">)</font>

        <font color="#000000">exprNames</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#008000">&quot;var0008&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;var0009&quot;</font><font color="#4000C0">]</font>
        <font color="#000000">exprDefs</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#008000">&quot;scalarVar*2.&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;scalarVar*3.&quot;</font><font color="#4000C0">]</font>
        <font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#000000">exprNames</font><font color="#4000C0">,</font> <font color="#000000">exprDefs</font><font color="#4000C0">)</font>

        <font color="#000000">exprNames</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#008000">&quot;var0010&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;var0011&quot;</font><font color="#4000C0">]</font>
        <font color="#000000">exprDefs</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#008000">&quot;speciesVar*2.&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;speciesVar*3.&quot;</font><font color="#4000C0">]</font>
        <font color="#000000">DefineSpeciesExpression</font><font color="#4000C0">(</font><font color="#000000">exprNames</font><font color="#4000C0">,</font> <font color="#000000">exprDefs</font><font color="#4000C0">)</font>

        <font color="#000000">exprNames</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#008000">&quot;var0012&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;var0013&quot;</font><font color="#4000C0">]</font>
        <font color="#000000">exprDefs</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#008000">&quot;tensorVar*2.&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;tensorVar*3.&quot;</font><font color="#4000C0">]</font>
        <font color="#000000">DefineTensorExpression</font><font color="#4000C0">(</font><font color="#000000">exprNames</font><font color="#4000C0">,</font> <font color="#000000">exprDefs</font><font color="#4000C0">)</font>

        <font color="#000000">exprNames</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#008000">&quot;var0014&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;var0015&quot;</font><font color="#4000C0">]</font>
        <font color="#000000">exprDefs</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#008000">&quot;vectorVar*2.&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;vectorVar*3.&quot;</font><font color="#4000C0">]</font>
        <font color="#000000">DefineVectorExpression</font><font color="#4000C0">(</font><font color="#000000">exprNames</font><font color="#4000C0">,</font> <font color="#000000">exprDefs</font><font color="#4000C0">)</font>
    <font color="#C00000">except</font> <font color="#000000">Exception</font> <font color="#C00000">as</font> <font color="#000000">e</font><font color="#4000C0">:</font>
        <font color="#000000">errmsg</font> <font color="#4000C0">=</font> <font color="#000000">str</font><font color="#4000C0">(</font><font color="#000000">e</font><font color="#4000C0">)</font>
    <font color="#000000">TestValueEQ</font><font color="#4000C0">(</font><font color="#008000">&#x27;Defining an expression with 2 expressions&#x27;</font><font color="#4000C0">,</font> <font color="#000000">errmsg</font><font color="#4000C0">,</font> <font color="#008000">&#x27;&#x27;</font><font color="#4000C0">)</font>

    <font color="#a02030"># Test passing a list of expression names and a list of expression</font>
    <font color="#a02030"># definitions where the number in each list don&#x27;t match. I&#x27;m only</font>
    <font color="#a02030"># testing DefineScalarExpression since they all use a common function.</font>
    <font color="#000000">errmsg</font> <font color="#4000C0">=</font> <font color="#008000">&quot;&quot;</font>
    <font color="#C00000">try</font><font color="#4000C0">:</font>
        <font color="#000000">exprNames</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#008000">&quot;var0000&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;var0001&quot;</font><font color="#4000C0">]</font>
        <font color="#000000">exprDefs</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#008000">&quot;scalarVar*2.&quot;</font><font color="#4000C0">]</font>
        <font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#000000">exprNames</font><font color="#4000C0">,</font> <font color="#000000">exprDefs</font><font color="#4000C0">)</font>
    <font color="#C00000">except</font> <font color="#000000">Exception</font> <font color="#C00000">as</font> <font color="#000000">e</font><font color="#4000C0">:</font>
        <font color="#000000">errmsg</font> <font color="#4000C0">=</font> <font color="#000000">str</font><font color="#4000C0">(</font><font color="#000000">e</font><font color="#4000C0">)</font>
    <font color="#000000">TestValueEQ</font><font color="#4000C0">(</font><font color="#008000">&#x27;Mismatched expression lists names &gt; defs&#x27;</font><font color="#4000C0">,</font> <font color="#000000">errmsg</font><font color="#4000C0">,</font> <font color="#008000">&#x27;The number of expression names and definitions must match.&#x27;</font><font color="#4000C0">)</font>

    <font color="#000000">errmsg</font> <font color="#4000C0">=</font> <font color="#008000">&quot;&quot;</font>
    <font color="#C00000">try</font><font color="#4000C0">:</font>
        <font color="#000000">exprNames</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#008000">&quot;var0000&quot;</font><font color="#4000C0">]</font>
        <font color="#000000">exprDefs</font> <font color="#4000C0">=</font> <font color="#4000C0">[</font><font color="#008000">&quot;scalarVar*2.&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;scalarVar*3.&quot;</font><font color="#4000C0">]</font>
        <font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#000000">exprNames</font><font color="#4000C0">,</font> <font color="#000000">exprDefs</font><font color="#4000C0">)</font>
    <font color="#C00000">except</font> <font color="#000000">Exception</font> <font color="#C00000">as</font> <font color="#000000">e</font><font color="#4000C0">:</font>
        <font color="#000000">errmsg</font> <font color="#4000C0">=</font> <font color="#000000">str</font><font color="#4000C0">(</font><font color="#000000">e</font><font color="#4000C0">)</font>
    <font color="#000000">TestValueEQ</font><font color="#4000C0">(</font><font color="#008000">&#x27;Mismatched expression lists names &lt; defs&#x27;</font><font color="#4000C0">,</font> <font color="#000000">errmsg</font><font color="#4000C0">,</font> <font color="#008000">&#x27;The number of expression names and definitions must match.&#x27;</font><font color="#4000C0">)</font>

    <font color="#000000">CloseDatabase</font><font color="#4000C0">(</font><font color="#000000">silo_data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;rect2d.silo&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font>

<font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">silo_data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;bigsil.silo&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font>


<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;radius_polar&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;polar(mesh)[0]&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Contour&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;radius_polar&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;radius_ghosts&quot;</font><font color="#4000C0">)</font>

<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">silo_data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;globe.silo&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font>



<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;mag1&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;magnitude(vel)&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;mag1&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;magnitude1&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#a02030">#</font>
<font color="#a02030"># We have a poor gradient scheme that will cause gradients along a band to</font>
<font color="#a02030"># falsely register as 0.  Regardless, I&#x27;d like to test it.</font>
<font color="#a02030">#</font>
<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;mag2&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;magnitude(gradient(v))&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;mag2&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;magnitude2&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>


<font color="#a02030">#</font>
<font color="#a02030"># See above comment regarding gradients.</font>
<font color="#a02030">#</font>
<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;vector_sum&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;magnitude(gradient(v)+gradient(u))&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;vector_sum&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;vector_sum&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>


<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;vector_diff&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;magnitude(gradient(v)-gradient(u))&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;vector_diff&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;vector_diff&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>


<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;theta&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;polar(mesh1)[1]&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;theta&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;theta&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>


<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;phi&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;polar(mesh1)[2]&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;phi&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;phi&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>


<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;cos&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;cos(polar(mesh1)[1])&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;cos&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;cos&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>


<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;abs_cos&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;abs(cos(polar(mesh1)[1]))&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;abs_cos&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;abs_cos&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>


<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;sin&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;sin(polar(mesh1)[1])&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;sin&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;sin&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>


<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;minus_sin&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;-sin(polar(mesh1)[1])&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;minus_sin&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;minus_sin&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;four_phase&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;rad2deg(acos(sin(polar(mesh1)[1]))-polar(mesh1)[1])&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;four_phase&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;four_phase&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>


<font color="#000000">atts</font> <font color="#4000C0">=</font> <font color="#000000">PseudocolorAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">minFlag</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">min</font> <font color="#4000C0">=</font> <font color="#0080C0">0.99</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">maxFlag</font> <font color="#4000C0">=</font> <font color="#0080C0">1</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">max</font> <font color="#4000C0">=</font> <font color="#0080C0">1.01</font>
<font color="#000000">SetDefaultPlotOptions</font><font color="#4000C0">(</font><font color="#000000">atts</font><font color="#4000C0">)</font>

<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;one&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;sin(polar(mesh1)[1])*sin(polar(mesh1)[1]) + cos(polar(mesh1)[1])*cos(polar(mesh1)[1])&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;one&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;one&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">minFlag</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
<font color="#000000">atts</font><font color="#4000C0">.</font><font color="#000000">maxFlag</font> <font color="#4000C0">=</font> <font color="#0080C0">0</font>
<font color="#000000">SetDefaultPlotOptions</font><font color="#4000C0">(</font><font color="#000000">atts</font><font color="#4000C0">)</font>

<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;X&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;coord(mesh1)[0]&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;X&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;X&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>


<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;radius&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;sqrt(coords(mesh1)[0]*coords(mesh1)[0]+coords(mesh1)[1]*coords(mesh1)[1]+coords(mesh1)[2]*coords(mesh1)[2])&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;radius&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;radius&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>


<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;zero&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;(polar(mesh1))[0] - sqrt(coords(mesh1)[0]*coords(mesh1)[0]+coords(mesh1)[1]*coords(mesh1)[1]+coords(mesh1)[2]*coords(mesh1)[2])&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;zero&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;zero&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">DefineVectorExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;dd&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;disp+{1,2,3}&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Vector&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;dd&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;vector_add_const&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">DefineVectorExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;cr&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;cross(disp,dd)&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Vector&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;cr&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;vector_cross&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;a&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;t&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;a&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;identity_expr&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;sum1&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;t+100*u&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;sum1&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;diff_centering_expr_01&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;sum2&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;(u+t/100.)*100.&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;sum2&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;diff_centering_expr_02&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;diff&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;sum2-sum1&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;diff&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;diff_centering_expr_03&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;sum_rc1&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;recenter(t)+100*u&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;sum_rc1&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;diff_centering_expr_04&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#a02030"># This one will recenter the first t.  When the second one is subtracted,</font>
<font color="#a02030"># will recenter the first t again to make it zonal again.</font>
<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;diff_rc1&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;recenter(t)-t&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;diff_rc1&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;diff_centering_expr_05&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#a02030"># This one will recenter the first t twice.  The second one will not be </font>
<font color="#a02030"># touched.</font>
<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;diff_rc2&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;recenter(recenter(t))-t&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;diff_rc2&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;diff_centering_expr_06&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#a02030"># The first t will not be touched.  The second one will be recentered once</font>
<font color="#a02030"># explicitly and once implicitly (from the minus).</font>
<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;diff_rc3&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;t-recenter(t)&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;diff_rc2&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;diff_centering_expr_07&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#a02030"># The constant (3.14159) will be the only variable in the dataset.  Test</font>
<font color="#a02030"># that the constant creation logic can figure out that we must be making</font>
<font color="#a02030"># an expression based on the mesh downstream.</font>
<font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">silo_data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;rect3d.silo&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font>

<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;sin_x&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;sin(3.14159*coord(quadmesh3d)[0])&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;sin_x&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;const_with_no_other_vars&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#a02030"># The nmats expression needs to use the original zone numbers array to</font>
<font color="#a02030"># find the correct index into an avtMaterial object.  Make sure that this is</font>
<font color="#a02030"># being done correctly by splitting the zones before we even get to the</font>
<font color="#a02030"># expression via MIR.</font>
<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;nmats&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;nmats(mat1)&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;FilledBoundary&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;mat1&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddOperator</font><font color="#4000C0">(</font><font color="#008000">&quot;Threshold&quot;</font><font color="#4000C0">)</font>
<font color="#000000">thresh</font> <font color="#4000C0">=</font> <font color="#000000">ThresholdAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">thresh</font><font color="#4000C0">.</font><font color="#000000">lowerBounds</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">1.5</font><font color="#4000C0">)</font>
<font color="#000000">thresh</font><font color="#4000C0">.</font><font color="#000000">listedVarNames</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#008000">&quot;nmats&quot;</font><font color="#4000C0">)</font>
<font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">thresh</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;nmats_with_mir&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#a02030"># Test that a variable (u) can be used in both the expression and downstream</font>
<font color="#a02030"># in the pipeline.</font>
<font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">silo_data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;globe.silo&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font>

<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;speed&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddOperator</font><font color="#4000C0">(</font><font color="#008000">&quot;Threshold&quot;</font><font color="#4000C0">)</font>
<font color="#000000">thresh</font> <font color="#4000C0">=</font> <font color="#000000">ThresholdAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">thresh</font><font color="#4000C0">.</font><font color="#000000">lowerBounds</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#0080C0">0.0</font><font color="#4000C0">)</font>
<font color="#000000">thresh</font><font color="#4000C0">.</font><font color="#000000">listedVarNames</font> <font color="#4000C0">=</font> <font color="#4000C0">(</font><font color="#008000">&quot;u&quot;</font><font color="#4000C0">)</font>
<font color="#000000">SetOperatorOptions</font><font color="#4000C0">(</font><font color="#000000">thresh</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;mult_var_usage&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#a02030"># The binary math filter forces mixed centering to be zonal.  The base class</font>
<font color="#a02030"># used to get confused and would sometimes declare the variable as nodal.</font>
<font color="#a02030"># Test to make sure this works.  By forcing the centering, we can confirm</font>
<font color="#a02030"># the base class is declaring the variable the right way.</font>
<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;prod&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;u*t&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;prod&quot;</font><font color="#4000C0">)</font>
<font color="#000000">pc</font> <font color="#4000C0">=</font> <font color="#000000">PseudocolorAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">pc</font><font color="#4000C0">.</font><font color="#000000">centering</font> <font color="#4000C0">=</font> <font color="#000000">pc</font><font color="#4000C0">.</font><font color="#000000">Nodal</font>
<font color="#000000">SetPlotOptions</font><font color="#4000C0">(</font><font color="#000000">pc</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;mixed_centering_nodal&quot;</font><font color="#4000C0">)</font>
<font color="#000000">pc</font> <font color="#4000C0">=</font> <font color="#000000">PseudocolorAttributes</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">pc</font><font color="#4000C0">.</font><font color="#000000">centering</font> <font color="#4000C0">=</font> <font color="#000000">pc</font><font color="#4000C0">.</font><font color="#000000">Zonal</font>
<font color="#000000">SetPlotOptions</font><font color="#4000C0">(</font><font color="#000000">pc</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;mixed_centering_zonal&quot;</font><font color="#4000C0">)</font>

<font color="#a02030"># Test that we can handle multiple identity expressions.</font>
<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;sub1&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;u&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;sub2&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;v&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;sum&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;sub1+sub2&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;sum&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;mult_identity_expr&quot;</font><font color="#4000C0">)</font>

<font color="#a02030"># Test that we can handle identity expressions that are not the first node</font>
<font color="#a02030"># of the expression tree.</font>
<font color="#000000">DefineVectorExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;C&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;coord(mesh1)&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;X&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;C[0]&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;Y&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;C[1]&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;Z&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;C[2]&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;TX&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;X&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;TY&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;cos_angle*Y - sin_angle*Z + Zt*sin_angle - Yt*cos_angle&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;TZ&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;sin_angle*Y + cos_angle*Z + Yt*sin_angle - Zt*cos_angle&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;Yt&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;5&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;Zt&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;10&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;angle&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;rad2deg(30)&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;sin_angle&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;sin(angle)&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;cos_angle&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;cos(angle)&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;rad&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;TX*TX + TY*TY + TZ*TZ&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;rad&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;long_identity_expr&quot;</font><font color="#4000C0">)</font>

<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">OpenDatabase</font><font color="#4000C0">(</font><font color="#000000">silo_data_path</font><font color="#4000C0">(</font><font color="#008000">&quot;rect2d.silo&quot;</font><font color="#4000C0">)</font><font color="#4000C0">)</font>

<font color="#a02030"># Test divide expression</font>
<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&#x27;divide1&#x27;</font><font color="#4000C0">,</font> <font color="#008000">&#x27;divide(d,p)&#x27;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&#x27;Pseudocolor&#x27;</font><font color="#4000C0">,</font><font color="#008000">&#x27;divide1&#x27;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&#x27;divide1&#x27;</font><font color="#4000C0">)</font>

<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&#x27;divide2&#x27;</font><font color="#4000C0">,</font> <font color="#008000">&#x27;divide(d,p,0.0,2.0)&#x27;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&#x27;Pseudocolor&#x27;</font><font color="#4000C0">,</font><font color="#008000">&#x27;divide2&#x27;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&#x27;divide2&#x27;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&#x27;divide3&#x27;</font><font color="#4000C0">,</font> <font color="#008000">&#x27;divide(d,p,1.0,2.0)&#x27;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&#x27;Pseudocolor&#x27;</font><font color="#4000C0">,</font><font color="#008000">&#x27;divide3&#x27;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&#x27;divide3&#x27;</font><font color="#4000C0">)</font>
<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#a02030"># Test resrad</font>
<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;resrad&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;resrad(recenter(u), 0.1)&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;resrad&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;resrad&quot;</font><font color="#4000C0">)</font>

<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;resrad2&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;resrad(recenter(u))&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;resrad2&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">txt</font> <font color="#4000C0">=</font> <font color="#000000">GetLastError</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">TestText</font><font color="#4000C0">(</font><font color="#008000">&quot;resrad_error&quot;</font><font color="#4000C0">,</font> <font color="#000000">txt</font><font color="#4000C0">)</font>

<font color="#000000">DeleteAllPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">DefineScalarExpression</font><font color="#4000C0">(</font><font color="#008000">&quot;ident_mesh&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;quadmesh2d&quot;</font><font color="#4000C0">)</font>
<font color="#000000">AddPlot</font><font color="#4000C0">(</font><font color="#008000">&quot;Pseudocolor&quot;</font><font color="#4000C0">,</font> <font color="#008000">&quot;ident_mesh&quot;</font><font color="#4000C0">)</font>
<font color="#000000">DrawPlots</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000">Test</font><font color="#4000C0">(</font><font color="#008000">&quot;ident_mesh&quot;</font><font color="#4000C0">)</font>

<font color="#000000">TestMinMaxExpression</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">TestListsOfExpressions</font><font color="#4000C0">(</font><font color="#4000C0">)</font>

<font color="#000000">Exit</font><font color="#4000C0">(</font><font color="#4000C0">)</font>
<font color="#000000"></font></font></pre></body></html>